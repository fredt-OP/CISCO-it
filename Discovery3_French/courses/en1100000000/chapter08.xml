<chapter type="" id="en1108000000">
<title><content-text>Filtering Traffic Using Access Control Lists</content-text></title>
<section type="ChapterIntroduction" id="en1108000000">
<title><content-text>Chapter Introduction</content-text></title>
<topic type="" id="en1108000100">
<title><content-text>Introduction</content-text></title>
<page type="FullScreen" id="en1108000101">
<content-media type="ChapterIntroduction" id="cm8992633066">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108000000/en1108000100/en1108000101/cm8992633066.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108000000/en1108000100/en1108000101/cm8992633066text.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
<section type="" id="en1108010000">
<title><content-text>Using Access Control Lists</content-text></title>
<topic type="" id="en1108010100">
<title><content-text>Traffic Filtering</content-text></title>
<page type="OneColumn" id="en1108010101">
<content-media type="StaticGraphic" id="cm1998541638">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010100/en1108010101/cm1998541638.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010100/en1108010101/cm1998541638text.xml"/></content-media>
<content-text><p>Security within an enterprise network is extremely critical. It is important to prevent access by unauthorized users and protect the network from various attacks, such as DoS attacks. Unauthorized users can modify, destroy, or steal sensitive data on servers. DoS attacks prevent valid users from accessing facilities. Both of these situations cause a business to lose time and money.</p> <p>Through <content-link target="{8B208DA8-1C7A-4E2A-B511-45459D4A4094}" type="glossary">traffic filtering</content-link>, an administrator controls traffic in various segments of the network. Filtering is the process of analyzing the contents of a packet to determine if the packet should be allowed or blocked.</p> <p>Packet filtering can be simple or complex, denying or permitting traffic based on:</p> <p><ul><li> Source IP address</li><li> Destination IP address</li><li> MAC addresses</li><li> Protocols </li><li> Application type</li></ul></p> <p>Packet filtering can be compared to junk email filtering. Many email applications allow the user to adjust the configuration to automatically delete email from a particular source address. Packet filtering can be done in the same way by configuring a router to identify unwanted traffic.</p> <p>Traffic filtering improves network performance. By denying unwanted or restricted traffic close to its source, the traffic does not travel across a network and consume valuable resources.</p></content-text>
</page>
<page type="OneColumn" id="en1108010102">
<content-media type="StaticGraphic" id="cm5277659696">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010100/en1108010102/cm5277659696.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010100/en1108010102/cm5277659696text.xml"/></content-media>
<content-text><p>Devices most commonly used to provide traffic filtering are:</p> <p><ul><li> Firewalls built into integrated routers</li><li> Dedicated security appliances</li><li> Servers</li></ul></p> <p>Some devices only filter traffic that originates from the internal network. More sophisticated security devices recognize and filter known types of attacks from external sources. </p> <p>Enterprise routers recognize harmful traffic and prevent it from accessing and damaging the network. Nearly all routers filter traffic based on the source and destination IP addresses of packets. They also filter on specific applications and on protocols such as IP, TCP, HTTP, FTP, and Telnet.</p></content-text>
</page>
</topic>
<topic type="" id="en1108010200">
<title><content-text>Access Control Lists</content-text></title>
<page type="OneColumn" id="en1108010201">
<content-media type="StaticGraphic" id="cm2924358541">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010200/en1108010201/cm2924358541.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010200/en1108010201/cm2924358541text.xml"/></content-media>
<content-text><p>One of the most common methods of traffic filtering is the use of access control lists (ACLs). ACLs can be used to manage and filter traffic that enters a network, as well as traffic that exits a network. </p> <p>An ACL ranges in size from one statement that allows or denies traffic from one source, to hundreds of statements that allow or deny packets from multiple sources. The primary use of ACLs is to identify the types of packets to accept or deny. </p> <p>ACLs identify traffic for multiple uses such as: </p> <p><ul><li> Specifying internal hosts for NAT</li><li> Identifying or classifying traffic for advanced features such as QoS and queuing</li><li> Restricting the contents of routing updates </li><li> Limiting debug output </li><li> Controlling virtual terminal access to routers</li></ul></p> <p>The following potential problems can result from using ACLs:</p> <p><ul><li> The additional load on the router to check all packets means less time to actually forward packets.</li><li> Poorly designed ACLs place an even greater load on the router and might disrupt network usage.</li><li> Improperly placed ACLs block traffic that should be allowed and permit traffic that should be blocked.</li></ul></p></content-text>
</page>
</topic>
<topic type="" id="en1108010300">
<title><content-text>Types and Usage of ACLs</content-text></title>
<page type="OneColumn" id="en1108010301">
<content-media type="StaticGraphic" id="cm8159538574">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010300/en1108010301/cm8159538574.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010300/en1108010301/cm8159538574text.xml"/></content-media>
<content-text><p>When creating access control lists, a network administrator has several options. The complexity of the design guidelines determines the type of ACL required. </p> <p>There are three types of ACLs:</p> <p><b>Standard ACLs</b></p> <p>The <content-link target="{66733A04-083C-4B5F-8B39-63B1E3C57ADE}" type="glossary">Standard ACL</content-link> is the simplest of the three types. When creating a standard IP ACL, the ACLs filter based on the source IP address of a packet. Standard ACLs permit or deny based on the entire protocol, such as IP. So, if a host device is denied by a standard ACL, all services from that host are denied. This type of ACL is useful for allowing all services from a specific user, or LAN, access through a router while denying other IP addresses access. Standard ACLs are identified by the number assigned to them. For access lists permitting or denying IP traffic, the identification number can range from 1 to 99 and from 1300 to 1999.</p> <p><b>Extended ACLs</b></p> <p><content-link target="{88A2ED82-B33C-40C1-8142-EA0BF8E9ACF7}" type="glossary">Extended ACL</content-link>s filter not only on the source IP address but also on the destination IP address, protocol, and port numbers. Extended ACLs are used more than Standard ACLs because they are more specific and provide greater control. The range of numbers for Extended ACLs is from 100 to 199 and from 2000 to 2699.</p> <p><b>Named ACLs</b></p> <p>Named ACLs (<content-link target="{49821333-2220-461F-8D42-64923AEDF724}" type="glossary">NACL</content-link>s) are either Standard or Extended format that are referenced by a descriptive name rather than a number. When configuring named ACLs, the router IOS uses a NACL subcommand mode.</p></content-text>
</page>
<page type="FullScreen" id="en1108010302">
<content-media type="ActivityMCSACheckbox" id="cm4041823544">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010300/en1108010302/cm4041823544.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010300/en1108010302/cm4041823544text.xml"/></content-media>
<content-text><p><b>Activity</b></p> <p>Indicate whether the characteristic describes a Standard, Extended, or Named ACL.</p></content-text>
</page>
</topic>
<topic type="" id="en1108010400">
<title><content-text>ACL Processing</content-text></title>
<page type="OneColumn" id="en1108010401">
<content-media type="AnimationPartialScreen" id="cm2596070214">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010400/en1108010401/cm2596070214.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010400/en1108010401/cm2596070214text.xml"/></content-media>
<content-text><p>Access control lists consist of one or more statements. Each statement either <content-link target="{4AB2F91D-D25F-412C-BA06-4342135673C9}" type="glossary">permits</content-link> or <content-link target="{A784A5C4-36B1-44C6-969A-46D6B6DD5AF9}" type="glossary">denies</content-link> traffic based on specified parameters. Traffic is compared to each statement in the ACL sequentially until a match is found or until there are no more statements. </p> <p>The last statement of an ACL is always an <content-link target="{7ABBB5CB-A55E-496C-A740-4184A4F358E0}" type="glossary">implicit deny</content-link>. This statement is automatically inserted at the end of each ACL even though it is not physically present. The implicit deny blocks all traffic. This feature prevents the accidental entry of unwanted traffic.</p> <p>After creating an access control list, apply it to an interface for it to become effective. The ACL targets traffic that is either inbound or outbound through the interface. If a packet matches a permit statement, it is allowed to enter or exit the router. If it matches a deny statement, it goes no further. An ACL that does not have at least one permit statement blocks all traffic. This is because at the end of every ACL is an implicit deny. Therefore an ACL will deny all traffic not specifically permitted.</p></content-text>
</page>
<page type="OneColumn" id="en1108010402">
<content-media type="AnimationDual" id="cm9833473252">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010400/en1108010402/cm9833473252.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010400/en1108010402/cm9833473252text.xml"/></content-media>
<content-text><p>An administrator applies either an inbound or outbound ACL to a router interface. The inbound or outbound direction is always from the perspective of the router. Traffic coming in an interface is inbound and traffic going out an interface is outbound.</p> <p>When a packet arrives at an interface, the router checks the following parameters:</p> <p><ul><li> Is there an ACL associated with the interface?</li><li> Is the ACL inbound or outbound?</li><li> Does the traffic match the criteria for permitting or denying?</li></ul></p> <p>An ACL applied outbound to an interface has no effect on traffic inbound on that same interface.</p> <p>Each interface of a router can have one ACL per direction for each network protocol. For the IP protocol, one interface can have one ACL inbound and one ACL outbound at the same time. </p> <p>ACLs applied to an interface add latency to the traffic. Even one long ACL can affect router performance.</p></content-text>
</page>
<page type="FullScreen" id="en1108010403">
<content-media type="ActivityMCSACheckbox" id="cm9629498171">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108010000/en1108010400/en1108010403/cm9629498171.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108010000/en1108010400/en1108010403/cm9629498171text.xml"/></content-media>
<content-text><p><b>Activity</b></p> <p>Determine whether the packet is permitted or denied based on source IP address, interface, and direction. </p></content-text>
</page>
</topic>
</section>
<section type="" id="en1108020000">
<title><content-text>Using a Wildcard Mask</content-text></title>
<topic type="" id="en1108020100">
<title><content-text>ACL Wildcard Mask Purpose and Structure</content-text></title>
<page type="OneColumn" id="en1108020101">
<content-media type="StaticGraphic" id="cm6353663169">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020100/en1108020101/cm6353663169.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020100/en1108020101/cm6353663169text.xml"/></content-media>
<content-text><p>Simple ACLs specify only one permitted or denied address. Blocking multiple addresses or ranges of addresses requires using either multiple statements or a wildcard mask. Using an IP network address with a wildcard mask allows much more flexibility. A wildcard mask can block a range of addresses or a whole network with one statement. </p> <p>A wildcard mask uses 0s to indicate the portion of an IP address that must match exactly and 1s to indicate the portion of the IP address that does not have to match a specific number.</p> <p>A wildcard mask of 0.0.0.0 requires an exact match on all 32 bits of the IP address. This mask equates to the use of the <span class="cmd"><b><i>host</i></b></span> parameter.</p></content-text>
</page>
<page type="OneColumn" id="en1108020102">
<content-media type="InteractiveGraphicHotspots" id="cm6655017790">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020100/en1108020102/cm6655017790.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020100/en1108020102/cm6655017790text.xml"/></content-media>
<content-text><p>The wildcard mask used with ACLs functions like the one used in the OSPF routing protocol. However, the purpose of each mask is different. With ACL statements, the wildcard mask specifies a host or range of addresses to be permitted or denied. </p> <p>When creating an ACL statement, the IP address and wildcard mask become the comparison fields. All packets that enter or exit an interface are compared to each statement of the ACL to determine if there is a match. The wildcard mask determines how many bits of the incoming IP address match the comparison address.</p> <p>As an example, the following statement permits all hosts from the 192.168.1.0 network and blocks all others:</p> <p><span class="cmd"><b>access-list 1 permit 192.168.1.0 0.0.0.255</b></span></p> <p>The wildcard mask specifies that only the first three octets must match. Therefore, if the first 24 bits of the incoming packet match the first 24 bits of the comparison field, the packet is permitted. Any packet with a source IP address in the range of 192.168.1.1 to 192.168.1.255 matches the example comparison address and mask combination. All other packets are denied by the ACL implicit <span class="cmd"><b>deny an</b>y</span> statement.</p></content-text>
</page>
<page type="FullScreen" id="en1108020103">
<content-media type="ActivityCustom" id="cm7764937634">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020100/en1108020103/cm7764937634.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020100/en1108020103/cm7764937634text.xml"/></content-media>
<content-text><p>Full Screen <b>Activity</b></p> <p>Determine the wildcard mask for each ACL statement objective. </p></content-text>
</page>
</topic>
<topic type="" id="en1108020200">
<title><content-text>Analyzing the Effects of the Wildcard Mask</content-text></title>
<page type="OneColumn" id="en1108020201">
<content-media type="StaticGraphic" id="cm8825868562">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020200/en1108020201/cm8825868562.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020200/en1108020201/cm8825868562text.xml"/></content-media>
<content-text><p>When creating an ACL, there are two special parameters that can be used in place of a wildcard mask: host and any. </p> <p><b>Host parameter</b></p> <p>To filter a single, specific host, use either the wildcard mask 0.0.0.0 after the IP address or the host parameter prior to the IP address. </p> <p><span class="cmd">R1(config)<b>#access-list 9 deny 192.168.15.99 0.0.0.0</b></span></p> <p>Is the same as:</p> <p><span class="cmd">R1(config)<b>#access-list 9 deny host 192.168.15.99</b></span></p> <p><b>Any parameter</b></p> <p>To filter all hosts, use the all 1s parameter by configuring a wildcard mask of 255.255.255.255. When using a wildcard mask of 255.255.255.255 all bits are considered matches, therefore, the IP address is typically represented as 0.0.0.0. Another way to filter all hosts is to use the any parameter.</p> <p><span class="cmd">R1(config)<b>#access-list 9 permit 0.0.0.0 255.255.255.255</b></span></p> <p>Is the same as:</p> <p><span class="cmd">R1(config)<b>#access-list 9 permit any</b></span></p> <p>Consider the following example that denies a specific host and permits all others:</p> <p><span class="cmd">R1(config)<b>#access-list 9 deny host 192.168.15.99</b></span></p> <p><span class="cmd">R1(config)<b>#access-list 9 permit any</b></span></p> <p>The permit any command permits all traffic not specifically denied in the ACL. When this is configured, no packets will reach the implicit <span class="cmd"><b>deny any</b></span> at the end of the ACL.</p></content-text>
</page>
<page type="OneColumn" id="en1108020202">
<content-media type="StaticGraphic" id="cm5437224040">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020200/en1108020202/cm5437224040.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020200/en1108020202/cm5437224040text.xml"/></content-media>
<content-text><p>In an enterprise network with a hierarchical IP addressing scheme, it is often necessary to filter subnet traffic.</p> <p>If 3 bits are used for subnetting the 192.168.77.0 network, the subnet mask is 255.255.255.224. Subtracting the subnet mask from the all 255s mask results in a wildcard mask of 0.0.0.31. To permit the hosts on the 192.168.77.32 subnet, the ACL statement is: </p> <p><span class="cmd"><b>access-list 44 permit 192.168.77.32 0.0.0.31</b></span></p> <p>The first 27 bits of each packet match the first 27 bits of the comparison address. The overall range of addresses that this statement permits is from 192.168.77.33 to 192.168.77.63, which is the range of all addresses on the 192.168.77.32 subnet.</p></content-text>
</page>
<page type="OneColumn" id="en1108020203">
<content-media type="StaticGraphic" id="cm4668124258">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020200/en1108020203/cm4668124258.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020200/en1108020203/cm4668124258text.xml"/></content-media>
<content-text><p>Creating accurate wildcard masks for ACL statements provides the control required to fine-tune traffic flow. Filtering different subnet traffic is the most difficult concept for beginners.</p> <p>The 192.168.77.0 network, with a subnet mask of 255.255.255.192 or /26, creates the following four subnets:</p> <p>192.168.77.0/26</p> <p>192.168.77.64/26</p> <p>192.168.77.128/26</p> <p>192.168.77.192/26</p> <p>To create an ACL to filter any of these four subnets, subtract the subnet mask 255.255.255.192 from the all 255s mask resulting in a wildcard mask of 0.0.0.63. To permit traffic from the first two of these subnets, use two ACL statements: </p> <span class="cmd"><p><b>access-list 55 permit 192.168.77.0 0.0.0.63</b></p></span> <span class="cmd"><p><b>access-list 55 permit 192.168.77.64 0.0.0.63</b></p></span> <p>The first two networks also summarize to 192.168.77.0/25. Subtracting the summarized subnet mask of 255.255.255.128 from the all 255s mask results in a wildcard mask of 0.0.0.127. Using this mask groups these two subnets together into one ACL statement instead of two.</p> <p><span class="cmd"><b>access-list 5 permit 192.168.77.0 0.0.0.127</b></span></p></content-text>
</page>
<page type="FullScreen" id="en1108020204">
<content-media type="ActivityMCSACheckbox" id="cm7588412931">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108020000/en1108020200/en1108020204/cm7588412931.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108020000/en1108020200/en1108020204/cm7588412931text.xml"/></content-media>
<content-text><p><b>Full Screen Activity</b></p> <p>Determine whether the IP packet is permitted or denied by analyzing the comparison address and wildcard mask.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en1108030000">
<title><content-text>Configuring Access Control Lists</content-text></title>
<topic type="" id="en1108030100">
<title><content-text>Placing Standard and Extended ACLs</content-text></title>
<page type="OneColumn" id="en1108030101">
<content-media type="StaticGraphic" id="cm6797342477">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030100/en1108030101/cm6797342477.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030100/en1108030101/cm6797342477text.xml"/></content-media>
<content-text><p>Properly designed access control lists have a positive impact on network performance and availability. Plan the creation and placement of access control lists to maximize this effect.</p> <p>Planning involves the following steps:</p> <p>1. Determine the traffic filtering requirements</p> <p>2. Decide which type of ACL best suits the requirements</p> <p>3. Determine the router and the interface on which to apply the ACL</p> <p>4. Determine in which direction to filter traffic</p> <p><b>Step 1: Determine Traffic Filtering Requirements</b></p> <p> </p> <p>Gather traffic filtering requirements from <content-link target="{EE91D62B-2EEC-4CEE-8C8D-1F33B06FB710}" type="glossary">stakeholders</content-link> from within each department of an enterprise. These requirements differ from enterprise to enterprise and are based on customer needs, traffic types, traffic loads, and security concerns.</p></content-text>
</page>
<page type="OneColumn" id="en1108030102">
<content-media type="InteractiveGraphicHotspots" id="cm3016712622">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030100/en1108030102/cm3016712622.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030100/en1108030102/cm3016712622text.xml"/></content-media>
<content-text><p><b>Step 2: Decide Type of ACL to Suit Requirements</b></p> <p> </p> <p>The decision to use a Standard ACL or an Extended ACL depends on the filtering requirements of the situation. The choice of ACL type can affect the flexibility of the ACL, as well as the router performance, and network link bandwidth. </p> <p>Standard ACLs are simple to create and implement. However, standard ACLs only filter based on the source address and will filter all traffic without regard to the type or the destination of the traffic. With routes to multiple networks, a standard ACL placed too close to the source may unintentionally block traffic that should be permitted. Therefore, it is important to place standard ACLs as close to the destination as possible.</p> <p>When filtering requirements are more complex, use an Extended ACL. Extended ACLs offer more control than Standard ACLs. They filter on source and destination addresses. They also filter by looking at the network layer protocol, transport layer protocol, and port numbers if required. This increased filtering detail allows a network administrator to create ACLs that meet the specific needs of a security plan.</p> <p>Place an Extended ACL close to the source address. By looking at both the source and destination address, the ACL blocks packets intended for a specific destination network before they leave the source router. The packets are filtered before they cross the network, which helps conserve bandwidth.</p></content-text>
</page>
<page type="OneColumn" id="en1108030103">
<content-media type="AnimationPartialScreen" id="cm3859640840">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030100/en1108030103/cm3859640840.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030100/en1108030103/cm3859640840text.xml"/></content-media>
<content-text><p><b>Step 3: Determine Router and Interface for ACL</b></p> <p> </p> <p>Place ACLs on routers in either the Access or Distribution Layer. A network administrator must have control of these routers and be able to implement a security policy. A network administrator who does not have access to a router cannot configure an ACL on it. </p> <p>Selection of the appropriate interface depends on the filtering requirements, the ACL type, and the location of the designated router. It is best to filter traffic before it advances onto a lower bandwidth serial link. The interface selection is usually obvious once the router is chosen.</p> <p><b>Step 4: Determine Direction to Filter Traffic</b></p> <p> </p> <p>When determining the direction in which to apply an ACL, visualize the traffic flow from the perspective of the router.</p> <p>Inbound traffic is traffic that is coming into a router interface from outside. The router compares the incoming packet to the ACL before looking up the destination network in the routing table. Packets discarded at this point save the overhead of routing lookups. This makes the inbound access control list more efficient for the router than an outbound access list. </p> <p>Outbound traffic is inside the router and leaves through an interface. For an outbound packet, the router has already done a routing table lookup and has switched the packet to the correct interface. The packet is compared to the ACL just before leaving the router.</p></content-text>
</page>
<page type="FullScreen" id="en1108030104">
<content-media type="ActivityCustom" id="cm8487737901">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030100/en1108030104/cm8487737901.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030100/en1108030104/cm8487737901text.xml"/></content-media>
<content-text><p>Full Screen <b>Activity</b></p> <p>Determine the correct router, interface, and direction for placement of the ACL. </p></content-text>
</page>
</topic>
<topic type="" id="en1108030200">
<title><content-text>Basic ACL Configuration Process</content-text></title>
<page type="OneColumn" id="en1108030201">
<content-media type="StaticGraphic" id="cm4069239429">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030200/en1108030201/cm4069239429.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030200/en1108030201/cm4069239429text.xml"/></content-media>
<content-text><p>After capturing the requirements, planning the access control list, and determining the location, configure the ACL.</p> <p>Each ACL requires a unique identifier. This identifier can be either a number or a descriptive name. </p> <p>In numbered access control lists, the number identifies the type of ACL created: </p> <p><ul><li> Standard IP ACLs have numbers in the ranges from 1 to 99 and from 1300 to 1999. </li><li> Extended IP ACLs have numbers in the ranges from 100 to 199 and from 2000 to 2699. </li></ul></p> <p>It is also possible to create AppleTalk and IPX ACLs. </p> <p>The limit for any one router interface is one ACL per protocol per direction. If a router is running IP exclusively, each interface handles a maximum of two ACLs: one inbound and one outbound. Since each ACL compares every packet passing through an interface, ACLs add to latency.</p></content-text>
</page>
<page type="OneColumn" id="en1108030202">
<content-media type="StaticGraphic" id="cm8684736398">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030200/en1108030202/cm8684736398.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030200/en1108030202/cm8684736398text.xml"/></content-media>
<content-text><p>Configuring an access control list requires two steps: creation and application.</p> <p><b>ACL Creation</b></p> <p>Enter global configuration mode. Using the <span class="cmd"><b>access-list</b></span> command, enter the access control list statements. Enter all statements with the same ACL number until the access control list is complete.</p> <p>The syntax for the Standard ACL statement is:</p> <p><span class="cmd"><b>access-list</b> [<i>access-list-number</i>] [<b>deny|permit</b>] [<i>source address</i>] [<i>source-wildcard</i>][<b>log</b>]</span></p> <p>Since every packet is compared to every ACL statement until a match is found, the order that statements are placed within the ACL can effect the latency introduced. Therefore, order the statements so that the more common conditions appear in the ACL before the less common ones. For example, statements that find a match for the highest amount of traffic should be placed toward the beginning of the ACL. </p> <p>Keep in mind, however, that once a match is found, the packet is no longer compared to any other statements within the ACL. This means that if one line permits a packet, but a line further down the ACL denies it, the packet will be permitted. For this reason, plan the ACL so that the more specific requirements appear before more general ones. In other words, deny a specific host of a network before permitting the remainder of the entire network. </p> <p>Document the function of each section or statement of the ACL using the <span class="cmd"><b>remark</b></span> command:</p> <p><span class="cmd"><b>access-list</b> [<i>list number</i>] <b>remark</b> [<i>text</i>]</span></p> <p><br/> To delete an ACL, use the command:</p> <p><span class="cmd"><b>no access-list</b> [<i>list number</i>]</span></p> <p> </p> <p>It is not possible to delete a single line from a standard or extended ACL. Instead, the ACL as a whole is deleted and must be replaced in its entirety. </p></content-text>
</page>
</topic>
<topic type="" id="en1108030300">
<title><content-text>Configuring Numbered Standard ACLs</content-text></title>
<page type="OneColumn" id="en1108030301">
<content-media type="AnimationPartialScreen" id="cm9527349589">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030300/en1108030301/cm9527349589.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030300/en1108030301/cm9527349589text.xml"/></content-media>
<content-text><p>An ACL does not filter traffic until it has been applied, or assigned, to an interface.</p> <p><b>ACL Application</b></p> <p>Assign an ACL to one or more interfaces, specifying either inbound traffic or outbound traffic. Apply a standard ACL as close to the destination as possible.</p> <p><span class="cmd">R2(config-if)#<b>ip access-group </b><i>access list number</i><b> [in | out]</b></span></p> <p>The following commands place access-list 5 on the R2 Fa0/0 interface filtering inbound traffic:</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip access-group 5 in</b></p></span> <p>The default direction for an ACL applied to an interface is <b>out</b>. Even though <b>out</b> is the default, it is very important to specify the direction to avoid confusion and to ensure that traffic filters in the correct direction. </p> <p>To remove an ACL from an interface while leaving the ACL intact, use the <span class="cmd"><b>no ip access-group </b><i>interface</i></span> command.</p></content-text>
</page>
<page type="OneColumn" id="en1108030302">
<content-media type="InteractiveGraphicHotspots" id="cm3832309974">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030300/en1108030302/cm3832309974.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030300/en1108030302/cm3832309974text.xml"/></content-media>
<content-text><p>Several ACL commands evaluate the proper syntax, order of statements, and placement on interfaces.</p> <p><span class="cmd"><b>show ip interface</b></span></p> <p><ul><li> Displays IP interface information and indicates any assigned ACLs.</li></ul></p> <p><span class="cmd"><b>show access-lists [</b><i>access list number</i><b>]</b></span></p> <p><ul><li> Displays the contents of all ACLs on the router. It also displays the number of matches for each permit or deny statement since application of the ACL. To see a specific list, add the ACL name or number as an option for this command.</li></ul></p> <p><span class="cmd"><b>show running-config</b></span></p> <p><ul><li> Displays all configured ACLs on a router, even if they are not currently applied to an interface.</li></ul></p> <p>If using numbered ACLs, statements entered after the initial creation of the ACL are added to the end. This order may not yield the desired results. To resolve this issue, remove the original ACL and recreate it. </p> <p>It is often recommended to create ACLs in a text editor. This allows the ACL to be easily edited and pasted into the router configuration. However, keep in mind when coping and pasting the ACL that it is important to remove the currently applied ACL first, otherwise all statements will be pasted to the end. </p></content-text>
</page>
<page type="FullScreen" id="en1108030303">
<content-media type="ActivityDnDCheckReset" id="cm8445750496">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030300/en1108030303/cm8445750496.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030300/en1108030303/cm8445750496text.xml"/></content-media>
<content-text><p><b>Full Screen Activity</b></p> <p>Determine the proper sequence for the ACL configuration statement to achieve the requirements.</p></content-text>
</page>
<page type="OneColumn" id="en1108030304">
<content-media type="ActivityLab" id="cm3009976180">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030300/en1108030304/cm3009976180/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108030000/en1108030300/en1108030304/cm3009976180/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Configure and verify a Standard ACL. </p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108030400">
<title><content-text>Configuring Numbered Extended ACLs</content-text></title>
<page type="OneColumn" id="en1108030401">
<content-media type="InteractiveGraphicRollovers" id="cm9866717897">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030400/en1108030401/cm9866717897.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030400/en1108030401/cm9866717897text.xml"/></content-media>
<content-text><p>Extended ACLs provide a greater range of control than Standard ACLs. The Extended ACL permits or denies access based on source IP address, destination IP address, protocol type, and port numbers. Since Extended ACLs can be very specific, they tend to grow in size quickly. The more statements that an ACL contains, the more difficult it is to manage.</p> <p>Extended ACLs use an access-list number in the ranges 100 to 199 and 2000 to 2699. The same rules that apply to Standard ACLs also apply to Extended ACLs :</p> <p><ul><li> Configure multiple statements in one ACL. </li><li> Assign the same ACL number to each statement.</li><li> Use the <span class="cmd"><b>host</b></span> or <span class="cmd"><b>any</b></span> keywords to represent IP addresses.</li></ul></p> <p>A key difference in the Extended ACL syntax is the requirement to specify a protocol after the permit or deny condition. This protocol can be IP, indicating all IP traffic, or it can indicate filtering on a specific IP protocol such as TCP, UDP, ICMP, and OSPF.</p></content-text>
</page>
<page type="OneColumn" id="en1108030402">
<content-media type="StaticGraphic" id="cm8727131225">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030400/en1108030402/cm8727131225.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030400/en1108030402/cm8727131225text.xml"/></content-media>
<content-text><p>There are often many different ways to meet a set of requirements.</p> <p>For example, a company has a server with the address of 192.168.3.75. It has the following requirements:</p> <p><ul><li> Allow access to hosts on the 192.168.2.0 LAN. </li><li> Allow access to host 192.168.1.66.</li><li> Deny access to hosts on 192.168.4.0 LAN. </li><li> Permit access to everyone else in the enterprise. </li></ul></p> <p>There are at least two possible solutions that satisfy these requirements. When planning the ACL, try to minimize statements where possible. </p> <p>Some ways to minimize statements and reduce the processing load of the router include:</p> <p><ul><li> Match high volume traffic and deny blocked traffic early in the ACL. This approach ensures that packets do not compare to later statements.</li><li> Consolidate multiple permit and deny statements into a single statement using ranges.</li><li> Consider denying a particular group rather than permitting a larger, opposite group.</li></ul></p></content-text>
</page>
<page type="FullScreen" id="en1108030403">
<content-media type="ActivityMCSACheckbox" id="cm2770374826">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030400/en1108030403/cm2770374826.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030400/en1108030403/cm2770374826text.xml"/></content-media>
<content-text><p>Full Screen <b>Activity</b></p> <p>Based on the ACL, determine if packets are permitted or denied.</p></content-text>
</page>
<page type="OneColumn" id="en1108030404">
<content-media type="ActivityLab" id="cm6900190285">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030400/en1108030404/cm6900190285/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108030000/en1108030400/en1108030404/cm6900190285/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Plan, configure, and verify an Extended ACL. </p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108030500">
<title><content-text>Configuring Named ACLs</content-text></title>
<page type="OneColumn" id="en1108030501">
<content-media type="StaticGraphic" id="cm9344704099">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030500/en1108030501/cm9344704099.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030500/en1108030501/cm9344704099text.xml"/></content-media>
<content-text><p>Cisco IOS versions 11.2 and higher can create Named ACLs (NACLs). In an NACL, a descriptive name replaces the numerical ranges required for Standard and Extended ACLs. Named ACLs offer all the functionality and advantages of Standard and Extended ACLs; only the syntax for creating them is different.</p> <p>The name given to an ACL is unique. Using capital letters in the name makes it easier to recognize in router command output and troubleshooting.</p> <p>A Named ACL is created with the command:</p> <p><span class="cmd"><b>ip access-list</b> {<b>standard </b>| <b>extended</b>} <i>name</i></span></p> <p>After issuing this command, the router switches to NACL configuration subcommand mode. After the initial naming command, enter all permit and deny statements, one at a time. NACLs use Standard or Extended ACL command syntax starting with the permit or deny statement.</p> <p>Apply a Named ACL to an interface in the same manner as applying a Standard or Extended ACL.</p> <p>The commands that help with evaluating Named ACLs for proper syntax, order of statements, and placement on interfaces are the same as the commands for Standard ACLs.</p></content-text>
</page>
<page type="OneColumn" id="en1108030502">
<content-media type="InteractiveGraphicHotspots" id="cm5990258652">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030500/en1108030502/cm5990258652.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030500/en1108030502/cm5990258652text.xml"/></content-media>
<content-text><p>Editing ACLs with older versions of IOS make it necessary to:</p> <p><ul><li> Copy the ACL to a text editor.</li><li> Remove the ACL from the router.</li><li> Recreate and apply the edited version.</li></ul></p> <p>Unfortunately, this process allows all traffic to flow through the interface during the editing cycle, thereby leaving the network open to potential security breaches. </p> <p>With current versions of the IOS, edit numbered and Named ACLs using the <span class="cmd"><b>ip access-list</b></span> command. ACLs display with the lines numbered as 10, 20, 30, and so forth. To see the line numbers, use the command:</p> <p><span class="cmd"><b>show access-lists</b></span></p> <p>To edit an existing line:</p> <p><ul><li> Remove the line using the <span class="cmd"><b>no line number</b></span> command.</li><li> Re-add the same line using its line number.</li></ul></p> <p>To insert a new line between existing lines 20 and 30:</p> <p><ul><li> Issue the <span class="cmd"><b>new ACL</b></span> statement, starting with a number between the two existing lines, such as 25.</li></ul></p> <p>Issue the <span class="cmd"><b>show access-lists</b></span> command to display the lines re-sorted and renumbered by 10s.</p></content-text>
</page>
<page type="OneColumn" id="en1108030503">
<content-media type="ActivityPKA" id="cm3600938129">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030500/en1108030503/cm3600938129/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108030000/en1108030500/en1108030503/cm3600938129/icontext.xml"/></content-media>
<content-text><p><b>Packet Tracer Activity </b></p> <p> </p> <p>Configure and verify a Standard Named ACL. </p><p><b>Click the Packet Tracer icon to begin.</b></p></content-text>
</page>
<page type="OneColumn" id="en1108030504">
<content-media type="ActivityLab" id="cm9127995634">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030500/en1108030504/cm9127995634/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108030000/en1108030500/en1108030504/cm9127995634/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Configure and verify an Extended Named ACL. </p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108030600">
<title><content-text>Configure Router VTY Access</content-text></title>
<page type="OneColumn" id="en1108030601">
<content-media type="StaticGraphic" id="cm1803507512">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030600/en1108030601/cm1803507512.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030600/en1108030601/cm1803507512text.xml"/></content-media>
<content-text><p>Network administrators often need to configure a router located at a remote location. To log into the remote router, they use a program such as Telnet or a Secure Shell (SSH) client. Telnet transmits username and password in plain text and, therefore, is not very secure. SSH transmits the username and password information in an encrypted format.</p> <p>When a network administrator connects to a remote router using Telnet, the router initiates an inbound session. Telnet and SSH are in-band network management tools and require the IP protocol and a network connection to the router.</p> <p>The purpose of restricting virtual teletype terminal (VTY) access is to increase network security. Outside intruders may attempt to gain access to a router. If an access control list is not in place on the router virtual port, anyone who can determine the Telnet username and password can gain entry. If an ACL is applied to the router vty port that permits only specific IP addresses, anyone trying to telnet to the router from an IP address not permitted in the ACL will be denied access. Keep in mind, however, that this can create issues if the administrator must connect to the router from different locations using different IP addresses. </p></content-text>
</page>
<page type="OneColumn" id="en1108030602">
<content-media type="InteractiveGraphicHotspots" id="cm6817907170">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030600/en1108030602/cm6817907170.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108030000/en1108030600/en1108030602/cm6817907170text.xml"/></content-media>
<content-text><p>The process used to create the VTY access control list is the same as for an interface. However, applying the ACL to a VTY line uses a different command. Instead of using the <span class="cmd"><b>ip access-group</b></span> command, use the <span class="cmd"><b>access-class</b></span> command. </p> <p>Follow these guidelines when configuring access lists on VTY lines:</p> <p><ul><li> Apply a numbered ACL, not a Named ACL, to the VTY lines.</li><li> Place identical restrictions on all VTY lines, because it is not possible to control the line on which a user may connect.</li></ul></p> <p>VTY sessions are established between the Telnet client software and the destination router. The network administrator establishes a session with the destination router, enters a username and password, and makes configuration changes.</p></content-text>
</page>
<page type="OneColumn" id="en1108030603">
<content-media type="ActivityLab" id="cm1617058955">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030600/en1108030603/cm1617058955/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108030000/en1108030600/en1108030603/cm1617058955/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Configure and verify router VTY restrictions.</p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
<page type="OneColumn" id="en1108030604">
<content-media type="ActivityPKA" id="cm1147167935">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108030000/en1108030600/en1108030604/cm1147167935/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108030000/en1108030600/en1108030604/cm1147167935/icontext.xml"/></content-media>
<content-text><p><b>Packet Tracer Activity</b></p> <p> </p> <p>Plan, configure, and verify Standard, Extended, and Named ACLs. </p><p><b>Click the Packet Tracer icon to begin.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en1108040000">
<title><content-text>Permitting and Denying Specific Types of Traffic</content-text></title>
<topic type="" id="en1108040100">
<title><content-text>Configuring ACLs for Application and Port Filtering</content-text></title>
<page type="OneColumn" id="en1108040101">
<content-media type="StaticGraphic" id="cm8030330891">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040100/en1108040101/cm8030330891.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040100/en1108040101/cm8030330891text.xml"/></content-media>
<content-text><p>Extended ACLs filter on source and destination IP addresses. It is often desirable to filter on even more specific packet details. OSI Layer 3 network protocol, Layer 4 transport protocols and application ports provide this capability.</p> <p>Some of the protocols available to use for filtering include IP, TCP, UDP, and ICMP. </p> <p>Extended ACLs also filter on destination port numbers. These port numbers describe the application or service required by the packet. Each application has a registered port number assigned. </p> <p>The router must investigate the Ethernet frame to extract all of the IP addresses and port number information required for comparison with ACLs. </p> <p>In addition to entering port numbers, it is necessary to specify a condition before the statement is matched. The abbreviations most commonly used are: </p> <p><ul><li> <b>eq</b> - equals</li><li> <b>gt</b> - greater than</li><li> <b>lt</b> - less than</li></ul></p> <p>Consider the following example:</p> <p><span class="cmd">R1(config)<b>#access-list 122 permit tcp 192.168.1.0 0.0.0.255 host 192.168.2.89 eq 80</b></span></p> <p>This ACL statement permits traffic from 192.168.1.0 that is requesting HTTP access using port 80. If a user attempts to telnet or FTP into host 192.168.2.89, the user is denied due to the implicit deny statement assumed at the end of every access list.</p></content-text>
</page>
<page type="OneColumn" id="en1108040102">
<content-media type="StaticGraphic" id="cm2990566697">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040100/en1108040102/cm2990566697.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040100/en1108040102/cm2990566697text.xml"/></content-media>
<content-text><p>Filtering based on a particular application requires knowledge of the port number for that application. Applications are associated with both a port number and a name. An ACL can reference port 80 or HTTP.</p> <p>If neither the port number nor the name is known for an application, try these steps for locating that information:</p> <p>1. Research one of the IP addressing registry sites on the web, such as <content-link target="http://www.iana.org/" type="external">http://www.iana.org/</content-link></p> <p>2. Refer to the software documentation.</p> <p>3. Refer to the website of the application vendor.</p> <p>4. Use a packet sniffer and capture data from the application.</p> <p>5. Use the <span class="cmd"><b>?</b></span> option in the <span class="cmd"><b>access-list</b></span> command. The list includes well-known port names and numbers for the TCP protocol.</p> <p>Some applications use more than one port number. For example, FTP data transmits using port 20, but the session control that makes FTP possible uses port 21. To deny all FTP traffic, deny both ports.</p> <p>To accommodate multiple port numbers, Cisco IOS ACLs filter a range of ports. Use the gt, lt, or range operators in the ACL statement to accomplish this. For example, two FTP ACL statements can filter into one with the command:</p> <p><span class="cmd">R1(config)<b>#access-list 181 deny tcp any 192.168.77.0 0.0.0.255 range 20 21</b></span></p></content-text>
</page>
<page type="OneColumn" id="en1108040103">
<content-media type="ActivityPKA" id="cm8578365868">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040100/en1108040103/cm8578365868/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108040000/en1108040100/en1108040103/cm8578365868/icontext.xml"/></content-media>
<content-text><p><b>Packet Tracer Activity </b></p> <p>Configure and verify Extended ACLs that filter on port numbers. </p><p><b>Click the Packet Tracer icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108040200">
<title><content-text>Configuring ACLs to Support Established Traffic</content-text></title>
<page type="OneColumn" id="en1108040201">
<content-media type="AnimationPartialScreen" id="cm1531671377">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040200/en1108040201/cm1531671377.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040200/en1108040201/cm1531671377text.xml"/></content-media>
<content-text><p>ACLs are often created to protect an internal network from outside sources. However, while protecting the internal network, it should still allow internal users access to all resources. When internal users access external resources, those requested resources must pass through the ACL. For example, should an internal user wish to establish a connection with an external web server, the ACL must permit the requested html packets. Due to the ACLs use of implicit deny, resources must be specifically permitted by the ACL. Individual permit statements for all possible requested resources can result in a long ACL and leave security holes. </p> <p>To resolve this issue, it is possible to create a single statement that permits internal users to establish a TCP session with external resources. Once the TCP three-way handshake is accomplished and the connection is established, all packets sent between the two devices will be permitted. To accomplish this, use the keyword: established. </p> <p><span class="cmd"><b>access-list 101 permit tcp any any established</b></span></p> <p>Using this statement, all external tcp packets will be permitted under the condition that they are responses to internal requests. Permitting the incoming responses to established communications is a form of Stateful Packet Inspection (SPI). </p> <p>In addition to established traffic, it may be necessary for an internal user to ping external devices. It is not desirable, however, to allow external users to ping or trace a device on the inside network. In this case, a statement using the keywords <span class="cmd"><b>echo-reply</b></span> and <span class="cmd"><b>unreachable</b></span> can be written to permit ping responses and unreachable messages. A ping originating from external sources, however, will be denied unless specifically permitted in another statement.</p></content-text>
</page>
<page type="FullScreen" id="en1108040202">
<content-media type="ActivityMCSACheckbox" id="cm3417822746">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040200/en1108040202/cm3417822746.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040200/en1108040202/cm3417822746text.xml"/></content-media>
<content-text><p><b>Activity</b></p> <p>Determine if the packet is allowed or blocked based on source and destination address, packet type, and the ACLs. </p></content-text>
</page>
</topic>
<topic type="" id="en1108040300">
<title><content-text>Effects of NAT and PAT on ACL Placement</content-text></title>
<page type="OneColumn" id="en1108040301">
<content-media type="AnimationPartialScreen" id="cm3063250716">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040300/en1108040301/cm3063250716.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040300/en1108040301/cm3063250716text.xml"/></content-media>
<content-text><p>Implementing NAT and PAT may create a problem when planning ACLs. Network administrators need to account for the address translation when creating and applying ACLs to interfaces where NAT occurs. </p> <p>When using NAT with ACLs, it is important to know how they interact in the router. </p> <p>1. If the packet comes inbound into a NAT outside interface, the router:</p>  <p><ul><li> Applies the inbound ACL </li><li> Translates the destination address from outside to inside, or global to local </li><li> Routes the packet</li></ul></p> <p>2. If the packet goes outbound through a NAT outside interface, the router:</p> <p><ul><li> Translates the source address from inside to outside, or local to global </li><li> Applies outbound ACL</li></ul></p> <p>Plan the ACL so that it filters either the private or public addresses, depending on the relationship with NAT. If traffic is inbound or outbound on a NAT outside interface, the addresses to filter are the public ones.</p></content-text>
</page>
<page type="OneColumn" id="en1108040302">
<content-media type="ActivityLab" id="cm6910528367">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040300/en1108040302/cm6910528367/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108040000/en1108040300/en1108040302/cm6910528367/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p>Configure an ACL with NAT. </p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108040400">
<title><content-text>Analyzing Network ACLs and Placement</content-text></title>
<page type="OneColumn" id="en1108040401">
<content-media type="InteractiveGraphicHotspots" id="cm4602967001">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040400/en1108040401/cm4602967001.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040400/en1108040401/cm4602967001text.xml"/></content-media>
<content-text><p>Network administrators evaluate the effect of every statement in an ACL prior to implementation. An improperly designed ACL can immediately cause problems when it is applied to an interface. These problems range from a false sense of security to an unnecessary load on a router or even a non-functioning network.</p> <p>Administrators need to examine the ACL, one line at a time, and answer the following questions:</p> <p><ul><li> What service does the statement deny?</li><li> What is the source and what is the destination?</li><li> What port numbers are denied? </li><li> What would happen if the ACL was moved to another interface?</li><li> What would happen if the ACL filtered traffic in a different direction?</li><li> Is NAT an issue?</li></ul></p> <p>When evaluating an Extended ACL, it is important to remember these key points:</p> <p><ul><li> The keyword <span class="cmd"><b>tcp</b></span> permits or denies protocols like FTP, HTTP, Telnet, and so on.</li><li> The key phrase <span class="cmd"><b>permit ip</b></span> is used to permit all IP, including any TCP, UDP, and ICMP protocols.</li></ul></p></content-text>
</page>
<page type="FullScreen" id="en1108040402">
<content-media type="ActivityDnDCheckReset" id="cm7183361299">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040400/en1108040402/cm7183361299.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040400/en1108040402/cm7183361299text.xml"/></content-media>
<content-text><p>Full Screen <b>Activity</b></p> <p>Create an Extended ACL based on the requirements and the network topology shown. Some components are not used.</p></content-text>
</page>
</topic>
<topic type="" id="en1108040500">
<title><content-text>Configuring ACLs with Inter-VLAN Routing</content-text></title>
<page type="OneColumn" id="en1108040501">
<content-media type="StaticGraphic" id="cm1875056820">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040500/en1108040501/cm1875056820.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108040000/en1108040500/en1108040501/cm1875056820text.xml"/></content-media>
<content-text><p>When routing between VLANs in a network, it is sometimes necessary to control traffic from one VLAN to another using ACLs.</p> <p>Apply ACLs directly to VLAN interfaces or subinterfaces on a router just as with physical interfaces.</p> <p>Enterprise networks typically have servers on a different VLAN than user groups. In such cases, access to the server VLAN requires filtering.</p> <p>All rules and guidelines for creation and application are the same for ACLs on subinterfaces as they are for physical interfaces.</p></content-text>
</page>
<page type="OneColumn" id="en1108040502">
<content-media type="ActivityLab" id="cm4042308666">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040500/en1108040502/cm4042308666/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108040000/en1108040500/en1108040502/cm4042308666/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Configure and verify ACLs to filter inter-VLAN traffic.</p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
<page type="OneColumn" id="en1108040503">
<content-media type="ActivityPKA" id="cm3442236577">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108040000/en1108040500/en1108040503/cm3442236577/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108040000/en1108040500/en1108040503/cm3442236577/icontext.xml"/></content-media>
<content-text><p><b>Packet Tracer Activity </b></p> <p> </p> <p>Configure and verify an Extended ACL that creates a DMZ and protects the corporate network. </p><p><b>Click the Packet Tracer icon to begin.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en1108050000">
<title><content-text>Filtering Traffic Using Access Control Lists</content-text></title>
<topic type="" id="en1108050100">
<title><content-text>Using Logging to Verify ACL Functionality</content-text></title>
<page type="OneColumn" id="en1108050101">
<content-media type="AnimationDual" id="cm4738926683">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050100/en1108050101/cm4738926683.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108050000/en1108050100/en1108050101/cm4738926683text.xml"/></content-media>
<content-text><p>After writing an ACL and applying it to an interface, a network administrator evaluates the number of matches. When the fields of an incoming packet are equal to all ACL comparison fields, this is a match. Viewing the number of matches helps to identify whether the ACL statements are having the desired effect. </p> <p>By default, an ACL statement captures the number of matches and displays them at the end of each statement. View the matches using the following command: </p> <p><span class="cmd"><b>show access-list</b> </span></p> <p>The basic match counts that are displayed with the <span class="cmd"><b>show access-list</b></span> command provide the number of ACL statements matched and the number of packets processed. The output does not indicate the source or destination of the packet or the protocols in use. </p> <p>For additional details on packets permitted or denied, activate a process called <content-link target="{C95AA2F5-5037-4528-92FE-2DA9F26076D5}" type="glossary">logging</content-link>. Logging activates for individual ACL statements. To activate this feature, add the <span class="cmd"><b>log</b></span> option to the end of each ACL statement to be tracked. </p> <p>Use logging for a short time only to complete testing of the ACL. The process of logging events places an additional load on the router.</p></content-text>
</page>
<page type="OneColumn" id="en1108050102">
<content-media type="StaticGraphic" id="cm2853879106">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050100/en1108050102/cm2853879106.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108050000/en1108050100/en1108050102/cm2853879106text.xml"/></content-media>
<content-text><p>Logging to the console uses router memory, which is a limited resource. Instead, configure a router to send logging messages to an external server. These messages, called <span class="cmd"><b>syslog</b></span> messages, allow the user to view them both, in real time or at a later date.</p> <p>The message types include eight message severity levels. The levels range from 0, representing an emergency or an unusable system, to level 7, representing informational messages such as debugging.</p> <p>ACL logging generates an informational message that contains:</p> <p><ul><li> ACL number</li><li> Packet permitted or denied</li><li> Source and destination addresses</li><li> Number of packets</li></ul></p> <p>The message generates for the first packet that matches and then at 5-minute intervals.</p> <p>To turn off logging, use:</p> <p><span class="cmd"><b>no logging console</b></span></p> <p>To turn off all debugging, use:</p> <p><span class="cmd"><b>undebug all</b></span></p> <p>To turn off specific debugging, such as <span class="cmd"><b>ip packet</b></span>, use:</p> <p><span class="cmd"><b>no debug ip packet</b> </span></p></content-text>
</page>
<page type="OneColumn" id="en1108050103">
<content-media type="ActivityLab" id="cm4873017260">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050100/en1108050103/cm4873017260/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108050000/en1108050100/en1108050103/cm4873017260/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Configure ACLs and verify using the <span class="cmd"><b>show access-lists</b></span> command and console logging.</p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108050200">
<title><content-text>Analyzing Router Logs</content-text></title>
<page type="OneColumn" id="en1108050201">
<content-media type="StaticGraphic" id="cm5632898747">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050200/en1108050201/cm5632898747.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108050000/en1108050200/en1108050201/cm5632898747text.xml"/></content-media>
<content-text><p>Logging to the console uses router memory, which is a limited resource. Instead, configure a router to send logging, sometimes called <content-link target="{E967CDBB-3E5A-441D-AC11-09F3C8E695F8}" type="glossary">syslog</content-link> messages, to an external server. This method allows viewing the messages in real time and also at a later time. </p> <p>Types of reported events include the status of:</p> <p><ul><li> Router interfaces</li><li> Protocols in use</li><li> Bandwidth usage</li><li> ACL messages</li><li> Configuration events</li></ul></p> <p>It is advisable to include the option to notify a network administrator by email, pager, or cell phone when a critical event occurs. </p> <p>Other configurable options include:</p> <p><ul><li> Providing notification of new messages received</li><li> Sorting and grouping messages</li><li> Filtering messages by severity</li><li> Removal of all or selected messages</li></ul></p> <p>Syslog software is available from many resources. The level of reporting and ease of use vary with the price, but there are also several free programs available on the Internet. </p> <p>Syslog is a protocol supported by all network equipment, including switches, routers, firewalls, storage systems, modems, wireless devices, and UNIX hosts.</p></content-text>
</page>
<page type="OneColumn" id="en1108050202">
<content-media type="StaticGraphic" id="cm9485303320">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050200/en1108050202/cm9485303320.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108050000/en1108050200/en1108050202/cm9485303320text.xml"/></content-media>
<content-text><p>To use a syslog server, install the software on a Windows, Linux, UNIX, or MAC OS server and configure the router to send logged events to the syslog server.</p> <p>A sample of the command that specifies the IP address of the host where the syslog server is installed is: </p> <p><span class="cmd"><b>logging 192.168.3.11</b> </span></p> <p>When troubleshooting a problem, always set the service timestamps for logging. Be sure the router date and time are set correctly so that log files display the proper time stamp.</p>  <p>Use the show clock command to check the date and time setting. </p> <span class="cmd"><p>R1><b>show clock</b></p></span> <span class="cmd"><p>*00:03:45.213 UTC Mon Mar 1 2007</p></span> <p>To set the clock, first set the time zone. Base the time zone on Greenwich Mean Time (<content-link target="{9B9C4FF9-FF51-4D41-A4B8-FB2B43A55686}" type="glossary">GMT</content-link>) and then set the clock. Note that the <span class="cmd"><b>clock set</b></span> command is not used in configuration mode. </p> <p>To set the time zone:</p> <p><span class="cmd">R1(config)#<b>clock timezone CST -6</b></span></p> <p>To set the clock:</p> <p><span class="cmd">R1#<b>clock set 10:25:00 Sep 10 2007</b></span></p></content-text>
</page>
<page type="OneColumn" id="en1108050203">
<content-media type="ActivityLab" id="cm7261429147">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050200/en1108050203/cm7261429147/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1108000000/en1108050000/en1108050200/en1108050203/cm7261429147/icontext.xml"/></content-media>
<content-text><p><b>Lab Activity </b></p> <p> </p> <p>Configure ACLs and download a syslog server to record ACL activity.</p><p><b>Click the lab icon to begin.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1108050300">
<title><content-text>ACL Best Practices</content-text></title>
<page type="OneColumn" id="en1108050301">
<content-media type="StaticGraphic" id="cm8839482968">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108050000/en1108050300/en1108050301/cm8839482968.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108050000/en1108050300/en1108050301/cm8839482968text.xml"/></content-media>
<content-text><p>ACLs are a very powerful filtering tool. They are active immediately after application onto an interface.</p> <p>It is far better to spend extra time planning and troubleshooting before applying an ACL, than trying to troubleshoot after applying the ACL.</p> <p>Always test basic connectivity before applying ACLs. If pinging a host is unsuccessful because of a bad cable or an IP configuration problem, the ACL can compound the problem and make it harder to troubleshoot. </p> <p>When logging, add the <span class="cmd"><b>deny ip any</b></span> statement to end of ACL. This statement allows tracking the number of matches for packets denied. </p> <p>Use the <span class="cmd"><b>reload in 30</b></span> command when working with remote routers and testing ACL functionality. If a mistake in an ACL blocks access to the router, remote connectivity may be denied. Using this command, the router reloads in 30 minutes and reverts to the startup configuration. When satisfied with how the ACL is functioning, copy the running configuration to the startup configuration.</p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en1108060000">
<title><content-text>Chapter Summary</content-text></title>
<topic type="" id="en1108060100">
<title><content-text>Summary</content-text></title>
<page type="FullScreen" id="en1108060101">
<content-media type="ChapterSummary" id="cm3043535274">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108060000/en1108060100/en1108060101/cm3043535274.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108060000/en1108060100/en1108060101/cm3043535274text.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
<topic type="" id="en1108060200">
<title><content-text>Critical Thinking</content-text></title>
<page type="FullScreen" id="en1108060201">
<content-media type="ActivityCustom" id="cm4092632963">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108060000/en1108060200/en1108060201/cm4092632963.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1108000000/en1108060000/en1108060200/en1108060201/cm4092632963text.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="en1108070000">
<title><content-text>Chapter Quiz</content-text></title>
<topic type="" id="en1108070100">
<title><content-text>Quiz</content-text></title>
<page type="OneColumn" id="en1108070101">
<content-media type="ChapterQuiz" id="cm9026205814">	<title><content-text></content-text></title>	<media ref="en1108000000/en1108070000/en1108070100/en1108070101/cm9026205814/" mime="" scale="true" type="directory" width="100%" height="100%" external="en1108000000/en1108070000/en1108070100/en1108070101/cm9026205814/icontext.xml"/></content-media>
<content-text><p>Take the chapter quiz to check your knowledge.</p><p><b>Click the quiz icon to begin.</b></p></content-text>
</page>
</topic>
</section>
</chapter>
