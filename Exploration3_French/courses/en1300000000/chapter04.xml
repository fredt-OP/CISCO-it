<chapter type="" id="en1304000000">
<title><content-text>VTP</content-text></title>
<section type="ChapterIntroduction" id="en1304000000">
<title><content-text>Introduction</content-text></title>
<topic type="" id="en1304000100">
<title><content-text>Introduction</content-text></title>
<page type="OneColumn" id="en1304000101">
<content-media type="ChapterIntroduction" id="cm8613096270">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304000000/en1304000100/en1304000101/cm8613096270.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304000000/en1304000100/en1304000101/cm8613096270text.xml"/></content-media>
<content-text><p>As the size of the network for a small- or medium-sized business grows, the management involved in maintaining the network grows. In the previous chapter, you learned how to create and manage VLANs and trunks using Cisco IOS commands. The focus was on managing VLAN information on a single switch. But what if you have many switches to manage? How will you manage the VLAN database across many switches? In this chapter, you will explore how you can use the VLAN Trunking Protocol (VTP) of Cisco Catalyst switches to simplify management of the VLAN database across multiple switches.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en1304010000">
<title><content-text>VTP Concepts</content-text></title>
<topic type="" id="en1304010100">
<title><content-text>What is VTP?</content-text></title>
<page type="OneColumn" id="en1304010101">
<content-media type="InteractiveGraphicHotspots" id="cm2526292267">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304010000/en1304010100/en1304010101/cm2526292267.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304010000/en1304010100/en1304010101/cm2526292267text.xml"/></content-media>
<content-text><p><b>The VLAN Management Challenge</b></p> <p>As the number of switches increases on a small- or medium-sized business network, the overall administration required to manage VLANs and trunks in a network becomes a challenge. </p> <p><b>Click Play to view an animation of the VLAN management challenge.</b></p> <p><b>Small Network VLAN Management</b></p> <p>In the animation, the figure shows a network manager adding a new VLAN, VLAN30. The network manager needs to update the three trunks to allow VLANs 10, 20, 30, and 99. Recall that a common error is forgetting to update the allowed list of VLANs on trunks. </p> <p><b>Click the Larger Network button in the figure.</b></p> <p><b>Larger Network VLAN Management</b></p> <p>When you consider the larger network in the figure, the VLAN management challenge becomes clear. After you have manually updated this network a few times, you may want to know if there is a way for the switches to learn what the VLANs and trunks are so that you do not have to manually configure them. You are ready to learn about VLAN trunking protocol (VTP).</p></content-text>
</page>
<page type="OneColumn" id="en1304010102">
<content-media type="AnimationPartialScreen" id="cm5916590822">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304010000/en1304010100/en1304010102/cm5916590822.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304010000/en1304010100/en1304010102/cm5916590822text.xml"/></content-media>
<content-text><p><b>What is VTP?</b></p> <p>VTP allows a network manager to configure a switch so that it will propagate VLAN configurations to other switches in the network. The switch can be configured in the role of a VTP server or a VTP client. VTP only learns about normal-range VLANs (VLAN IDs 1 to 1005). Extended-range VLANs (IDs greater than 1005) are not supported by VTP. </p> <p><b>Click Play in the figure </b>to view an animation of an overview of how VTP works.</p> <p><b>VTP Overview</b></p> <p>VTP allows a network manager to makes changes on a switch that is configured as a VTP server. Basically, the VTP server distributes and synchronizes VLAN information to VTP-enabled switches throughout the switched network, which minimizes the problems caused by incorrect configurations and configuration inconsistencies. VTP stores VLAN configurations in the VLAN database called vlan.dat. </p> <p><b>Click the Two Switches button in the figure.</b></p> <p><b>Two Switches</b></p> <p><b>Click Play in the figure </b>to view an animation on the basic VTP interaction between a VTP server and a VTP client.</p> <p>In the figure, a trunk link is added between switch S1, a VTP server, and S2, a VTP client. After a trunk is established between the two switches, VTP advertisements are exchanged between the switches. Both the server and client leverage advertisements from one another to ensure each has an accurate record of VLAN information. VTP advertisements will not be exchanged if the trunk between the switches is inactive. The details on how VTP works is explained in the rest of this chapter. </p></content-text>
</page>
<page type="OneColumn" id="en1304010103">
<content-media type="StaticGraphic" id="cm7269432023">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304010000/en1304010100/en1304010103/cm7269432023.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304010000/en1304010100/en1304010103/cm7269432023text.xml"/></content-media>
<content-text><p><b>Benefits of VTP</b></p> <p>You have learned that VTP maintains VLAN configuration consistency by managing the addition, deletion, and renaming of VLANs across multiple Cisco switches in a network. VTP offers a number of benefits for network managers, as shown in the figure.</p></content-text>
</page>
<page type="OneColumn" id="en1304010104">
<content-media type="InteractiveGraphicHotspots" id="cm4382668700">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304010000/en1304010100/en1304010104/cm4382668700.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304010000/en1304010100/en1304010104/cm4382668700text.xml"/></content-media>
<content-text><p><b>VTP Components</b></p> <p>There are number of key components that you need to be familiar with when learning about VTP. Here is a brief description of the components, which will be further explained as you go through the chapter. </p> <p><ul><li><b>VTP Domain</b>-Consists of one or more interconnected switches. All switches in a domain share VLAN configuration details using VTP advertisements. A router or Layer 3 switch defines the boundary of each domain.</li><li><b>VTP Advertisements</b>-VTP uses a hierarchy of advertisements to distribute and synchronize VLAN configurations across the network.</li><li><b>VTP Modes</b>- A switch can be configured in one of three modes: server, client, or transparent.</li><li><b>VTP Server</b>-VTP servers advertise the VTP domain VLAN information to other VTP-enabled switches in the same VTP domain. VTP servers store the VLAN information for the entire domain in NVRAM. The server is where VLANs can be created, deleted, or renamed for the domain.</li><li><b>VTP Client</b>-VTP clients function the same way as VTP servers, but you cannot create, change, or delete VLANs on a VTP client. A VTP client only stores the VLAN information for the entire domain while the switch is on. A switch reset deletes the VLAN information. You must configure VTP client mode on a switch.</li><li><b>VTP Transparent</b>-Transparent switches forward VTP advertisements to VTP clients and VTP servers. Transparent switches do not participate in VTP. VLANs that are created, renamed, or deleted on transparent switches are local to that switch only.</li><li><b>VTP Pruning</b>-VTP pruning increases network available bandwidth by restricting flooded traffic to those trunk links that the traffic must use to reach the destination devices. Without VTP pruning, a switch floods broadcast, multicast, and unknown unicast traffic across all trunk links within a VTP domain even though receiving switches might discard them.</li></ul></p> <p><b>Roll over the key VTP components in the figure </b>to see where they are in the network.</p></content-text>
</page>
<page type="FullScreen" id="en1304010105">
<content-media type="ActivityCustom" id="cm5575740310">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304010000/en1304010100/en1304010105/cm5575740310.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304010000/en1304010100/en1304010105/cm5575740310text.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
<section type="" id="en1304020000">
<title><content-text>VTP Operation</content-text></title>
<topic type="" id="en1304020100">
<title><content-text>Default VTP Configuration</content-text></title>
<page type="OneColumn" id="en1304020101">
<content-media type="StaticGraphic" id="cm8264223239">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020100/en1304020101/cm8264223239.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020100/en1304020101/cm8264223239text.xml"/></content-media>
<content-text><p>In CCNA Exploration: Network Fundamentals, you learned that a Cisco switch comes from the factory with default settings. The default VTP settings are shown in the figure. The benefit of VTP is that it automatically distributes and synchronizes domain and VLAN configurations across the network. However, this benefit comes with a cost, you can only add switches that are in their default VTP configuration. If you add a VTP-enabled switch that is configured with settings that supersede existing network VTP configurations, changes that are difficult to fix are automatically propagated throughout the network. So make sure that you only add switches that are in their default VTP configuration. You will learn how to add switches to a VTP network later in this chapter.</p> <p><b>VTP Versions</b></p> <p>VTP has three versions, 1, 2, and 3. Only one VTP version is allowed in a VTP domain. The default is VTP version 1. A Cisco 2960 switch supports VTP version 2, but it is disabled. A discussion of VTP versions is beyond the scope of this course. </p> <p><b>Click the Switch Output button in the figure </b>to see the default VTP settings on switch S1.</p> <p><b>Displaying the VTP Status </b></p> <p>The figure shows how to view the VTP settings for a Cisco 2960 switch, S1. The Cisco IOS command <span class="cmd"><b>show VTP status</b></span> displays the VTP status. The output shows that switch S1 is in VTP server mode by default and that there is no VTP domain name assigned. The output also shows that the maximum VTP version available for the switch is version 2, and that VTP version 2 is disabled. You will use the <span class="cmd"><b>show VTP status</b></span> command frequently as you configure and manage VTP on a network. The following briefly describes the show VTP status parameters:</p> <p><ul><li><b>VTP Version</b>-Displays the VTP version the switch is capable of running. By default, the switch implements version 1, but can be set to version 2.</li><li><b>Configuration Revision</b>-Current configuration revision number on this switch. You will learn more about revisions numbers in this chapter.</li><li><b>Maximum VLANs Supported Locally</b>-Maximum number of VLANs supported locally. </li><li><b>Number of Existing VLANs</b>-Number of existing VLANs. </li><li><b>VTP Operating Mode</b>-Can be server, client, or transparent. </li><li><b>VTP Domain Name</b>-Name that identifies the administrative domain for the switch. </li><li><b>VTP Pruning Mode</b>-Displays whether pruning is enabled or disabled. </li><li><b>VTP V2 Mode</b>-Displays if VTP version 2 mode is enabled. VTP version 2 is disabled by default.</li><li><b>VTP Traps Generation</b>-Displays whether VTP traps are sent to a network management station. </li><li><b><content-link target="{0525C058-FD1E-4372-9E02-5E084A6F8A47}" type="glossary">MD5</content-link> Digest</b>-A 16-byte <content-link target="{C0F3B456-15A1-47E6-A214-29536DCB4C7F}" type="glossary">checksum</content-link> of the VTP configuration. </li><li><b>Configuration Last Modified</b>-Date and time of the last configuration modification. Displays the IP address of the switch that caused the configuration change to the database. </li></ul></p></content-text>
</page>
</topic>
<topic type="" id="en1304020200">
<title><content-text>VTP Domains</content-text></title>
<page type="OneColumn" id="en1304020201">
<content-media type="AnimationPartialScreen" id="cm1095678853">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020200/en1304020201/cm1095678853.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020200/en1304020201/cm1095678853text.xml"/></content-media>
<content-text><p><b>VTP Domains</b></p> <p>VTP allows you to separate your network into smaller management domains to help reduce VLAN management. An additional benefit of configuring VTP domains is that it limits the extent to which configuration changes are propagated in the network if an error occurs. The figure shows a network with two VTP domains, cisco2 and cisco3. In this chapter, the three switches, S1, S2, and S3, will be configured for VTP.</p> <p>A VTP domain consists of one switch or several interconnected switches sharing the same VTP domain name. Later in this chapter, you will learn how VTP-enabled switches acquire a common domain name. A switch can be a member of only one VTP domain at a time. Until the VTP domain name is specified you cannot create or modify VLANs on a VTP server, and VLAN information is not propagated over the network.</p> <p><b>Click the Switch Output button in the figure </b>to see switch S4 output.</p></content-text>
</page>
<page type="OneColumn" id="en1304020202">
<content-media type="AnimationPartialScreen" id="cm2525866285">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020200/en1304020202/cm2525866285.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020200/en1304020202/cm2525866285text.xml"/></content-media>
<content-text><p><b>VTP Domain Name Propagation</b></p> <p>For a VTP server or client switch to participate in a VTP-enabled network, it must be a part of the same domain. When switches are in different VTP domains, they do not exchange VTP messages. A VTP server propagates the VTP domain name to all switches for you. Domain name propagation uses three VTP components: servers, clients, and advertisements. </p> <p><b>Click Play in the figure </b>to see how a VTP server propagates the VTP domain name in a network.</p> <p>The network in the figure shows three switches, S1, S2, and S3, in their default VTP configuration. They are configured as VTP servers. VTP domain names have not been configured on any of the switches. </p> <p>The network manager configures the VTP domain name as <b>cisco1</b> on the VTP server switch S1. The VTP server sends out a VTP advertisement with the new domain name embedded inside. The S2 and S3 VTP server switches update their VTP configuration to the new domain name. </p> <p><b>Note:</b> Cisco recommends that access to the domain name configuration functions be protected by a password. The details of password configuration will be presented later in the course. </p> <p>How does the domain name get placed into a VTP advertisement? What information is exchanged between VTP-enabled switches? In the next topic, you will learn about the details of VTP advertisements and find answers to these questions.</p></content-text>
</page>
</topic>
<topic type="" id="en1304020300">
<title><content-text>VTP Advertising</content-text></title>
<page type="OneColumn" id="en1304020301">
<content-media type="AnimationPartialScreen" id="cm7904046351">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020300/en1304020301/cm7904046351.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020300/en1304020301/cm7904046351text.xml"/></content-media>
<content-text><p><b>VTP Frame Structure</b></p> <p>VTP advertisements (or messages) distribute VTP domain name and VLAN configuration changes to VTP-enabled switches. In this topic, you will learn about the VTP frame structure and how the three types of advertisements enable VTP to distribute and synchronize VLAN configurations throughout the network. </p> <p><b>Click the Overview button in the figure and then click Play </b>to view an animation on the structure of a VTP frame.</p>  <p><b>VTP Frame <content-link target="{6FD9A319-ED94-4449-AC1D-24A7502A02DF}" type="glossary">Encapsulation</content-link></b></p> <p>A VTP frame consists of a header field and a message field. The VTP information is inserted into the data field of an Ethernet frame. The Ethernet frame is then encapsulated as a 802.1Q trunk frame (or ISL frame). Each switch in the domain sends periodic advertisements out each trunk port to a reserved <content-link target="{C9CAC59E-5F04-475A-9DBF-489EC4BBCBFE}" type="glossary">multicast address</content-link>. These advertisements are received by neighboring switches, which update their VTP and VLAN configurations as necessary.</p> <p><b>Click the VTP Frame Details button in the figure.</b></p> <p><b>VTP Frame Details</b></p> <p>In the figure, you can see the VTP frame structure in more detail. Keep in mind that a VTP frame encapsulated as an 802.1Q frame is not static. The contents of the VTP message determines which fields are present. The receiving VTP-enabled switch looks for specific fields and values in the 802.1Q frame to know what to process. The following key fields are present when a VTP frame is encapsulated as an 802.1Q frame:</p> <p><b>Destination MAC address</b>- This address is set to 01-00-0C-CC-CC-CC, which is the reserved multicast address for all VTP messages.</p> <p><b>LLC field</b>- Logical link control (<content-link target="{97145D4A-2F4C-4BF4-8718-20DDDB919B1C}" type="glossary">LLC</content-link>) field contains a destination service access point (<content-link target="{846B0635-4D26-4455-8FD6-92EA1EE06DEB}" type="glossary">DSAP</content-link>) and a source service access point (<content-link target="{172969E0-6F49-426F-A37F-CD7057FB6643}" type="glossary">SSAP</content-link>) set to the value of AA.</p> <p><b>SNAP field</b>- Subnetwork Access Protocol (<content-link target="{06CDFDBD-94BF-4892-B23F-07BDB158A9DC}" type="glossary">SNAP</content-link>) field has an OUI set to AAAA and type set to 2003.</p> <p><b>VTP header field</b>- The contents vary depending on the VTP message type-summary, subset, or request, but it always contains these VTP fields:</p> <p><ul><li><b>Domain name</b>- Identifies the administrative domain for the switch.</li><li><b>Domain name length</b>- Length of the domain name.</li><li><b>Version</b>- Set to either VTP 1, VTP 2, or VTP 3. The Cisco 2960 switch only supports VTP 1 and VTP 2.</li><li><b>Configuration revision number</b>- The current configuration revision number on this switch.</li></ul></p> <p><b>VTP message field</b>- Varies depending on the message type.</p> <p><b>Click the VTP Message Contents button in the figure.</b></p> <p><b>VTP Message Contents</b></p> <p>VTP frames contain the following fixed-length global domain information: </p> <p><ul><li>VTP domain name</li><li>Identity of the switch sending the message, and the time it was sent</li><li>MD5 digest VLAN configuration, including maximum transmission unit (<content-link target="{8E084A16-DBE2-402F-89CA-127F980A1F3A}" type="glossary">MTU</content-link>) size for each VLAN</li><li>Frame format: ISL or 802.1Q</li></ul></p> <p>VTP frames contain the following information for each configured VLAN: </p> <p><ul><li>VLAN IDs (IEEE 802.1Q) </li><li>VLAN name </li><li>VLAN type </li><li>VLAN state </li><li>Additional VLAN configuration information specific to the VLAN type </li></ul></p> <p><b>Note:</b> A VTP frame is encapsulated in an 802.1Q Ethernet frame. The entire 802.1Q Ethernet frame is the VTP advertisement often called a VTP message. Often the terms frame, advertisement, and message are used interchangeably.</p></content-text>
</page>
<page type="OneColumn" id="en1304020302">
<content-media type="StaticGraphic" id="cm5174280805">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020300/en1304020302/cm5174280805.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020300/en1304020302/cm5174280805text.xml"/></content-media>
<content-text><p><b>VTP Revision Number</b></p> <p>The configuration revision number is a 32-bit number that indicates the level of revision for a VTP frame. The default configuration number for a switch is zero. Each time a VLAN is added or removed, the configuration revision number is incremented. Each VTP device tracks the VTP configuration revision number that is assigned to it. </p> <p><b>Note: </b>A VTP domain name change does not increment the revision number. Instead, it resets the revision number to zero.</p> <p>The configuration revision number determines whether the configuration information received from another VTP-enabled switch is more recent than the version stored on the switch. The figure shows a network manager adding three VLANs to switch S1. </p> <p><b>Click the Switch Output button in the figure </b>to see how the revision number has been changed. </p> <p> </p> <p>The highlighted area shows that the revision number on switch S1 is 3, the number of VLANs is up to eight, because three VLANs have been added to the five default VLANs.</p> <p>The revision number plays an important and complex role in enabling VTP to distribute and synchronize VTP domain and VLAN configuration information. To comprehend what the revision number does, you first need to learn about the three types of VTP advertisements and the three VTP modes.</p></content-text>
</page>
<page type="OneColumn" id="en1304020303">
<content-media type="InteractiveGraphicHotspots" id="cm1144517990">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020300/en1304020303/cm1144517990.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020300/en1304020303/cm1144517990text.xml"/></content-media>
<content-text><p><b>VTP Advertisements</b></p> <p><b>Summary Advertisements </b></p> <p>The summary advertisement contains the VTP domain name, the current revision number, and other VTP configuration details.</p> <p>Summary advertisements are sent:</p> <p><ul><li>Every 5 minutes by a VTP server or client to inform neighboring VTP-enabled switches of the current VTP configuration revision number for its VTP domain</li><li>Immediately after a configuration has been made</li></ul></p> <p><b>Click the Summary button in the figure and then click Play </b>to view an animation on the summary VTP advertisements.</p> <p><b>Subset Advertisements </b></p> <p>A subset advertisement contains VLAN information. Changes that trigger the subset advertisement include: </p> <p><ul><li>Creating or deleting a VLAN </li><li>Suspending or activating a VLAN </li><li>Changing the name of a VLAN </li><li>Changing the MTU of a VLAN</li></ul></p> <p>It may take multiple subset advertisements to fully update the VLAN information. </p> <p><b>Click the Subset button in the figure and then click Play </b>to view an animation on the subset VTP advertisements.</p> <p><b>Request Advertisements</b></p> <p>When a request advertisement is sent to a VTP server in the same VTP domain, the VTP server responds by sending a summary advertisement and then a subset advertisement.</p> <p>Request advertisements are sent if:</p> <p><ul><li>The VTP domain name has been changed</li><li>The switch receives a summary advertisement with a higher configuration revision number than its own</li><li>A subset advertisement message is missed for some reason</li><li>The switch has been reset</li></ul></p> <p><b>Click the Request button in the figure and then click Play </b>to view an animation on the request VTP advertisements.</p></content-text>
</page>
<page type="OneColumn" id="en1304020304">
<content-media type="InteractiveGraphicHotspots" id="cm4477232327">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020300/en1304020304/cm4477232327.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020300/en1304020304/cm4477232327text.xml"/></content-media>
<content-text><p><b>VTP Advertisements Details</b></p> <p>VTP uses advertisements to distribute and synchronize information about domains and VLAN configurations. There are three main VTP advertisements. </p> <p>Each type of VTP advertisement sends information about several parameters used by VTP. A description of the fields in each of the VTP advertisements are presented. </p> <p><b>Click the Summary Details button in the figure</b>.</p> <p><b>Summary Advertisements </b></p> <p>Summary advertisements comprise the majority of VTP advertisement traffic. Roll over the fields in the summary advertisement to view the descriptions. </p> <p><b>Roll over the fields in the summary advertisement </b>to view the descriptions.</p> <p><b>Click the Subset Details button in the figure.</b></p> <p><b>Subset Advertisements </b></p> <p>The fields found in a subset advertisement are briefly described. The fields in the VLAN-info are not described.</p> <p><b>Roll over the fields in the subset advertisement </b>to view the descriptions.</p> <p><b>Click the Request Details button in the figure. </b></p> <p><b>Request Advertisements</b></p> <p>The fields found in a request advertisement are briefly described.</p>  <p><b>Roll over the fields in the request advertisement </b>to view the descriptions.</p></content-text>
</page>
</topic>
<topic type="" id="en1304020400">
<title><content-text>VTP Modes</content-text></title>
<page type="OneColumn" id="en1304020401">
<content-media type="StaticGraphic" id="cm4400705476">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020400/en1304020401/cm4400705476.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020400/en1304020401/cm4400705476text.xml"/></content-media>
<content-text><p><b>VTP Modes Overview</b></p> <p>A Cisco switch, configured with Cisco IOS software, can be configured in either server, client, or transparent mode. These modes differ in how they are used to manage and advertise VTP domains and VLANs. </p> <p><b>Server Mode</b></p> <p>In server mode, you can create, modify, and delete VLANs for the entire VTP domain. VTP server mode is the default mode for a Cisco switch. VTP servers advertise their VLAN configurations to other switches in the same VTP domain and synchronize their VLAN configurations with other switches based on advertisements received over trunk links. VTP servers keep track of updates through a configuration revision number. Other switches in the same VTP domain compare their configuration revision number with the revision number received from a VTP server to see if they need to synchronize their VLAN database. </p> <p><b>Client Mode</b></p> <p>If a switch is in client mode, you cannot create, change, or delete VLANs. In addition, the VLAN configuration information that a VTP client switch receives from a VTP server switch is stored in a VLAN database, not in NVRAM. Consequently, VTP clients require less memory than VTP servers. When a VTP client is shut down and restarted, it sends a request advertisement to a VTP server for updated VLAN configuration information.</p> <p>Switches configured as VTP clients are more typically found in larger networks, because in a network consisting of many hundreds of switches, it is harder to coordinate network upgrades. Often there are many network administrators working at different times of the day. Having only a few switches that are physically able to maintain VLAN configurations makes it easier to control VLAN upgrades and to track which network administrators performed them. </p> <p>For large networks, having client switches is also more cost-effective. By default, all switches are configured to be VTP servers. This configuration is suitable for small scale networks in which the size of the VLAN information is small and the information is easily stored in NVRAM on the switches. In a large network of many hundreds of switches, the network administrator must decide if the cost of purchasing switches with enough NVRAM to store the duplicate VLAN information is too much. A cost-conscious network administrator could choose to configure a few well-equipped switches as VTP servers, and then use switches with less memory as VTP clients. Although a discussion of network redundancy is beyond the scope of this course, know that the number of VTP servers should be chosen to provide the degree of redundancy that is desired in the network.</p> <p><b>Transparent Mode</b></p> <p>Switches configured in transparent mode forward VTP advertisements that they receive on trunk ports to other switches in the network. VTP transparent mode switches do not advertise their VLAN configuration and do not synchronize their VLAN configuration with any other switch. Configure a switch in VTP transparent mode when you have VLAN configurations that have local significance and should not be shared with the rest of the network.</p> <p>In transparent mode, VLAN configurations are saved in NVRAM (but not advertised to other switches), so the configuration is available after a switch reload. This means that when a VTP transparent mode switch reboots, it does not revert to a default VTP server mode, but remains in VTP transparent mode.</p></content-text>
</page>
<page type="OneColumn" id="en1304020402">
<content-media type="AnimationPartialScreen" id="cm1672673635">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020400/en1304020402/cm1672673635.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020400/en1304020402/cm1672673635text.xml"/></content-media>
<content-text><p><b>VTP in Action</b></p> <p>You will now see how the various VTP features come together to distribute and synchronize domain and VLAN configurations in a VTP-enabled network. The animation starts with three new switches, S1, S2, and S3, configured with their factory default settings, and finishes with all three switches configured and participating in a VTP-enabled network. </p> <p>You can pause and rewind the animation to reflect and review this process.</p></content-text>
</page>
<page type="OneColumn" id="en1304020403">
<content-media type="AnimationPartialScreen" id="cm1859213357">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020400/en1304020403/cm1859213357.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020400/en1304020403/cm1859213357text.xml"/></content-media>
<content-text><p>You have seen how VTP works with three switches. This animation examines in more detail how a switch configured in VTP transparent mode supports the functionality of VTP. </p> <p><b>Click the Play button in the figure.</b></p> <p>You can pause and rewind the animation to reflect and review this process. </p></content-text>
</page>
</topic>
<topic type="" id="en1304020500">
<title><content-text>VTP Pruning</content-text></title>
<page type="OneColumn" id="en1304020501">
<content-media type="InteractiveGraphicHotspots" id="cm6033737222">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020500/en1304020501/cm6033737222.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020500/en1304020501/cm6033737222text.xml"/></content-media>
<content-text><p>VTP pruning prevents unnecessary flooding of broadcast information from one VLAN across all trunks in a VTP domain. VTP pruning permits switches to negotiate which VLANs are assigned to ports at the other end of a trunk and, hence, prune the VLANs that are not assigned to ports on the remote switch. Pruning is disabled by default. VTP pruning is enabled using the <span class="cmd"><b>vtp pruning</b></span> global configuration command. You need to enable pruning on only one VTP server switch in the domain. In the figure, you would enable VTP pruning on switch S1. The figure shows a network with VLAN 10 and VLAN 20 configured. Switch S3 has VLAN 20 configured, and switch S2 has VLAN 10 and VLAN 20 configured. Examine the topology in the figure and then click to see the switch configurations.</p></content-text>
</page>
<page type="OneColumn" id="en1304020502">
<content-media type="AnimationPartialScreen" id="cm5441056732">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020500/en1304020502/cm5441056732.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020500/en1304020502/cm5441056732text.xml"/></content-media>
<content-text><p><b>VTP Pruning in Action</b></p> <p>Recall that a VLAN creates an isolated broadcast domain. A switch floods broadcast, multicast, and unknown unicast traffic across all trunk links within a VTP domain. When a computer or device broadcasts on a VLAN, for example, VLAN 10 in the figure, the broadcast traffic travels across all trunk links throughout the network to all ports on all switches in VLAN 10. In the figure, switches S1, S2, and S3 all receive broadcast frames from computer PC1. The broadcast traffic from PC1 consumes bandwidth on the trunk link between all 3 switches and consumes processor time on all 3 switches. The link between switches S1 and S3 does not carry any VLAN 10 traffic, so it is a candidate for VTP pruning.</p> <p><b>Click the Play button in the figure </b>to see the how VLAN flood traffic is handled on a network with no VTP pruning.</p> <p><b>VTP Pruning</b></p> <p><b>Click the VTP Pruning button and then click Play </b>to see an animation on how VLAN flood traffic is handled on a network with VTP pruning.</p> <p>The flood traffic is stopped from entering the trunk connecting switches S1 and S2. VTP pruning only prunes the egress port F0/1 on switch S2.</p></content-text>
</page>
<page type="OneColumn" id="en1304020503">
<content-media type="InteractiveGraphicHotspots" id="cm4143628004">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020500/en1304020503/cm4143628004.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304020000/en1304020500/en1304020503/cm4143628004text.xml"/></content-media>
<content-text><p><b>VTP Pruning Enabled</b></p> <p>The figure shows a network topology that has switches S1, S2, and S3 configured with VTP pruning. When VTP pruning is enabled on a network, it reconfigures the trunk links based on which ports are configured with which VLANs.</p> <p><b>Click the Switch S1 button in the figure.</b></p> <p>The highlighted area shows that the trunk on port F0/1 allows VLAN 10 traffic. VTP pruning only prunes the egress port. </p> <p><b>Click the Switch S2 button in the figure.</b></p> <p>The highlighted area shows that the trunk on port F0/1 does not allow VLAN 10 traffic. VLAN 10 is not listed. For more details on VTP pruning, visit: <content-link target="http://www.cisco.com/univercd/cc/td/doc/product/lan/cat5000/rel_4_2/config/vlans.htm#xtocid798016" type="external">http://www.cisco.com/univercd/cc/td/doc/product/lan/cat5000/rel_4_2/config/vlans.htm#xtocid798016</content-link>.</p></content-text>
</page>
<page type="FullScreen" id="en1304020504">
<content-media type="ActivityPopup" id="cm3641110978">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304020000/en1304020500/en1304020504/cm3641110978/" mime="" scale="true" type="directory" width="100%" height="100%" external="en1304000000/en1304020000/en1304020500/en1304020504/cm3641110978/icontext.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
<section type="" id="en1304030000">
<title><content-text>Configure VTP</content-text></title>
<topic type="" id="en1304030100">
<title><content-text>Configuring VTP</content-text></title>
<page type="OneColumn" id="en1304030101">
<content-media type="InteractiveGraphicHotspots" id="cm3731395118">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030100/en1304030101/cm3731395118.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030100/en1304030101/cm3731395118text.xml"/></content-media>
<content-text><p><b>VTP Configuration Guidelines</b></p> <p>Now that you are familiar with the functionality of VTP, you are ready to learn how to configure a Cisco Catalyst switch to use VTP. The topology shows the reference topology for this chapter. VTP will be configured on this topology.</p> <p><b>Click the Table button in the figure.</b></p> <p><b>VTP Server Switches</b></p> <p>Follow these steps and associated guidelines to ensure that you configure VTP successfully:</p> <p><ul><li>Confirm that all of the switches you are going to configure have been set to their default settings.</li><li>Always reset the configuration revision number before installing a previously configured switch into a VTP domain. Not resetting the configuration revision number allows for potential disruption in the VLAN configuration across the rest of the switches in the VTP domain.</li><li>Configure at least two VTP server switches in your network. Because only server switches can create, delete, and modify VLANs, you should make sure that you have one backup VTP server in case the primary VTP server becomes disabled. If all the switches in the network are configured in VTP client mode, you cannot create new VLANs on the network.</li><li>Configure a VTP domain on the VTP server. Configuring the VTP domain on the first switch enables VTP to start <content-link target="{62571AB4-07B6-4090-A0D6-89789126111B}" type="glossary">advertising</content-link> VLAN information. Other switches connected through trunk links receive the VTP domain information automatically through VTP advertisements.</li><li>If there is an existing VTP domain, make sure that you match the name exactly. VTP domain names are case-sensitive.</li><li>If you are configuring a VTP password, ensure that the same password is set on all switches in the domain that need to be able to exchange VTP information. Switches without a password or with the wrong password reject VTP advertisements.</li><li>Ensure that all switches are configured to use the same VTP protocol version. VTP version 1 is not compatible with VTP version 2. By default, Cisco Catalyst 2960 switches run version 1 but are capable of running version 2. When the VTP version is set to version 2, all version 2 capable switches in the domain autoconfigure to use version 2 through the VTP announcement process. Any version 1-only switches cannot participate in the VTP domain after that point.</li><li>Create the VLAN after you have enabled VTP on the VTP server. VLANs created before you enable VTP are removed. Always ensure that trunk ports are configured to interconnect switches in a VTP domain. VTP information is only exchanged on trunk ports.</li></ul></p> <p><b>VTP Client Switches</b></p> <p><ul><li>As on the VTP server switch, confirm that the default settings are present.</li><li>Configure VTP client mode. Recall that the switch is not in VTP client mode by default. You have to configure this mode.</li><li>Configure trunks. VTP works over trunk links. </li><li>Connect to a VTP server. When you connect to a VTP server or another VTP-enabled switch, it takes a few moments for the various advertisements to make their way back and forth to the VTP server.</li><li>Verify VTP status. Before you begin configuring the access ports, confirm that the revision mode and number of VLANs have been updated.</li><li>Configure access ports. When a switch is in VTP client mode, you cannot add new VLANs. You can only assign access ports to existing VLANs. </li></ul></p></content-text>
</page>
<page type="OneColumn" id="en1304030102">
<content-media type="InteractiveGraphicHotspots" id="cm8697763568">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030100/en1304030102/cm8697763568.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030100/en1304030102/cm8697763568text.xml"/></content-media>
<content-text><p><b>Configuring VTP Step 1 - Configure the VTP Server</b></p> <p>The next three topics will show you how to configure a VTP server and two VTP clients. Initially none of the devices are connected. </p> <p>The topology highlights switch S1. You will configure this switch to be a VTP server. The commands to configure the trunk ports are provided for interface F0/1. </p> <p><b>Click the Confirm Details button in the figure.</b></p> <p>The output of the <span class="cmd"><b>show vtp status</b></span> command confirms that the switch is by default a VTP server. Since no VLANs have yet been configured, the revision number is still set to 0 and the switch does not belong to VTP domain.</p> <p>If the switch was not already configured as a VTP server, you could configure it using the the <span class="cmd"><b>vtp mode {server}</b></span> command.</p> <p><b>Click the Configure Domain Name button in the figure.</b></p> <p>The domain name is configured using the the <span class="cmd"><b>vtp domain </b><i>domain-name</i></span> command. In the figure, switch S1 has been configured with the domain name <b>cisco1</b>. </p> <p>For security reasons, a password could be configured using the <span class="cmd"><b>vtp password </b><i>password</i></span> command.</p> <p><b>Click the Configure Version button in the figure.</b></p> <p>Most switches can support VTP version 1 and 2. However, the default setting for Catalyst 2960 switches is version 1. When the <span class="cmd"><b>vtp version 1</b></span> command is entered on the switch, it informs us that the switch is already configured to be in version 1.</p> <p><b>Click the Add VLANs and Trunks button in the figure.</b></p> <p>Assume that three VLANs have been configured and have been assigned VLANs names. The output in the figure is displaying the result of these changes. </p> <p>You can use the <span class="cmd"><b>no</b></span> version of the commands.</p></content-text>
</page>
<page type="OneColumn" id="en1304030103">
<content-media type="InteractiveGraphicHotspots" id="cm3989320677">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030100/en1304030103/cm3989320677.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030100/en1304030103/cm3989320677text.xml"/></content-media>
<content-text><p>The topology highlights switches S2 and S3. You will be shown the VTP client configuration for S2. To configure S3 as a VTP client, you will follow the same procedure.</p> <p><b>Click the Confirm Defaults button to verify the switch status.</b></p> <p>Before configuring a switch as a VTP client, verify its current VTP status. Once you've confirmed status, you will configure the switch to operate in VTP client mode.</p> <p><b>Click the Enable VTP Client Mode button </b>to see how to configure a switch for VTP client mode.</p> <p>Configure VTP client mode using the following Cisco IOS command syntax:</p> <p>Enter global configuration mode with the <span class="cmd"><b>configure terminal</b></span> command.</p> <p>Configure the switch in client mode with the <span class="cmd"><b>vtp mode</b> {<i>client</i>}</span> command.</p> <p>If you need to reset the VTP configuration to the default values, you can use the <span class="cmd"><b>no</b></span> version of the commands.</p> <p><b>Click the Verify VTP Status button </b>to see the rest of VTP client configuration.</p></content-text>
</page>
<page type="OneColumn" id="en1304030104">
<content-media type="InteractiveGraphicHotspots" id="cm2555058856">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030100/en1304030104/cm2555058856.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030100/en1304030104/cm2555058856text.xml"/></content-media>
<content-text><p><b>Configuring VTP Step 3 - Confirm and Connect</b></p> <p>After configuring the main VTP server and the VTP clients, you will connect the VTP client switch S2 to the switch S1 VTP server.</p> <p>The topology highlights the trunks that will be added to this topology. In the figure, switch S2 will be connected to switch S1. Then switch S2 will be configured to support the computers, PC1 to PC3. The same procedure will be applied to switch S3, although the commands for S3 are not shown.</p> <p><b>Confirm VTP Operation</b></p> <p><b>Click the Confirm VTP Operation button in the figure.</b></p> <p>There are two Cisco IOS commands for confirming that VTP domain and VLAN configurations have been transferred to switch S2. Use the show VTP status command to verify the following:</p> <p><ul><li>Configuration revision number has been incremented to 6.</li><li>There are now three new VLANs indicated by the existing number of VLANs showing 8.</li><li>Domain name has been changed to cisco1.</li></ul></p> <p>Use the <span class="cmd"><b>show vtp counters</b></span> command to confirm that the advertisements took place.</p> <p><b>Configure Access Ports</b></p> <p><b>Click the Configure Access Ports button in the figure.</b></p> <p>The top highlight in the screen output confirms that the switch S2 is in VTP client mode. The task now is to configure the port F0/18 on switch S2 to be in VLAN 20. The bottom highlighted area shows the Cisco IOS command used to configure port F0/18 on switch S2 to be in VLAN 20.</p></content-text>
</page>
</topic>
<topic type="" id="en1304030200">
<title><content-text>Troubleshooting VTP Configurations</content-text></title>
<page type="OneColumn" id="en1304030201">
<content-media type="StaticGraphic" id="cm1798055972">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030200/en1304030201/cm1798055972.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030200/en1304030201/cm1798055972text.xml"/></content-media>
<content-text><p><b>Troubleshooting VTP Connections</b></p> <p>You have learned how VTP can be used to simplify managing a VLAN database across multiple switches. In this topic, you will learn about common VTP configuration problems. This information, combined with your VTP configuration skills, will help you when troubleshooting VTP configuration problems.</p> <p>The figure lists the common VTP configuration issues that will be explored in this topic.</p></content-text>
</page>
<page type="OneColumn" id="en1304030202">
<content-media type="InteractiveGraphicHotspots" id="cm7059236147">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030200/en1304030202/cm7059236147.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030200/en1304030202/cm7059236147text.xml"/></content-media>
<content-text><p><b>Incompatible VTP Versions</b></p> <p>VTP versions 1 and 2 are incompatible with each other. Modern Cisco Catalyst switches, such as the 2960, are configured to use VTP version 1 by default. However, older switches may only support VTP version 1. Switches that only support version 1 cannot participate in the VTP domain along with version 2 switches. If your network contains switches that support only version 1, you need to manually configure the version 2 switches to operate in version 1 mode.</p> <p><b>Click the VTP Version Solution button in the figure.</b></p> <p><b>VTP Password Issues</b></p> <p>When using a VTP password to control participation in the VTP domain, ensure that the password is set correctly on all switches in the VTP domain. Forgetting to set a VTP password is a very common problem. If a password is used, it must be configured on each switch in the domain. By default, a Cisco switch does not use a VTP password. The switch does not automatically set the password parameter, unlike other parameters that are set automatically when a VTP advertisement is received.</p> <p><b>Click the VTP Password Solution button in the figure.</b></p></content-text>
</page>
<page type="OneColumn" id="en1304030203">
<content-media type="InteractiveGraphicHotspots" id="cm9158203943">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030200/en1304030203/cm9158203943.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030200/en1304030203/cm9158203943text.xml"/></content-media>
<content-text><p><b>Incorrect VTP Domain Name</b></p> <p>The VTP domain name is a key parameter that is set on a switch. An improperly configured VTP domain affects VLAN synchronization between switches. As you learned earlier, if a switch receives the wrong VTP advertisement, the switch discards the message. If the discarded message contains legitimate configuration information, the switch does not synchronize its VLAN database as expected.</p> <p><b>Click Play in the figure </b>to see an animation of this issue.</p> <p><b>Click the VTP Domain Solution button in the figure.</b></p> <p><b>Solution</b></p> <p>To avoid incorrectly configuring a VTP domain name, only set the VTP domain name on one VTP server switch. All other switches in the same VTP domain will accept and automatically configure their VTP domain name when they receive the first VTP summary advertisement. </p></content-text>
</page>
<page type="OneColumn" id="en1304030204">
<content-media type="InteractiveGraphicHotspots" id="cm6992424529">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030200/en1304030204/cm6992424529.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030200/en1304030204/cm6992424529text.xml"/></content-media>
<content-text><p><b>Switches Set to VTP Client Mode</b></p> <p>It is possible to change the operating mode of all switches to VTP client. By doing so, you lose all ability to create, delete, and manage VLANs within your network environment. Because the VTP client switches do not store the VLAN information in NVRAM, they need to refresh the VLAN information after a reload.</p> <p><b>Click Play in the figure </b>to see an animation of this issue.</p> <p><b>Click the Solution button in the figure.</b></p> <p><b>Solution</b></p> <p>To avoid losing all VLAN configurations in a VTP domain by accidentally reconfiguring the only VTP server in the domain as a VTP client, you can configure a second switch in the same domain as a VTP server. It is not uncommon for small networks that use VTP to have all the switches in VTP server mode. If the network is being managed by a couple of network administrators, it is unlikely that conflicting VLAN configurations will arise.</p></content-text>
</page>
<page type="OneColumn" id="en1304030205">
<content-media type="InteractiveGraphicHotspots" id="cm7656359277">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030200/en1304030205/cm7656359277.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030200/en1304030205/cm7656359277text.xml"/></content-media>
<content-text><p><b>Incorrect Revision Number</b></p> <p>Even after you have configured the switches in your VTP domain correctly, there are other factors that can adversely affect the functionality of VTP.</p> <p><b>Configuration Revision Number Issues</b></p> <p>The topology in the figure is configured with VTP. There is one VTP server switch, S1, and two VTP client switches, S2 and S3. </p> <p><b>Click the Incorrect Revision Number button in the figure</b> to play an animation showing how the addition of a switch with a higher configuration revision number affects the rest of the switches in the VTP domain.</p> <p>S4, which has been previously configured as a VTP client, is added to the network. The revision number of the switch S4 is 35, which is higher than the revision number of 17 in the existing network. S4 comes preconfigured with two VLANs, 30 and 40, that are not configured in the existing network. The existing network has VLANs 10 and 20.</p> <p>When switch S4 is connected to switch S3, VTP summary advertisements announce the arrival of a VTP-enabled switch with the highest revision number in the network. The animation shows how switch S3, switch S1, and finally switch S2 all reconfigure themselves to the configuration found in switch S4. As each switch reconfigures itself with VLANs that are not supported in the network, the ports no longer forward traffic from the computers because they are configured with VLANs that no longer exist on the newly reconfigured switches.</p> <p><b>Click the Reset Revision Number button in the figure.</b></p> <p><b>Solution</b></p> <p>The solution to the problem is to reset each switch back to an earlier configuration and then reconfigure the correct VLANs, 10 and 20, on switch S1. To prevent this problem in the first place, reset the configuration revision number on previously configured switches being added to a VTP-enabled network. The figure shows the commands needed to reset switch S4 back to the default revision number.</p> <p><b>Click Verify Revision Number button in the figure </b>to see that switch S4 has had its revision number reset.</p></content-text>
</page>
</topic>
<topic type="" id="en1304030300">
<title><content-text>Managing VLANs on a VTP Server</content-text></title>
<page type="OneColumn" id="en1304030301">
<content-media type="StaticGraphic" id="cm7885344119">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030300/en1304030301/cm7885344119.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304030000/en1304030300/en1304030301/cm7885344119text.xml"/></content-media>
<content-text><p><b>Managing VLANs on a VTP Server</b></p> <p>You have learned about VTP and how it can be used to simplify managing VLANs in a VTP-enabled network. Consider the topology in the figure. When a new VLAN, for example, VLAN 10, is added to the network, the network manager adds the VLAN to the VTP server, switch S1 in the figure. As you know, VTP takes care of propagating the VLAN configuration details to the rest of the network. It does not have any effect on which ports are configured in VLAN 10 on switches S1, S2, and S3. </p> <p><b>Click the Configure New VLANs and Ports button in the figure.</b></p> <p>The figure displays the commands used to configure VLAN 10 and the port F0/11 on switch S1. The commands to configure the correct ports for switches S2 and S3 are not shown. </p> <p>After you have configured the new VLAN on switch S1 and configured the ports on switches S1, S2, and S3 to support the new VLAN, confirm that VTP updated the VLAN database on switches S2 and S3. </p> <p><b>Click the </b><span class="cmd"><b>show vtp status</b></span><b> button in the figure.</b></p> <p>The output of the command is used to verify the configuration on switch S2. The verification for S3 is not shown. </p> <p><b>Click the </b><span class="cmd"><b>show interfaces trunk</b></span><b> button in the figure.</b></p> <p>The output confirms that the new VLAN has been added to F0/1 on switch S2. The highlighted area shows that VLAN 10 is now active in the VTP management domain.</p></content-text>
</page>
<page type="OneColumn" id="en1304030302">
<content-media type="ActivityPKA" id="cm8709840478">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304030000/en1304030300/en1304030302/cm8709840478/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304030000/en1304030300/en1304030302/cm8709840478/icontext.xml"/></content-media>
<content-text><p>In this activity, you will practice configuring VTP. When Packet Tracer first opens, the switches already contain a partial configuration.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E3_PTAct_4_3_3.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en1304040000">
<title><content-text>Chapter Labs</content-text></title>
<topic type="" id="en1304040100">
<title><content-text>Basic VTP Configuration</content-text></title>
<page type="OneColumn" id="en1304040101">
<content-media type="ActivityLab" id="cm5628327335">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304040000/en1304040100/en1304040101/cm5628327335/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304040000/en1304040100/en1304040101/cm5628327335/icontext.xml"/></content-media>
<content-text><p>Imagine a network with 50 switches with a total of 12 identical VLANs each. If you had to manually type in the commands to each switch, it would be a huge undertaking. It would be so much easier if you could configure those 12 VLANs once, and then allow those VLANs to be propagated automatically to the other 49 switches. VTP configuration makes this possible.</p></content-text>
</page>
<page type="OneColumn" id="en1304040102">
<content-media type="ActivityPKA" id="cm8713987475">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304040000/en1304040100/en1304040102/cm8713987475/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304040000/en1304040100/en1304040102/cm8713987475/icontext.xml"/></content-media>
<content-text><p>This activity is a variation of Lab 4.4.1. Packet Tracer may not support all the tasks specified in the hands-on lab. This activity should not be considered equivalent to completing the hands-on lab. Packet Tracer is not a substitute for a hands-on lab experience with real equipment. </p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E3_PTAct_4_4_1.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1304040200">
<title><content-text>VTP Configuration Challenge</content-text></title>
<page type="OneColumn" id="en1304040201">
<content-media type="ActivityLab" id="cm7774515877">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304040000/en1304040200/en1304040201/cm7774515877/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304040000/en1304040200/en1304040201/cm7774515877/icontext.xml"/></content-media>
<content-text><p>How much of the basics of VTP configuration do you remember? Let's see how much you can configure from memory having completed the Basic VTP lab. Be sure to check your work with the answer key that your instructor will provide.</p></content-text>
</page>
<page type="OneColumn" id="en1304040202">
<content-media type="ActivityPKA" id="cm6721878542">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304040000/en1304040200/en1304040202/cm6721878542/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304040000/en1304040200/en1304040202/cm6721878542/icontext.xml"/></content-media>
<content-text><p>This activity is a variation of Lab 4.4.2. Packet Tracer may not support all the tasks specified in the hands-on lab. This activity should not be considered equivalent to completing the hands-on lab. Packet Tracer is not a substitute for a hands-on lab experience with real equipment.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E3_PTAct_4_4_2.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1304040300">
<title><content-text>Troubleshooting VTP Configuration</content-text></title>
<page type="OneColumn" id="en1304040301">
<content-media type="ActivityLab" id="cm2173816259">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304040000/en1304040300/en1304040301/cm2173816259/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304040000/en1304040300/en1304040301/cm2173816259/icontext.xml"/></content-media>
<content-text><p>In this lab, you will use the supplied scripts to configure S1 as a VTP server, and S2 and S3 as VTP clients. However, there are a number of errors in this configuration that you must troubleshoot and correct before end-to-end connectivity within the VLAN is restored.</p> <p>You will have successfully resolved all errors when the same VLANs are configured on all three switches, and you can ping between any two hosts in the same VLAN or between any two switches. </p></content-text>
</page>
<page type="OneColumn" id="en1304040302">
<content-media type="ActivityPKA" id="cm8335949189">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304040000/en1304040300/en1304040302/cm8335949189/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304040000/en1304040300/en1304040302/cm8335949189/icontext.xml"/></content-media>
<content-text><p>This activity is a variation of Lab 4.4.3. Packet Tracer may not support all the tasks specified in the hands-on lab. This activity should not be considered equivalent to completing the hands-on lab. Packet Tracer is not a substitute for a hands-on lab experience with real equipment.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E3_PTAct_4_4_3.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en1304050000">
<title><content-text>Chapter Summary</content-text></title>
<topic type="" id="en1304050100">
<title><content-text>Summary</content-text></title>
<page type="OneColumn" id="en1304050101">
<content-media type="ChapterSummary" id="cm5169377359">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304050000/en1304050100/en1304050101/cm5169377359.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304050000/en1304050100/en1304050101/cm5169377359text.xml"/></content-media>
<content-text><p>In this chapter, we discussed the VLAN trunking protocol. VTP is a Cisco-proprietary protocol used to exchange VLAN information across trunk links, reducing VLAN administration and configuration errors. VTP allows you to create a VLAN once within a VTP domain and have that VLAN propagated to all other switches in the VTP domain.</p> <p>There are three VTP operating modes: server, client, and transparent. VTP client mode switches are more prevalent in large networks, where there definition reduces the administration of VLAN information. In small networks, network managers can more easily keep track of network changes, so switches are often left in the default VTP server mode. </p> <p>VTP pruning limits the unnecessary propagation of VLAN traffic across a LAN. VTP determines which trunk ports forward which VLAN traffic. VTP pruning improves overall network performance by restricting the unnecessary flooding of traffic across trunk links. Pruning only permits VLAN traffic for VLANs that are assigned to some switch port of a switch on the other end of a trunk link. By reducing the total amount of flooded traffic on the network, bandwidth is freed up for other network traffic. </p> <p>We discussed VTP configuration and preventative measures to take to avoid common problematic VTP issues. </p></content-text>
</page>
<page type="FullScreen" id="en1304050102">
<content-media type="StaticGraphic" id="cm8332934642">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304050000/en1304050100/en1304050102/cm8332934642.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1304000000/en1304050000/en1304050100/en1304050102/cm8332934642text.xml"/></content-media>
<content-text></content-text>
</page>
<page type="OneColumn" id="en1304050103">
<content-media type="ActivityPKA" id="cm4308927095">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304050000/en1304050100/en1304050103/cm4308927095/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1304000000/en1304050000/en1304050100/en1304050103/cm4308927095/icontext.xml"/></content-media>
<content-text><p>In this activity, you will configure switches including basic configuration, port security, trunking and VLANs. You will use VTP to advertise the VLAN configurations to other switches.</p> <p><content-link target="E3_PTAct_4_5_1.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b> </p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="en1304060000">
<title><content-text>Chapter Quiz</content-text></title>
<topic type="" id="en1304060100">
<title><content-text>Chapter Quiz</content-text></title>
<page type="FullScreen" id="en1304060101">
<content-media type="ChapterQuiz" id="cm8867674065">	<title><content-text></content-text></title>	<media ref="en1304000000/en1304060000/en1304060100/en1304060101/cm8867674065/" mime="" scale="true" type="directory" width="100%" height="100%" external="en1304000000/en1304060000/en1304060100/en1304060101/cm8867674065/icontext.xml"/></content-media>
<content-text><p>Chapter Quiz</p></content-text>
</page>
</topic>
</section>
</chapter>
