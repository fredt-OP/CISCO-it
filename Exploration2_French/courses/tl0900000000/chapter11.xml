<chapter type="" id="tl0911000000">
<title><content-text>Protocole OSPF</content-text></title>
<section type="ChapterIntroduction" id="tl0911000000">
<title><content-text>Présentation du chapitre</content-text></title>
<topic type="" id="tl0911000100">
<title><content-text>Présentation du chapitre</content-text></title>
<page type="OneColumn" id="tl0911000101">
<content-media type="StaticGraphic" id="cm3978973762"><title><content-text></content-text></title><media ref="tl0911000000/tl0911000000/tl0911000100/tl0911000101/cm3978973762.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911000000/tl0911000100/tl0911000101/cm3978973762text.xml"/></content-media>
<content-text><p>Le protocole OSPF (Open Shortest Path First) est un protocole de routage à état de liens qui a été développé pour remplacer le protocole de routage à vecteur de distance RIP. RIP était acceptable au début des réseaux et de l’Internet, mais le fait qu’il choisisse la meilleure route en prenant en compte uniquement le nombre de sauts est rapidement devenu inacceptable dans des réseaux plus grands nécessitant une solution de routage plus fiable. OSPF est un protocole de routage sans classe qui utilise le concept de <i>zones</i> pour son évolutivité. Le document RFC 2328 définit la métrique OSPF comme une valeur arbitraire nommée <i>coût</i>. Le système d’exploitation Internet (IOS) de Cisco utilise la bande passante comme métrique de coût du protocole OSPF. </p> <p>Les principaux avantages d’OSPF sur RIP sont une convergence rapide et une évolutivité vers la mise en œuvre de réseaux bien plus importants. Dans ce dernier chapitre de <i>Protocoles et concepts de routage</i>, vous allez étudier l’implémentation et les configurations d’un protocole OSPF à zone unique. Les configurations et les concepts OSPF plus complexes sont réservés à des cours de niveau CCNP.</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911010000">
<title><content-text>Présentation du protocole OSPF</content-text></title>
<topic type="" id="tl0911010100">
<title><content-text>Origines du protocole OSPF</content-text></title>
<page type="OneColumn" id="tl0911010101">
<content-media type="InteractiveGraphicRollovers" id="cm2888565200"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010100/tl0911010101/cm2888565200.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010100/tl0911010101/cm2888565200text.xml"/></content-media>
<content-text><p>Le développement initial du protocole OSPF a débuté en 1987, mené par le groupe de travail OSPF de l’IETF (Internet Engineering Task Force). À cette époque, Internet était un réseau dédié à l&apos;enseignement et à la recherche fondé par le gouvernement des États-Unis.</p> <p><b>Placez le pointeur sur les dates du calendrier de développement du protocole OSPF pour afficher les différents événements. </b></p> <p>En 1989, la spécification du protocole OSPFv1 fut publiée dans le document RFC 1131. Deux mises en œuvre y étaient décrites : l’une s’exécutait sur des routeurs, l’autre sur des stations de travail UNIX. Cette dernière devint par la suite un processus UNIX très répandu connu sous le nom de GATED. OSPFv1 était un protocole de routage expérimental qui ne fut jamais déployé.</p> <p>En 1991, OSPFv2 fut présenté dans le document RFC 1247 par John Moy. Ce protocole offrait des améliorations techniques significatives par rapport à OSPFv1. Dans le même temps, ISO travaillait sur un protocole de routage à état de liens de leur cru, le protocole IS-IS (Intermediate System-to-Intermediate System). Sans surprise, IETF choisit de recommander le protocole OSPF comme IGP (Interior Gateway Protocol – Protocole de passerelle interne). </p> <p>En 1998, la spécification OSPFv2 fut mise à jour dans le document RFC 2328, qui est toujours le document RFC d’actualité pour OSPF. </p> <p><b>Remarque : </b>en 1999, OSPFv3 pour IPv6 fut publié dans le document RFC 2740, rédigé par John Moy, Rob Coltun et Dennis Ferguson. Le protocole OSPFv3 est traité dans CCNP.</p> <p><b>Liens</b></p> <p>« OSPF Version 2 », <content-link target="http://www.ietf.org/rfc/rfc2328.txt" type="external">http://www.ietf.org/rfc/rfc2328.txt</content-link></p></content-text>
</page>
</topic>
<topic type="" id="tl0911010200">
<title><content-text>Encapsulation de message OSPF</content-text></title>
<page type="OneColumn" id="tl0911010201">
<content-media type="InteractiveGraphicRollovers" id="cm3255376418"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010200/tl0911010201/cm3255376418.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010200/tl0911010201/cm3255376418text.xml"/></content-media>
<content-text><p>La partie données d’un message OSPF est encapsulée dans un paquet. Cette zone de données peut inclure un des 5 types de paquets OSPF. Chacun d’eux est brièvement présenté dans la rubrique qui suit.</p> <p><b>Placez votre pointeur sur les champs du schéma du message OSPF encapsulé pour voir le processus d’encapsulation. </b></p> <p>L’en-tête de paquet OSPF est inclus dans chaque paquet OSPF, quel que soit son type. L’en-tête de paquet OSPF et les données spécifiques relatives à son type sont ensuite encapsulés dans le paquet IP. Dans l’en-tête de paquet IP, le champ protocole est défini à 89 pour indiquer OSPF, et l’adresse de destination a pour valeur une des deux adresses multidiffusion suivantes : 224.0.0.5 ou 224.0.0.6. Si le paquet OSPF est encapsulé dans une trame Ethernet, l’adresse MAC de destination est elle aussi une adresse multidiffusion : 01-00-5E-00-00-05 ou 01-00-5E-00-00-06.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010300">
<title><content-text>Types de paquet OSPF</content-text></title>
<page type="OneColumn" id="tl0911010301">
<content-media type="StaticGraphic" id="cm2901875363"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010300/tl0911010301/cm2901875363.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010300/tl0911010301/cm2901875363text.xml"/></content-media>
<content-text><p>Dans le chapitre précédent, nous avons présenté les paquets LSP (Link-State Packet). Le schéma montre les cinq différents types de LSP OSPF. Chacun d’eux a un objectif spécifique dans le processus de routage OSPF :</p> <p>1. <b>Hello</b> - les paquets Hello servent à établir puis à maintenir la contiguïté avec d’autres routeurs OSPF. Le protocole Hello est expliqué en détail dans la rubrique suivante. </p> <p>2. <b>DBD</b> - le paquet <content-link target="cg9049355325" type="glossary">descripteur de base de données</content-link> contient une liste abrégée de la base de données à état de liens du routeur expéditeur et est utilisé par les routeurs de destination pour contrôler la base de données à état de liens locale. </p> <p>3. <b>LSR</b> - les routeurs de destination peuvent alors demander plus d’informations sur n’importe quelle entrée du DBD, en envoyant un paquet <content-link target="cg7438722925" type="glossary">LSR (Link-State Request)</content-link>. </p> <p>4. <b>LSU</b> - les paquets <content-link target="cg1133628043" type="glossary">LSU (Link-State Update)</content-link> sont utilisés pour répondre aux LSR, ainsi que pour annoncer de nouvelles informations. Les LSU contiennent sept types différents de LSA (Link-State Advertisements). Les LSU et les LSA seront brièvement abordés dans un chapitre ultérieur.</p> <p>5. <b>LSAck</b> - lors de la réception d’un paquet LSU, le routeur envoie un paquet <content-link target="cg8742800150" type="glossary">LSAck (Link-State Acknowledgement)</content-link> pour en confirmer la bonne réception.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010400">
<title><content-text>Protocole Hello</content-text></title>
<page type="OneColumn" id="tl0911010401">
<content-media type="AnimationPartialScreen" id="cm9806564439"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010400/tl0911010401/cm9806564439.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010400/tl0911010401/cm9806564439text.xml"/></content-media>
<content-text><p>Le schéma montre l’en-tête de paquet OSPF et le paquet Hello. Les champs affichés en bleu seront abordés plus en détail, plus tard dans ce chapitre. Pour le moment, concentrons-nous sur les utilisations des paquets Hello. </p> <p>Le premier type de paquet OSPF est le paquet Hello. Les paquets Hello sont utilisés pour :</p> <p><ul><li> découvrir des voisins OSPF et établir des contiguïtés ;</li><li> annoncer les paramètres sur lesquels les deux routeurs doivent s’accorder pour devenir voisins ;</li><li> définir le <content-link target="cg9839475267" type="glossary">routeur désigné (DR)</content-link> et le <content-link target="cg4534692650" type="glossary">routeur désigné de sauvegarde</content-link> (BDR) sur les réseaux à accès multiple, de type Ethernet et Frame Relay.</li></ul></p> <p>Les champs importants indiqués dans le schéma incluent :</p> <p><ul><li><b>Type : </b>type de paquet OSPF : Hello (1), DBD (2), LSR (3), LSU (4), LSACK (5)</li><li><b>ID du routeur :</b> ID du routeur source</li><li><b>ID de zone : </b>zone d’origine du paquet</li><li><b>Masque de réseau : </b>masque de sous-réseau associé à l’interface émettrice</li><li><b>Intervalle Hello :</b> nombre de secondes entre les intervalles Hello du routeur émetteur</li><li><b>Priorité du routeur : </b>utilisé dans la sélection du routeur désigné ou du routeur désigné de sauvegarde (étudiée ultérieurement)</li><li><b>Routeur désigné (DR) :</b> ID du routeur désigné, le cas échéant</li><li><b>Routeur désigné de sauvegarde (BDR) : </b>ID du routeur désigné de sauvegarde, le cas échéant</li><li><b>Liste des voisins :</b> indique l’ID de routeur OSPF du ou des routeurs voisins</li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl0911010402">
<content-media type="StaticGraphic" id="cm2206684110"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010400/tl0911010402/cm2206684110.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010400/tl0911010402/cm2206684110text.xml"/></content-media>
<content-text><p><b>Détection des voisins</b></p> <p>Pour pouvoir diffuser ses états de liens aux autres routeurs, un routeur OSPF doit d’abord déterminer s’il existe d’autres voisins OSPF sur un de ses liens. Dans le schéma, les routeurs OSPF envoient des paquets Hello sur toutes les interfaces OSPF pour déterminer s’il existe des voisins sur ces liens. Les informations contenues dans les paquets Hello OSPF comprennent l’ID routeur OSPF du routeur qui envoie le paquet Hello (l’ID de routeur est abordé plus tard dans ce chapitre). La réception d’un paquet Hello OSPF confirme à un routeur qu’il existe un autre routeur OSPF sur le lien. OSPF établit ainsi des contiguïtés avec le voisin. Par exemple, sur le schéma, R1 établit une contiguïté avec R2 et R3.</p> <p><b>Intervalles des paquets Hello et Dead OSPF</b></p> <p>Pour que deux routeurs puissent former une contiguïté de voisinage OSPF, ils doivent d’abord s’entendre sur trois valeurs : l’intervalle Hello, l’intervalle Dead (arrêt) et le type de réseau. L’intervalle Hello OSPF indique la fréquence à laquelle un routeur OSPF envoie des paquets Hello. Par défaut, les paquets Hello OSPF sont envoyés toutes les 10 secondes sur des segments à accès multiple et point à point et toutes les 30 secondes sur les segments d’<content-link target="cg9847456962" type="glossary">accès NBMA</content-link> (Frame Relay, X.25, ATM). </p> <p>Dans la plupart des cas, les paquets Hello OSPF sont envoyés en multidiffusion à une adresse réservée aux <i><content-link target="cg4679715108" type="glossary">ALLSPFRouters</content-link></i>, à 224.0.0.5. Le fait d’utiliser une adresse multidiffusion permet à un périphérique d’ignorer le paquet si son interface n’est pas activée pour accepter les paquets OSPF. Cela permet d’économiser du temps processeur sur les périphériques non-OSPF.</p> <p>L’intervalle Dead est la période, exprimée en secondes, pendant laquelle le routeur attendra de recevoir un paquet Hello avant de déclarer le voisin « hors service ». Cisco utilise par défaut le quadruple de l’intervalle Hello. Pour les segments à accès multiple et point à point, cette période est de 40 secondes. Pour les réseaux NBMA, l’intervalle Dead est de 120 secondes. </p> <p>Si l’intervalle Dead expire avant que les routeurs ne reçoivent un paquet Hello, OSPF supprime le voisin de sa base de données à état de liens. Le routeur diffuse alors l’information d’état de liens concernant le voisin « hors service » vers toutes les interfaces OSPF. </p> <p>Les types de réseau sont traités ultérieurement dans le chapitre.</p> <p><b>Sélection d’un routeur désigné et d’un routeur désigné de sauvegarde</b></p> <p>Pour réduire le trafic OSPF sur les réseaux à accès multiple, OSPF choisit un routeur désigné (DR) et un routeur désigné de sauvegarde (BDR). Le DR est chargé de la mise à jour de tous les autres routeurs OSPF (appelés <content-link target="cg7298380285" type="glossary">DROthers</content-link>), lorsqu’une modification a lieu au niveau du réseau à accès multiple. Le BDR surveille le DR et prend sa place en tant que routeur désigné si ce dernier tombe en panne. </p> <p>Dans le schéma, R1, R2 et R3 sont connectés via des liaisons point à point. Donc, aucune sélection de DR/BDR n’a lieu. Le choix du DR et du BDR et les processus seront traités plus tard et la topologie sera changée en réseau à accès multiple.</p> <p><b>Remarque :</b> les paquets Hello sont étudiés plus en détail dans le cours CCNP, avec les autres types de paquets OSPF. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911010500">
<title><content-text>Mises à jour d’état de liens OSPF</content-text></title>
<page type="OneColumn" id="tl0911010501">
<content-media type="StaticGraphic" id="cm3817145446"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010500/tl0911010501/cm3817145446.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010500/tl0911010501/cm3817145446text.xml"/></content-media>
<content-text><p>Les paquets LSU (Link-State Update) sont les paquets utilisés pour les mises à jour du routage OSPF. Un paquet LSU peut contenir 11 types différents de LSA (Link-State Advertisements), comme indiqué dans le schéma. La différence entre les acronymes LSU (Link-State Update) et <content-link target="cg7038442778" type="glossary">LSA (Link-State Advertisement)</content-link> peut parfois être difficile à comprendre. Ces termes sont parfois utilisés indifféremment. Un paquet LSU contient un ou plusieurs LSA et les deux acronymes peuvent s’utiliser pour désigner les informations d’état de liens propagées par les routeurs OSPF.</p> <p><b>Remarque : </b> les différents types de LSA sont abordés dans CCNP.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010600">
<title><content-text>Algorithme OSPF</content-text></title>
<page type="OneColumn" id="tl0911010601">
<content-media type="StaticGraphic" id="cm1474132476"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010600/tl0911010601/cm1474132476.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010600/tl0911010601/cm1474132476text.xml"/></content-media>
<content-text><p>Chaque routeur OSPF conserve une base de données d’état de liens contenant les LSA reçus de tous les autres routeurs. Une fois qu’un routeur a reçu tous les LSA et créé sa base de données à état de liens locale, OSPF utilise l’algorithme du plus court chemin de Dijkstra (SPF) pour créer une arborescence SPF. L’arborescence SPF est ensuite utilisée pour fournir à la table de routage IP les meilleurs chemins vers chaque réseau.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911010700">
<title><content-text>Distance administrative</content-text></title>
<page type="OneColumn" id="tl0911010701">
<content-media type="StaticGraphic" id="cm3147192772"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010700/tl0911010701/cm3147192772.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010700/tl0911010701/cm3147192772text.xml"/></content-media>
<content-text><p>Comme vous l’avez appris dans le chapitre 3, « Présentation des protocoles de routage dynamique », la distance administrative correspond à la fiabilité (ou préférence) de la route source. La distance administrative par défaut OSPF est de 110. Comme vous le voyez dans le schéma, comparé aux autres protocoles IGP (protocoles de passerelle intérieure), le protocole OSPF est préféré aux protocoles IS-IS et RIP. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911010800">
<title><content-text>Authentification</content-text></title>
<page type="OneColumn" id="tl0911010801">
<content-media type="StaticGraphic" id="cm2326913933"><title><content-text></content-text></title><media ref="tl0911000000/tl0911010000/tl0911010800/tl0911010801/cm2326913933.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911010000/tl0911010800/tl0911010801/cm2326913933text.xml"/></content-media>
<content-text><p>Comme nous l’avons indiqué précédemment, la configuration des protocoles de routage permettant d’utiliser l’authentification sera étudiée dans un cours ultérieur. Comme d’autres protocoles de routage, OSPF peut être configuré pour l’authentification. </p> <p>Cela constitue une pratique saine. Les protocoles RIPv2, EIGRP, OSPF, IS-IS et BGP peuvent tous être configurés pour chiffrer et authentifier leurs informations de routage. Cette pratique garantit que les routeurs n’accepteront que les informations en provenance de routeurs ayant été configurés avec le même mot de passe ou les mêmes informations d’authentification. </p> <p><b>Remarque :</b> l’authentification ne chiffre pas la table de routage du routeur. </p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911020000">
<title><content-text>Configuration OSPF de base</content-text></title>
<topic type="" id="tl0911020100">
<title><content-text>Travaux pratiques de topologie</content-text></title>
<page type="OneColumn" id="tl0911020101">
<content-media type="InteractiveGraphicHotspots" id="cm6146016532"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020100/tl0911020101/cm6146016532.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020100/tl0911020101/cm6146016532text.xml"/></content-media>
<content-text><p>Le schéma montre la topologie utilisée pour ce chapitre. Notez que le schéma d’adressage est non contigu. Le protocole OSPF est un protocole de routage sans classe. C’est pour cette raison que dans notre configuration OSPF, nous configurerons un masque. Comme vous le savez, cette opération permet de remédier au problème de l’adressage non contigu. Notez également que dans cette topologie, il existe trois liaisons série avec bandes passantes différentes et que chacun des routeurs peut emprunter plusieurs chemins vers chacun des réseaux distants.</p> <p><b>Cliquez sur Adressage pour consulter les adresses IP.</b></p> <p> </p> <p><b>Cliquez sur R1, R2 et R3 pour visualiser la configuration de départ de chacun des routeurs.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0911020200">
<title><content-text>Commande router ospf</content-text></title>
<page type="OneColumn" id="tl0911020201">
<content-media type="InteractiveGraphicHotspots" id="cm8087429524"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020200/tl0911020201/cm8087429524.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020200/tl0911020201/cm8087429524text.xml"/></content-media>
<content-text><p>OSPF est activé à l’aide de la commande de configuration globale <span class="cmd"><b>router ospf </b><i>process-id</i></span>. Le <span class="cmd"><i>process-id</i></span> (id de processus) est un nombre compris entre 1 et 65535 choisi par l’administrateur réseau. Le <span class="cmd"><i>process-id</i></span> n’a qu’une signification locale, ce qui veut dire qu’il n’a pas à correspondre à celui des autres routeurs OSPF pour établir des contiguïtés avec des voisins, contrairement à ce qui se passe dans le protocole EIGRP. Le numéro de système autonome ou l’ID de processus EIGRP <i>doit</i> correspondre pour que deux voisins EIGRP deviennent contigus.</p> <p>Dans notre topologie, nous allons activer OSPF sur les trois routeurs en utilisant le même ID de processus, à savoir 1. Nous utilisons le même ID de processus uniquement à des fins de cohérence.</p> <span class="cmd"><p>R1(config)#<b>router ospf 1</b></p></span> <span class="cmd"><p>R1(config-router)#</p></span></content-text>
</page>
</topic>
<topic type="" id="tl0911020300">
<title><content-text>Commande network</content-text></title>
<page type="OneColumn" id="tl0911020301">
<content-media type="InteractiveGraphicHotspots" id="cm9291193915"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020300/tl0911020301/cm9291193915.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020300/tl0911020301/cm9291193915text.xml"/></content-media>
<content-text><p>La commande <span class="cmd"><b>network</b></span> utilisée avec le protocole OSPF a la même fonction que lorsqu’elle est utilisée avec les autres protocoles de routage IGP : </p> <p><ul><li> Toute interface de routeur qui correspond à l’adresse réseau dans la commande <span class="cmd"><b>network</b></span> est activée pour envoyer et recevoir des paquets OSPF.</li><li> Ce réseau (ou sous-réseau) sera inclus dans les mises à jour de routage OSPF.</li></ul></p> <p>La commande <span class="cmd"><b>network</b></span> est utilisée dans le mode de configuration du routeur.</p> <p><span class="cmd">Router(config-router)<b>#network </b><i>adresse réseau masque générique</i><b> area </b><i>area-id</i></span></p> <p>La commande OSPF <span class="cmd"><b>network</b></span> utilise une combinaison d’<i>adresse réseau</i> et de <i>masque générique</i> similaire à celle utilisée par le protocole EIGRP. Contrairement à EIGRP, toutefois, OSPF requiert un masque générique. L’adresse réseau et le masque générique servent à spécifier l’interface ou la plage d’interfaces qui seront activées pour OSPF à l’aide de la commande <span class="cmd"><b>network</b></span>. </p> <p>Comme avec EIGRP, le masque générique peut être configuré comme l’inverse d’un masque de sous-réseau. Par exemple, l’interface FastEthernet 0/0 de R1 se trouve sur le réseau 172.16.1.16/28. Le masque de sous-réseau pour l’interface est /28 ou 255.255.255.240. L’inversion du masque de sous-réseau donne un masque générique.</p> <p><b>Remarque :</b> comme EIGRP, certaines versions d’IOS vous permettent d’entrer simplement un masque de sous-réseau au lieu du masque générique. L’IOS convertit ensuite le masque de sous-réseau au format de masque générique.</p> <p><span class="cmd"> 255.255.255.255</span> </p> <p><span class="cmd">- 255 255 255 240 Soustrayez le masque de sous-réseau</span></p> <p><span class="cmd"> --------------------</span></p> <p><span class="cmd"> 0. 0. 0. 15 Masque générique</span></p> <p><span class="cmd"><b>area </b><i>area-id</i></span> fait référence à la <content-link target="cg9789079661" type="glossary">zone OSPF</content-link>. Une zone OSPF est un groupe de routeurs qui partagent les informations d’état de liens. Tous les routeurs OSPF de la même zone doivent avoir les mêmes informations dans leur base de données à état de liens, ce qui est possible parce que tous les routeurs diffusent leur état de liens individuel à tous les autres routeurs de la zone. Dans ce chapitre, nous configurerons tous les routeurs OSPF d’une zone unique, et obtiendrons ainsi un protocole OSPF à zone unique. </p> <p>Un réseau OSPF peut aussi être configuré sous forme de plusieurs zones, ce qui présente plusieurs avantages, notamment des bases de données à état de liens plus petites et la limitation des problèmes d’instabilité réseau à une seule zone. Le protocole OSPF à zones multiples est traité dans le cours CCNP.</p> <p>Lorsque tous les routeurs se trouvent dans la même zone OSPF, les commandes réseau doivent être configurées avec le même paramètre <span class="cmd"><i>area-id</i></span> sur tous les routeurs. Bien qu’il soit possible d’utiliser n’importe quel paramètre <span class="cmd"><i>area-id</i></span>, le fait d’utiliser 0 dans un protocole OSPF à zone unique constitue une pratique saine. Cette convention simplifie les choses lorsque le réseau est configuré par la suite sous forme de plusieurs zones OSPF, la zone 0 devenant ainsi zone backbone.</p> <p>Le schéma montre les commandes <span class="cmd"><b>network</b></span> pour les trois routeurs, activant OSPF sur toutes les interfaces. À ce niveau, tous les routeurs doivent être en mesure de lancer une commande ping sur tous les réseaux.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911020400">
<title><content-text>ID de routeur OSPF</content-text></title>
<page type="OneColumn" id="tl0911020401">
<content-media type="InteractiveGraphicHotspots" id="cm6009600019"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020400/tl0911020401/cm6009600019.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020400/tl0911020401/cm6009600019text.xml"/></content-media>
<content-text><p><b>Détermination de l’ID de routeur</b></p> <p>L’ID de routeur OSPF permet d’identifier chaque routeur de façon unique dans le domaine de routage OSPF. Un ID de routeur est tout simplement une adresse IP. Les routeurs Cisco définissent leur ID de routeur en utilisant trois critères, selon la priorité ci-dessous :</p> <p>1. Utilisation de l’adresse IP configurée avec la commande <span class="cmd"><b>router-id</b></span> du protocole OSPF.</p> <p>2. Si <span class="cmd"><b>router-id</b></span> n’est pas configuré, le routeur choisit l’adresse IP la plus élevée parmi ses interfaces de bouclage IP.</p> <p>3. Si aucune interface de bouclage n’est configurée, le routeur choisit l’adresse IP active la plus élevée parmi ses interfaces physiques.</p> <p><b>Adresse IP active la plus élevée</b></p> <p>Si un routeur OSPF n’est pas configuré à l’aide d’une commande <span class="cmd"><b>router-id</b></span> OSPF et qu’aucune interface de bouclage n’est configurée, l’ID de routeur OSPF correspondra à l’adresse IP d’interface active la plus élevée. L’interface n’a pas à être configurée pour OSPF, ce qui signifie qu’elle n’a pas à être incluse à l’une des commandes <span class="cmd"><b>network</b></span>. Cependant l’interface doit être activée (elle doit être à l’état <b>up</b>).</p> <p><b>Cliquez sur le bouton Topologie dans le schéma. </b></p> <p>En utilisant les critères décrits ci-dessus, pouvez-vous déterminer les ID des routeurs R1, R2 et R3 ? La réponse se trouve sur la page suivante.</p></content-text>
</page>
<page type="OneColumn" id="tl0911020402">
<content-media type="InteractiveGraphicHotspots" id="cm3033580061"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020400/tl0911020402/cm3033580061.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020400/tl0911020402/cm3033580061text.xml"/></content-media>
<content-text><p><b>Vérification de l’ID de routeur</b></p> <p>Comme nous n’avons pas configuré d’ID de routeur ou d’interface de bouclage sur nos trois routeurs, l’ID de chacun des routeurs est déterminé par le critère numéro 3 de la liste : l’adresse IP active la plus élevée des interfaces physiques du routeur. Comme indiqué dans le schéma, l’ID de routeur de chacun des routeurs est :</p> <p><b>R1 :</b> 192.168.10.5, supérieur à 172.16.1.17 ou 192.168.10.1</p> <p><b>R2 :</b> 192.168.10.9, supérieur à 10.10.10.1 ou 192.168.10.2</p> <p><b>R3 :</b> 192.168.10.10, supérieur à 172.16.1.33 ou 192.168.10.6</p> <p>Pour vérifier l’ID de routeur en cours, vous pouvez utiliser la commande <span class="cmd"><b>show ip protocols</b></span>. Certaines versions d’IOS n’affichent pas l’ID de routeur comme indiqué sur le schéma. Dans ce cas, utilisez la commande <span class="cmd"><b>show ip ospf</b></span> ou la commande <span class="cmd"><b>show ip ospf interface</b></span> pour vérifier l’ID de routeur.</p></content-text>
</page>
<page type="OneColumn" id="tl0911020403">
<content-media type="InteractiveGraphicHotspots" id="cm3731522329"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020400/tl0911020403/cm3731522329.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020400/tl0911020403/cm3731522329text.xml"/></content-media>
<content-text><p><b>Adresse de bouclage</b></p> <p>Si la commande <span class="cmd"><b>router-id</b></span> OSPF n’est pas utilisée et que vous avez configuré des interfaces de bouclage, OSPF choisit l’adresse IP d’interface de bouclage la plus élevée. Une adresse de bouclage est une interface virtuelle et est automatiquement à l’état <b>up</b> lorsqu’elle est configurée. Vous connaissez déjà les commandes pour configurer une interface de bouclage :</p> <span class="cmd"><p>Router(config)#<b>interface </b><i>loopback number</i></p></span> <span class="cmd"><p>Router(config-if)#<b>ip address </b><i>adresse IP masque de sous-réseau</i></p></span> <p><b>Cliquez sur le bouton Topologie dans le schéma.</b></p> <p>Dans cette topologie, les trois routeurs ont été configurés avec des adresses de bouclage afin de représenter les ID de routeur OSPF. L’avantage d’une interface de bouclage est que, contrairement aux interfaces physiques, elle ne peut pas tomber en panne. Pour être à l’état <b>up</b>, l’interface de bouclage ne dépend pas de câbles réels ou d’un périphérique contigu. Son utilisation pour déterminer l’ID de routeur offre au processus OSPF de la stabilité. La commande OSPF <span class="cmd"><b>router-id</b></span>, présentée ci-dessous, étant une nouveauté dans IOS, il est plus courant d’utiliser des adresses de bouclage pour la configuration des ID de routeur OSPF.</p> <p><b>Commande </b><span class="cmd"><b>router-id</b></span><b> OSPF</b></p> <p>La commande <span class="cmd"><b>router-id</b></span> du protocole OSPF a été ajoutée à IOS dans la version 12.0(T) ; elle remplace les adresses de bouclage et les adresses IP d’interface physique pour la détermination des ID de routeur. La syntaxe de commande est la suivante :</p> <span class="cmd"><p>Router(config)#<b>router ospf </b><i>process-id</i></p></span> <span class="cmd"><p>Router(config-router)#<b>router-id </b><i>ip-address</i></p></span>  <p><b>Modification de l’ID de routeur</b></p> <p>L’ID de routeur est sélectionné lors de la configuration du protocole OSPF avec la première commande OSPF <span class="cmd"><b>network</b></span>. Si la commande OSPF <span class="cmd"><b>router-id</b></span> ou l’adresse de bouclage est configurée <i>après</i> la commande OSPF <span class="cmd"><b>network</b></span>, l’ID de routeur est dérivé de l’interface dotée de l’adresse IP active la plus élevée.</p> <p>L’ID de routeur peut être modifié en définissant une autre adresse IP au moyen de la commande <span class="cmd"><b>router-id</b></span> OSPF ; il suffit ensuite de recharger le routeur ou d’utiliser la commande suivante :</p> <p><span class="cmd">Router#<b>clear ip ospf process</b></span></p> <p><b>Remarque :</b> la modification d’un ID de routeur avec une nouvelle adresse de bouclage ou une adresse d’interface physique IP peut nécessiter le rechargement du routeur.</p> <p><b>ID de routeur double</b></p> <p>Lorsque deux routeurs portent le même ID dans un domaine OSPF, le routage risque de ne pas fonctionner correctement. Si l’ID de routeur est le même sur deux routeurs de voisinage, la reconnaissance du voisin peut ne pas fonctionner. Lorsque des doublons sont détectés au niveau des ID de routeur OSPF, IOS affiche un message de type :</p> <p><span class="cmd">%OSPF-4-DUP_RTRID1: Detected router with duplicate router ID</span></p> <p>Pour corriger ce problème, configurez tous les routeurs de manière à ce qu’ils aient un ID OSPF unique.</p> <p><b>Cliquez sur Nouveaux ID de routeurs dans le schéma.</b></p> <p>Certaines versions d’IOS ne prenant pas en charge la commande <span class="cmd"><b>router-id</b></span>, nous utiliserons l’adresse de bouclage pour la définition des ID de routeur. En général, l’adresse IP d’une interface de bouclage remplace un ID de routeur OSPF simplement en rechargeant le routeur. Dans le schéma, les routeurs ont été rechargés. La commande <span class="cmd"><b>show ip protocols</b></span> permet de vérifier que chaque routeur utilise bien l’adresse de bouclage comme ID de routeur.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911020500">
<title><content-text>Vérification d’OSPF</content-text></title>
<page type="OneColumn" id="tl0911020501">
<content-media type="InteractiveGraphicHotspots" id="cm3794948834"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020500/tl0911020501/cm3794948834.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020500/tl0911020501/cm3794948834text.xml"/></content-media>
<content-text><p>La commande <span class="cmd"><b>show ip ospf neighbor</b></span> peut être utilisée pour vérifier et réparer les relations de voisinage OSPF. Pour chaque voisin, cette commande affiche les éléments suivants :</p> <p><ul><li> <span class="cmd"><b>Neighbor ID</b></span> : ID du routeur voisin.</li><li> <span class="cmd"><b>Pri</b></span> : priorité OSPF de l’interface. Ce sujet est traité dans une section ultérieure.</li><li> <span class="cmd"><b>State</b></span> : état OSPF de l’interface. <span class="cmd">L’état <b>FULL</b></span> signifie que le routeur et son voisin ont des bases de données à état de liens OSPF identiques. Les états OSPF sont traités dans le cours CCNP.</li><li> <span class="cmd"><b>Dead Time</b></span> : durée de temps pendant laquelle le routeur attendra un paquet Hello OSPF du voisin avant de déclarer le voisin hors service. Cette valeur est réinitialisée lorsque l’interface reçoit un paquet Hello.</li><li> <span class="cmd"><b>Address</b></span> : adresse IP de l’interface du voisin à laquelle ce routeur est connecté directement.</li><li> <span class="cmd"><b>Interface</b></span> : interface sur laquelle ce routeur a établi une contiguïté avec son voisin.</li></ul></p> <p>Lors du dépannage des réseaux OSPF, la commande <span class="cmd"><b>show ip ospf neighbor</b></span> peut être utilisée pour vérifier qu’une contiguïté est bien établie entre un routeur et ses routeurs voisins. Si l’ID de routeur du routeur voisin ne s’affiche pas, ou qu’il n’affiche pas l’état <b>FULL</b>, les deux routeurs n’ont pas établi de contiguïté OSPF. Lorsque deux routeurs n’établissent pas de contiguïté, les informations d’état de liens ne sont pas échangées. Les bases de données à état de liens incomplètes peuvent entraîner des arborescences SPF et des tables de routage imprécises. Les routes vers les réseaux de destination peuvent soit ne pas exister, soit ne pas être les meilleurs chemins.</p> <p><b>Remarque :</b> sur les réseaux à accès multiple tels que l’Ethernet, deux routeurs contigus peuvent avoir pour état affiché 2WAY. Ce sujet sera abordé dans une section ultérieure.</p> <p>Deux routeurs ne peuvent pas établir une contiguïté OSPF si :</p> <p><ul><li> les masques de sous-réseau ne correspondent pas, plaçant ainsi les routeurs sur des réseaux séparés ;</li><li></li><li> les compteurs OSPF Hello ou les compteurs d’arrêt ne correspondent pas ;</li><li></li><li> les types de réseau OSPF ne correspondent pas ;</li><li></li><li> la commande OSPF <span class="cmd"><b>network</b></span> est manquante ou incorrecte.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl0911020502">
<content-media type="InteractiveGraphicHotspots" id="cm8892863889"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020500/tl0911020502/cm8892863889.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020500/tl0911020502/cm8892863889text.xml"/></content-media>
<content-text><p>Les autres commandes de dépannage OSPF intéressantes incluent :</p> <span class="cmd"><p><b>show ip protocols</b></p></span> <span class="cmd"><p><b>show ip ospf</b></p></span> <span class="cmd"><p><b>show ip ospf interface</b></p></span> <p>Comme indiqué dans le schéma, la commande <span class="cmd"><b>show ip protocols</b></span> offre un moyen rapide de vérifier des données de configuration OSPF cruciales, notamment l’ID de processus OSPF, l’ID de routeur, les réseaux que le routeur annonce, les voisins desquels le routeur reçoit des mises à jour et la distance administrative par défaut, à savoir 110 pour le protocole OSPF.</p> <p><b>Cliquez sur </b><span class="cmd"><b>show ip ospf </b></span><b> dans le schéma.</b></p> <p>La commande <span class="cmd"><b>show ip ospf</b></span> peut également être utilisée pour examiner l’ID de routeur et l’ID de processus OSPF. En outre, cette commande affiche les informations de zone OSPF, ainsi que la dernière fois où l’algorithme SPF a été calculé. Comme vous pouvez le voir dans la sortie d’exemple, OSPF est un protocole de routage extrêmement stable. Le seul événement relatif à OSPF auquel R1 a pris part au cours des dernières 11 H 30 est l’envoi de petits paquets Hello réguliers à ses voisins. </p> <p><b>Remarque : </b>les autres informations affichées par la commande <span class="cmd"><b>show ip ospf</b></span> sont indiquées dans les cours de formation CCNP.</p> <p>La commande affiche des informations importantes relatives à l’algorithme SPF, notamment le <content-link target="cg1735291339" type="glossary">SPF schedule delay</content-link> : </p> <span class="cmd"><p>Initial SPF schedule delay 5000 msecs</p></span> <span class="cmd"><p>Minimum hold time between two consecutive SPFs 10000 msecs</p></span> <span class="cmd"><p>Maximum wait time between two consecutive SPFs 10000 msecs</p></span> <p>Lorsqu’un routeur reçoit de nouvelles informations de topologie (ajout, suppression ou modification d’un lien), il doit exécuter de nouveau l’algorithme SPF, créer une nouvelle arborescence SPF et mettre à jour la table de routage. L’algorithme SPF est exigeant en temps processeur et le temps qu’il prend pour le calcul dépend de la taille de la zone. Cette dernière est déterminée par le nombre de ses routeurs et la taille de la base de données à état de liens. </p> <p>On parle de <content-link target="cg4689628855" type="glossary">lien instable</content-link> lorsque l’état d’un réseau ne cesse de passer de <b>up</b> (fonctionnement normal) à <b>down</b> (problème). Un lien instable peut faire en sorte que les routeurs OSPF réexécute sans cesse l’algorithme SPF, et empêcher ainsi une convergence correcte. Pour atténuer ce problème, le routeur attend 5 secondes (5 000 millisecondes) après réception d’une LSU avant d’exécuter l’algorithme SPF. Cela s’appelle le SPF schedule delay (délai d’attente programmé de SPF). Pour éviter qu’un routeur réexécute sans cesse l’algorithme SPF, il existe un temps d’attente supplémentaire de 10 secondes (10 000 millisecondes). Le routeur attend 10 secondes après l’exécution de l’algorithme SPF avant de le réexécuter. </p> <p><b>Cliquez sur </b><span class="cmd"><b>show ip ospf interface </b></span><b>dans le schéma.</b></p> <p>La méthode la plus rapide pour vérifier les intervalles Hello et Dead consiste à utiliser la commande <span class="cmd"><b>show ip ospf interface</b></span>. Comme indiqué dans le schéma, l’ajout du nom et du numéro de l’interface à la commande permet d’afficher en sortie une interface spécifique. Ces intervalles sont inclus dans les paquets Hello OSPF qui s’échangent entre voisins. OSPF peut avoir des intervalles Hello et Dead différents au niveau des interfaces, cependant, pour que les routeurs OSPF deviennent voisins, leurs intervalles Hello et Dead OSPF doivent être identiques. Par exemple, dans le schéma, R1 utilise un intervalle Hello de 10 et un intervalle Dead de 40 sur l’interface série 0/0/0. R2 doit également utiliser ces intervalles sur son interface série 0/0/0. Autrement, les deux routeurs ne formeront pas une contiguïté. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911020600">
<title><content-text>Examen de la table de routage</content-text></title>
<page type="OneColumn" id="tl0911020601">
<content-media type="InteractiveGraphicHotspots" id="cm5981616568"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020600/tl0911020601/cm5981616568.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911020000/tl0911020600/tl0911020601/cm5981616568text.xml"/></content-media>
<content-text><p>Comme vous le savez, le moyen le plus rapide de vérifier la convergence OSPF est de regarder la table de routage de chacun des routeurs de la topologie. </p> <p><b>Dans le schéma, cliquez sur R1, R2 et R3 pour voir la sortie de </b><span class="cmd"><b>show ip route</b></span><b>.</b></p> <p>La commande <span class="cmd"><b>show ip route</b></span> peut être utilisée pour vérifier qu’OSPF envoie et reçoit bien des routes via OSPF. Le <b>O</b> figurant au début de chaque route indique que la route source est OSPF. La table de routage et OSPF seront examinés de plus près dans la section qui suit. Cependant, vous devez immédiatement noter que la table de routage du protocole OSPF présente deux différences par rapport à celles que vous avez vues dans les chapitres précédents. D’abord, chaque routeur comprend quatre réseaux connectés directement car l’interface de bouclage est considérée comme un quatrième réseau. Ces interfaces de bouclage ne sont pas annoncées dans OSPF. Cependant, chaque routeur répertorie sept réseaux connus. Ensuite, contrairement à RIPv2 et EIGRP, OSPF ne résume pas automatiquement les réseaux au niveau des frontières de réseau principales. OSPF est un protocole sans classe à part entière.</p></content-text>
</page>
<page type="OneColumn" id="tl0911020602">
<content-media type="ActivityPKA" id="cm6077246877"><title><content-text></content-text></title><media ref="tl0911000000/tl0911020000/tl0911020600/tl0911020602/cm6077246877/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911020000/tl0911020600/tl0911020602/cm6077246877/icontext.xml"/></content-media>
<content-text><p>Utilisez l’exercice Packet Tracer pour configurer et contrôler le routage OSPF de base.</p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911030000">
<title><content-text>Métrique OSPF</content-text></title>
<topic type="" id="tl0911030100">
<title><content-text>Métrique OSPF</content-text></title>
<page type="OneColumn" id="tl0911030101">
<content-media type="StaticGraphic" id="cm5361713613"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030100/tl0911030101/cm5361713613.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030100/tl0911030101/cm5361713613text.xml"/></content-media>
<content-text><p>La métrique OSPF s’appelle le coût. Citation du document RFC 2328 : <i>« Un coût est associé au niveau de la sortie de chaque interface de routeur. Ce coût est configurable par un administrateur système. Plus le coût est faible, plus l’interface sera utilisée pour acheminer le trafic de données. »</i> </p> <p>Notez que le document RFC 2328 n’indique pas les valeurs à utiliser pour déterminer le coût.</p> <p><b>Pour calculer un coût, l’IOS de Cisco cumule les bandes passantes des interfaces de sortie depuis le routeur vers le réseau de destination.</b> À chaque routeur, le coût d’une interface est déterminé par le calcul de 10 à la puissance 8 divisé par la bande passante en bits/s. Le résultat est appelé <i>bande passante de référence</i>. On divise 10 à la puissance 8 par la bande passante de l’interface pour que les interfaces dont les valeurs de bande passante sont les plus hautes obtiennent un coût inférieur, après calcul. Souvenez-vous que, dans les métriques de routage, la route ayant le coût le moins élevé est la route préférée (par exemple, dans le protocole RIP, 3 sauts valent mieux que 10). Le schéma montre les coûts OSPF par défaut de plusieurs types d’interfaces. </p> <p><b>Bande passante de référence</b></p> <p>Par défaut, la bande passante est de 10 à la puissance 8, soit 100 000 000 bits/s ou 100 Mbits/s. Résultat : des interfaces ayant une bande passante de 100 Mb/s et plus ont un même coût OSPF de 1. La bande passante de référence peut être modifiée pour s’adapter aux réseaux ayant des liaisons d’une rapidité supérieure à 100 000 000 bits/s (100 Mbits/s) à l’aide de la commande OSPF <span class="cmd"><b>auto-cost reference-bandwidth</b></span>. Lorsque l’exécution de cette commande est nécessaire, il est conseillé de l’utiliser sur tous les routeurs, afin que la métrique de routage OSPF reste cohérente.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030102">
<content-media type="StaticGraphic" id="cm9928226376"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030100/tl0911030102/cm9928226376.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030100/tl0911030102/cm9928226376text.xml"/></content-media>
<content-text><p><b>OSPF cumule les coûts</b></p> <p>Le coût d’une route OSPF est la valeur cumulée depuis un routeur jusqu’au réseau de destination. Par exemple, dans le schéma, la table de routage de R1 affiche un coût de 65 pour atteindre le réseau 10.10.10.0/24 sur R2. 10.10.10.0/24 étant rattaché à une interface FastEthernet, R2 affecte la valeur 1 comme coût pour 10.10.10.0/24. R1 ajoute ensuite la valeur de coût supplémentaire de 64 correspondant à l’envoi des données via la liaison T1 par défaut entre R1 et R2.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030103">
<content-media type="InteractiveGraphicHotspots" id="cm7063397266"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030100/tl0911030103/cm7063397266.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030100/tl0911030103/cm7063397266text.xml"/></content-media>
<content-text><p><b>Bande passante par défaut sur les interfaces série</b></p> <p>Vous vous souvenez peut-être que dans le chapitre 9, « Protocole EIGRP », nous avons vu que vous pouvez utiliser la commande <span class="cmd"><b>show interface</b></span> pour afficher la valeur de bande passante utilisée pour une interface. Sur les routeurs Cisco, de nombreuses interfaces série ont pour valeur de bande passante par défaut T1 (1 544 Mbits/s). Cependant, certaines interfaces ont comme valeur par défaut 128 Kbits/s. Ne supposez donc pas qu’OSPF utilise une valeur de bande passante particulière. Commencez toujours par vérifier la valeur par défaut à l’aide de la commande <span class="cmd"><b>show interface</b></span>.</p> <p>N’oubliez pas que cette valeur de bande passante n’influe pas réellement sur la vitesse de la liaison ; elle est utilisée par certains protocoles de routage pour calculer la métrique de routage. Le plus souvent, sur les interfaces série, la vitesse réelle de la liaison est différente de celle de la bande passante par défaut. Il est important que la valeur de bande passante reflète la vitesse réelle de la liaison, afin que la table de routage contienne des informations de chemin précises. Par exemple, vous pouvez ne payer qu’une fraction de connexion T1 à votre fournisseur d’accès, soit le quart d’une connexion T1 totale (384 Kbits/s). Cependant, pour le protocole de routage, l’IOS considère qu’il s’agit d’une valeur de bande passante de connexion T1, même lorsque l’interface n’envoie et ne reçoit en réalité que le quart d’une connexion T1 complète (384 Kbits/s).</p> <p>Le schéma montre la sortie de l’interface série Serial 0/0/0 sur R1. La topologie reflète maintenant la bande passante réelle de la liaison entre les routeurs. Notez que la valeur de bande passante par défaut de la sortie de commande de R1 est de 1 544 Kbits/s. Pourtant, la bande passante réelle de cette liaison est de 64 Kbits/s. Cela signifie que le routeur a des informations de routage qui ne reflètent pas de façon précise la topologie du réseau. </p> <p><b>Cliquez sur </b><span class="cmd"><b>show ip route</b> </span><b>dans le schéma.</b></p><p>La figure affiche la table de routage pour R1. R1 pense que ses deux interfaces série sont connectées à des liaisons T1, bien qu’une de ses liaisons soit de 64 Kbits/s et l’autre, de 256 Kbits/s. La table de routage de R1 mentionne donc deux chemins de coût égal vers le réseau 192.168.10.8/30, alors que le meilleur chemin est le Serial 0/0/1. </p> <span class="cmd"><p>O 192.168.10.8 [110/<span class="blue">128</span>] via 192.168.10.6, 00:03:41, Serial0/0/1</p></span> <span class="cmd"><p> [110/<span class="blue">128</span>] via 192.168.10.2, 00:03:41, Serial0/0/0</p></span> <p><b>Cliquez sur </b><span class="cmd"><b>show ip ospf interface </b></span><b>dans le schéma.</b></p> <p>Le coût OSPF calculé d’une interface peut être vérifié à l’aide de la commande <span class="cmd"><b>show ip ospf interface</b></span>. Dans le schéma, nous pouvons vérifier que R1 affecte effectivement un coût de 64 à l’interface série 0/0/0. Bien que vous puissiez penser qu’il s’agit du coût correct, cette interface étant rattachée à une liaison de 64 Kbits/s, souvenez-vous que ce coût est obtenu avec la formule de coût. Le coût d’une liaison 64 Kbits/s est de 1562 (100 000 000/64 000). La valeur de 64 qui s’affiche correspond au coût d’une liaison T1. Dans la rubrique suivante, vous apprendrez comment modifier le coût de toutes les liaisons de la topologie. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911030200">
<title><content-text>Modification du coût de la liaison</content-text></title>
<page type="OneColumn" id="tl0911030201">
<content-media type="InteractiveGraphicHotspots" id="cm8589941861"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030201/cm8589941861.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030200/tl0911030201/cm8589941861text.xml"/></content-media>
<content-text><p>Lorsque l’interface série ne fonctionne pas réellement à la vitesse par défaut d’une connexion T1, l’interface a besoin d’une modification manuelle. Les deux côtés de la liaison doivent être configurés pour avoir la même valeur. Les commandes d’interface <span class="cmd"><b>bandwidth</b></span> ou <span class="cmd"><b>ip ospf cost</b></span> permettent d’atteindre cet objectif : une valeur précise que le protocole OSPF utilise pour déterminer la meilleure route.</p> <p><b>Commande </b><span class="cmd"><b>bandwidth</b></span></p> <p>La commande <span class="cmd"><b>bandwidth</b></span> est utilisée pour modifier la valeur de la bande passante utilisée par l’IOS dans le calcul de la métrique de coût OSPF. La syntaxe de la commande d’interface est la même que celle indiquée dans le chapitre 9, pour le protocole EIGRP :</p> <p><span class="cmd">Router(config-if)#<b>bandwidth </b><i>bandwidth-kbps</i></span></p> <p>La figure indique les commandes <span class="cmd"><b>bandwidth</b></span> utilisées pour modifier le coût de toutes les interfaces série de la topologie. Pour R1, la commande <span class="cmd"><b>show ip ospf interface</b></span> montre que le coût de la liaison série 0/0/0 est maintenant de 1562, résultat du calcul de coût OSPF Cisco 100 000 000/64 000. </p></content-text>
</page>
<page type="OneColumn" id="tl0911030202">
<content-media type="InteractiveGraphicHotspots" id="cm3580546285"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030202/cm3580546285.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030200/tl0911030202/cm3580546285text.xml"/></content-media>
<content-text><p><b>Commande </b><span class="cmd"><b>ip ospf cost</b></span></p> <p>Outre la commande <span class="cmd"><b>bandwidth</b></span>, vous pouvez utiliser la commande <span class="cmd"><b>ip ospf cost</b></span> qui permet de configurer directement le coût d’une interface. Par exemple, sur R1, nous pourrions configurer Serial 0/0/0 avec la commande suivante :</p> <span class="cmd"><p>R1(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>ip ospf cost 1562</b></p></span> <p>Bien entendu, cela ne changerait rien au résultat de la commande <span class="cmd"><b>show ip ospf interface</b></span>, qui afficherait tout de même « 1562 » comme coût. Il s’agit du même coût calculé par l’IOS lorsque nous avions configuré la bande passante sur 64.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030203">
<content-media type="StaticGraphic" id="cm7313756366"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030203/cm7313756366.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911030000/tl0911030200/tl0911030203/cm7313756366text.xml"/></content-media>
<content-text><p><b>Comparaison des commandes </b><span class="cmd"> <b>bandwidth</b></span><b> et </b><span class="cmd"><b>ip ospf cost</b></span></p> <p>La commande <span class="cmd"><b>ip ospf cost</b></span> est très utile dans les environnements avec plusieurs fournisseurs, lorsque des routeurs non-Cisco utilisent une métrique autre que la bande passante pour calculer les coûts OSPF. La principale différence entre les deux commandes est que la commande <span class="cmd"><b>bandwidth</b></span> utilise le résultat du calcul de coût pour déterminer le coût de la liaison. La commande <span class="cmd"><b>ip ospf cost</b></span> ne tient pas compte de ce calcul et attribue directement une valeur de coût spécifique à la liaison.</p> <p>Le schéma montre les deux possibilités de modification de coût des liaisons série de la topologie. Sur le côté droit du schéma figure la commande <span class="cmd"><b>ip ospf cost</b></span> équivalente aux commandes <span class="cmd"><b>bandwidth</b></span> sur la gauche.</p></content-text>
</page>
<page type="OneColumn" id="tl0911030204">
<content-media type="ActivityPKA" id="cm9333594841"><title><content-text></content-text></title><media ref="tl0911000000/tl0911030000/tl0911030200/tl0911030204/cm9333594841/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911030000/tl0911030200/tl0911030204/cm9333594841/icontext.xml"/></content-media>
<content-text><p>Utilisez l’exercice Packet Tracer pour modifier les valeurs de coût pour OSPF.</p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911040000">
<title><content-text>OSPF et les réseaux à accès multiple</content-text></title>
<topic type="" id="tl0911040100">
<title><content-text>Confirmations sur les réseaux à accès multiple</content-text></title>
<page type="OneColumn" id="tl0911040101">
<content-media type="StaticGraphic" id="cm2892312364"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040101/cm2892312364.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040101/cm2892312364text.xml"/></content-media>
<content-text><p>Un <content-link target="cg1420035058" type="glossary">réseau à accès multiple</content-link> est un réseau comportant plus de deux périphériques sur le même support partagé. Dans la partie supérieure du schéma, le réseau local Ethernet rattaché à R1 est étendu afin de montrer les différents périphériques qui peuvent être attachés au réseau 172.16.1.16/28. Les réseaux locaux Ethernet constituent un exemple de réseau à accès multiple de diffusion. Ce sont des réseaux de diffusion car tous les périphériques du réseau peuvent voir toutes les trames de diffusion. Ce sont également des réseaux à accès multiple, car de nombreux hôtes, imprimantes, routeurs et autres périphériques peuvent être membres du même réseau. </p> <p>Sur les réseaux point à point, en revanche, le réseau ne comporte que deux périphériques, un à chaque extrémité. La liaison de réseau étendu entre R1 et R3 est un exemple de liaison point à point. La partie inférieure du schéma montre la liaison point à point entre R1 et R3.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040102">
<content-media type="AnimationPartialScreen" id="cm1180392974"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040102/cm1180392974.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040102/cm1180392974text.xml"/></content-media>
<content-text><p>Le protocole OSPF définit cinq types de réseau :</p> <p><ul><li> Point à point</li><li> Accès multiple avec diffusion</li><li> Accès NBMA</li><li> Point à multipoint</li><li> Liaisons virtuelles</li></ul></p> <p>Les réseaux NBMA et point à multipoint incluent les réseaux Frame Relay, ATM et X.25. Les réseaux NBMA sont traités dans un autre cours CCNA. Les réseaux point à multipoint sont traités dans le cours CCNP. Les liaisons virtuelles sont des liaisons de type spécial, qui peuvent être utilisées dans les OSPF à zones multiples. Les liaisons virtuelles OSPF sont traitées dans le cours CCNP.</p> <p><b>Cliquez sur Lire pour lancer l’animation.</b></p> <p>Cette dernière montre que la topologie utilise à la fois des réseaux point à point et des réseaux de diffusion.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040103">
<content-media type="StaticGraphic" id="cm7281665597"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040103/cm7281665597.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040103/cm7281665597text.xml"/></content-media>
<content-text><p>Les LSA sur les réseaux à accès multiple peuvent présenter deux difficultés pour OSPF :</p> <p>1. La création de contiguïtés multiples, une pour chaque paire de routeurs.</p> <p>2. Une diffusion massive de LSA (Link-State Advertisements).</p> <p><b>Contiguïtés multiples</b></p> <p>La création d’une contiguïté entre chaque paire de routeurs dans un réseau créerait un nombre de contiguïtés inutile. Un nombre excessif de LSA circulerait entre les routeurs du même réseau. </p> <p>Pour mieux appréhender le problème des contiguïtés multiples, nous devons étudier une formule. Le nombre de routeurs, quel qu’il soit (désigné ici par <b>n</b>) d’un réseau à accès multiples donnera <b>n ( n - 1) / 2</b> contiguïtés. Dans le schéma, vous pouvez voir une topologie à cinq routeurs, tous rattachés au même réseau à accès multiple Ethernet. S’il n’existe aucun mécanisme permettant de réduire le nombre de contiguïtés, ces routeurs formeront, ensemble, 10 contiguïtés : <b>5 ( 5 - 1) / 2 = 10.</b> Cela peut sembler peu, mais au fur et à mesure que des routeurs sont ajoutés au réseau, le nombre de contiguïtés augmente de façon considérable. Les 5 routeurs présents sur le schéma nécessitent seulement 10 contiguïtés, mais 10 routeurs exigeront 45 contiguïtés. Pour vingt routeurs, vous auriez 190 contiguïtés !</p></content-text>
</page>
<page type="OneColumn" id="tl0911040104">
<content-media type="AnimationPartialScreen" id="cm9356542215"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040104/cm9356542215.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040104/cm9356542215text.xml"/></content-media>
<content-text><p><b>Diffusion des LSA</b></p> <p>Dans le chapitre 10, « Protocoles de routage à état de liens », nous avons vu que les routeurs à état de liens diffusent leurs paquets à état de liens lorsqu’OSPF est initialisé ou qu’une modification de topologie intervient.</p> <p><b>Cliquez sur Lire pour voir l’animation d’un scénario d’inondation de LSA.</b></p> <p>Dans le cadre d’un réseau à accès multiple, cette diffusion peut devenir excessive. Dans l’animation, R2 envoie une LSA. Cet événement déclenche chez tous les routeurs l’envoi d’une LSA. L’animation ne montre pas les reçus renvoyés pour chaque LSA reçue. Si chaque routeur d’un réseau à accès multiple devait envoyer une LSA, puis accuser réception de toutes les LSA qu’il a reçues pour tous les routeurs de ce réseau à accès multiple, le trafic réseau deviendrait chaotique.</p> <p>Pour illustrer ce propos, imaginez que vous vous trouvez dans une pièce avec un grand nombre de personnes. Que se passerait-il si chacun devait se présenter lui-même à tous les autres ? Non seulement chacune des personnes devrait dire son nom à tout le monde, mais, à chaque fois qu’elle apprendrait un nom, chaque personne devrait en informer les autres, individuellement. Comme vous pouvez le voir, cela entraînerait un chaos total !</p></content-text>
</page>
<page type="OneColumn" id="tl0911040105">
<content-media type="AnimationPartialScreen" id="cm5069815851"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040100/tl0911040105/cm5069815851.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040100/tl0911040105/cm5069815851text.xml"/></content-media>
<content-text><p><b>Il existe une solution : le routeur désigné (DR)</b></p> <p>La solution pour gérer le nombre de contiguïtés et la diffusion des LSA sur un réseau à accès multiple est le routeur désigné (DR). Pour poursuivre avec notre exemple, cette solution revient à choisir une personne dans la pièce pour circuler et apprendre le nom de chacune des personnes, et de les annoncer par la suite immédiatement à toutes les personnes présentes dans la salle.</p> <p>Dans les réseaux à accès multiple, OSPF sélectionne un routeur désigné (Designated Router - DR) comme point de collecte et de distribution des LSA envoyées et reçues. Un routeur désigné de sauvegarde (Backup Designated Router - BDR) est également choisi en cas de défaillance du routeur désigné. Tous les autres routeurs deviennent des DROthers (ce qui signifie qu’ils ne sont ni DR, ni BDR).</p> <p><b>Cliquez sur Lire pour voir l’animation du rôle de DR.</b></p> <p>Les routeurs d’un réseau à accès multiple choisissent un DR et un BDR. Les DROthers constituent des contiguïtés avec le DR et le BDR du réseau. Cela signifie qu’au lieu de diffuser les LSA à l’ensemble des routeurs du réseau, les DROthers envoient leurs LSA uniquement au DR et au BDR en utilisant l’adresse multidiffusion de 224.0.0.6 (ALLDRouters - tous les routeurs DR). Dans l’animation, R1 envoie des LSA au DR. Le BDR est lui aussi à l’écoute. Le DR est chargé de transmettre les LSA depuis R1 vers les autres routeurs. Il utilise l’adresse multidiffusion 224.0.0.5 (AllSPFRouters - tous les routeurs OSPF). Au final, un seul routeur assure la diffusion de l’ensemble des LSA dans le réseau à accès multiple. </p></content-text>
</page>
</topic>
<topic type="" id="tl0911040200">
<title><content-text>Processus de sélection de DR/BDR</content-text></title>
<page type="OneColumn" id="tl0911040201">
<content-media type="InteractiveGraphicHotspots" id="cm1650231404"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040200/tl0911040201/cm1650231404.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040200/tl0911040201/cm1650231404text.xml"/></content-media>
<content-text><p><b>Modification de topologie</b></p> <p>Les sélections de DR/BDR n’ont pas lieu dans les réseaux point à point. Donc, dans une topologie standard à trois routeurs, R1, R2 et R3, il n’y a pas à choisir de DR ou de BDR, car les liaisons existant entre ces routeurs ne sont pas des réseaux à accès multiple. </p> <p><b>Dans le schéma, cliquez sur Topologie à accès multiple.</b></p> <p>Pour le reste du sujet concernant le DR et le BDR, nous utiliserons la topologie à accès multiple figurant dans le schéma. Les noms des routeurs sont différents, simplement pour souligner le fait que cette topologie n’est pas la même que celle que nous avons utilisée jusqu’ici. Nous reviendrons à la topologie du chapitre après avoir traité le sujet du processus de sélection du routeur désigné et du routeur désigné de secours. Dans cette nouvelle topologie, nous avons trois routeurs qui partagent un réseau à accès multiple Ethernet, 192.168.1.0/24. Chacun des routeurs est configuré avec une adresse IP sur l’interface Fast Ethernet et une adresse de bouclage pour l’ID de routeur.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040202">
<content-media type="InteractiveGraphicHotspots" id="cm8301589015"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040200/tl0911040202/cm8301589015.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040200/tl0911040202/cm8301589015text.xml"/></content-media>
<content-text><p><b>Sélection du DR/BDR</b></p> <p>Comment le routeur désigné et le routeur désigné de sauvegarde sont-ils sélectionnés ? Les critères suivants sont appliqués :</p> <p>1. DR : Il s’agit du routeur dont la priorité d’interface OSPF est la plus élevée.</p> <p>2. BDR : Il s’agit du routeur dont la priorité d’interface OSPF est la seconde valeur la plus élevée. </p> <p>3. Si les priorités d’interface OSPF sont identiques, l’ID de routeur le plus élevé prévaut.</p> <p>Dans cet exemple, la priorité d’interface OSPF par défaut est 1. Résultat : selon les critères de sélection énoncés plus haut, c’est l’ID de routeur OSPF qui est utilisé pour sélectionner le DR et le BDR. Comme vous le voyez, RouterC devient DR et RouterB, qui a le second ID de routeur le plus élevé devient le BDR. RouterA, n’étant sélectionné ni comme DR, ni comme BDR, devient DROther.</p> <p>Un DROther ne constitue des contiguïtés <b>FULL</b> (complètes) qu’avec le DR et le BDR, mais continue de fournir des contiguïtés de voisinage avec tous les DROthers qui rejoignent le réseau. Cela signifie que tous les routeurs DROther du réseau à accès multiple continueront de recevoir des paquets Hello de tous les autres routeurs DROther. Ainsi, ils connaissent les autres routeurs du réseau. Lorsque deux routeurs DROther constituent une contiguïté de voisinage, l’état du voisin est <b>2WAY</b>. Les différents états de voisinage sont traités dans le cours CCNP.</p> <p><b>Cliquez sur </b><span class="cmd"><b>show ip ospf neighbor </b></span><b>dans le schéma.</b></p> <p>La sortie de commande du schéma affiche la contiguïté de voisinage de chaque routeur du réseau à accès multiple. Notez que, pour RouterA, il affiche que le DR est RouterC, qui porte l’ID de routeur 192.168.31.33 et que le BDR est RouterB, avec l’ID de routeur 192.168.31.22.</p> <p><b>Cliquez sur </b><span class="cmd"><b>show ip ospf interface </b></span><b>dans le schéma.</b></p> <p>RouterA affiche ses deux voisins comme étant le DR et le BDR, lui-même est un DROther. Vous pouvez le vérifier en utilisant la commande <span class="cmd"><b>show ip ospf interface fastethernet 0/0</b></span> sur le routeur RouterA, comme indiqué dans le schéma. Cette commande affichera les états DR, BDR ou DROTHER de ce routeur, ainsi que l’ID de routeur du DR et du BDR sur ce réseau à accès multiple.</p></content-text>
</page>
<page type="OneColumn" id="tl0911040203">
<content-media type="InteractiveGraphicHotspots" id="cm8996082338"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040200/tl0911040203/cm8996082338.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040200/tl0911040203/cm8996082338text.xml"/></content-media>
<content-text><p><b>Synchronisation de la sélection DR/BDR</b></p> <p>Le processus de sélection du DR et du BDR a lieu aussitôt que le premier routeur ayant une interface configurée OSPF est activé sur un réseau à accès multiple. Cet événement peut se produire lorsque les routeurs sont mis sous tension ou lorsqu’une commande <span class="cmd"><b>network</b></span> OSPF est configurée pour cette interface. Le processus de sélection ne prend que quelques secondes. Si l’amorçage de tous les routeurs du réseau à accès multiple n’est pas terminé, il se peut qu’un routeur dont l’ID n’est pas le plus élevé devienne le DR. Cela peut signifier que son amorçage a pris moins de temps. </p> <p>Une fois le DR sélectionné, il le reste jusqu’à ce que l’une des situations suivantes se produise :</p> <p><ul><li> le DR tombe en panne ;</li><li> le processus OSPF sur le DR échoue ;</li><li> l’interface à accès multiple du DR ne fonctionne plus.</li></ul></p> <p>Dans le schéma, une croix rouge (<b>X</b>) signale qu’un ou plusieurs de ces problèmes ont eu lieu.</p> <p><b>Dans le schéma, cliquez sur Panne DR.</b></p> <p>Si le DR ne fonctionne pas correctement, le routeur désigné de secours prend le relais et un nouveau routeur désigné de secours est choisi. Dans le schéma, RouterC s’arrête et le précédent BDR, RouterB, devient DR. Le seul autre routeur disponible pour devenir BDR est RouterA.</p> <p><b>Dans le schéma, cliquez sur Nouveau routeur.</b></p> <p>RouterD rejoint le réseau. Si un nouveau routeur entre dans le réseau une fois que le DR et le BDR ont été sélectionnés, il ne devient pas DR ou BDR, même si sa priorité d’interface OSPF ou son ID de routeur est plus élevé que ceux du DR ou du BDR courants. Il peut être sélectionné comme BDR si le DR ou le BDR en cours s’arrêtent. En cas de défaillance du DR actuel, le BDR devient DR, et le nouveau routeur est sélectionné comme nouveau BDR. Une fois que le nouveau routeur est devenu BDR, en cas de défaillance du DR, il devient DR à son tour. Avant que le nouveau routeur puisse être sélectionné comme DR et BDR, il faut que les DR et BDR courants soient tous les deux hors service. </p> <p><b>Dans le schéma, cliquez sur Retour ancien DR.</b></p> <p>Un ancien DR ne récupère pas le statut de DR s’il revient sur le réseau. Dans le schéma, RouterC a terminé un réamorçage, et devient DROther même si son ID de routeur, 192.168.31.33, est plus élevé que celui du DR et du BDR en cours.</p> <p><b>Dans le schéma, cliquez sur Panne BDR.</b></p> <p>Si le BDR s’arrête, une sélection s’opère parmi les DRothers pour voir lequel va devenir le nouveau BDR. Dans le schéma, le routeur BDR a une défaillance. Une sélection s’opère entre RouterC et RouterD. RouterD, ayant un ID de routeur plus élevé, est sélectionné.</p> <p><b>Dans le schéma, cliquez sur Panne nouveau DR.</b></p> <p>Dans le schéma, RouterB s’arrête. RouterD étant le BDR en cours, il devient DR. RouterC devient BDR.</p> <p>Comment pouvez-vous alors être sûr que ce sont les routeurs que vous avez choisis qui deviendront respectivement DR et BDR ? Si vous ne voulez pas procéder à une nouvelle configuration, procédez comme suit : </p> <p><ul><li> démarrez le DR en premier, puis le routeur désigné de secours, et démarrez ensuite tous les autres routeurs ;</li><li> ou arrêtez l’interface de tous les routeurs, exécutez une commande <span class="cmd"><b>no shutdown</b></span> sur le DR, puis sur le BDR, puis sur tous les autres routeurs.</li></ul></p> <p>Toutefois, comme vous l’avez peut-être déjà deviné, il est possible de changer la priorité d’interface OSPF afin de mieux contrôler le choix du routeur désigné/routeur désigné de secours.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911040300">
<title><content-text>Priorité d’interface OSPF</content-text></title>
<page type="OneColumn" id="tl0911040301">
<content-media type="InteractiveGraphicHotspots" id="cm9121787259"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040300/tl0911040301/cm9121787259.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911040000/tl0911040300/tl0911040301/cm9121787259text.xml"/></content-media>
<content-text><p>Le DR devenant le point central pour la collecte et la distribution des LSA, il est important qu’il dispose d’une puissance et d’une capacité mémoire suffisantes pour assumer cette responsabilité. Au lieu d’utiliser uniquement l’ID du routeur pour décider quels routeurs deviendront routeur désigné (DR) et routeur désigné de secours, il est préférable de contrôler le choix de ces routeurs à l’aide de la commande d’interface <span class="cmd"><b>ip ospf priority</b></span>.</p> <p><span class="cmd">Router(config-if)#<b>ip ospf priority</b> {<b>0 </b>- <b>255</b>}</span></p> <p>Lors de notre discussion précédente, la priorité OSPF était identique, et ce, parce que la valeur de priorité par défaut était de 1 pour toutes les interfaces de routeur. C’était donc l’ID de routeur qui déterminait le DR et le BDR. Mais si vous remplacez la valeur par défaut, 1, par une valeur plus élevée, le routeur dont la priorité est la plus élevée devient le DR, et celui qui a la seconde priorité devient le BDR. Lorsqu’elle est attribuée à un routeur, la valeur 0 empêche sa sélection en tant que DR ou BDR. </p> <p>Les priorités étant des valeurs d’interface spécifique, elles procurent un meilleur contrôle sur les réseaux à accès multiple OSPF. Elles permettent également de faire en sorte qu’un routeur soit DR dans un réseau et DROther dans un autre.</p> <p><b>Cliquez sur </b><span class="cmd"><b>show ip ospf interface </b></span><b>dans le schéma.</b></p> <p>Pour simplifier notre propos, nous avons retiré RouterD de la topologie. La priorité d’interface OSPF peut être affichée à l’aide de la commande <span class="cmd"><b>show ip ospf interface</b></span>. Dans le schéma, nous pouvons vérifier que la priorité du RouterA est définie sur 1, la valeur par défaut.</p> <p><b>Cliquez sur Modifier la priorité dans le schéma.</b></p> <p>La figure indique les priorités d’interface OSPF du RouterA et du RouterB, modifiées de manière à ce que le RouterA doté de la priorité la plus élevée devienne routeur désigné (DR) et le RouterB devienne routeur désigné de secours. La priorité d’interface OSPF de RouterC reste à la valeur par défaut 1.</p> <p><b>Dans le schéma, cliquez sur Forcer la sélection.</b></p> <p>Une fois que nous aurons exécuté des commandes <span class="cmd"><b>shutdown</b></span> et <span class="cmd"><b>no shutdown</b></span> sur les interfaces FastEthernet 0/0 des trois routeurs, nous verrons le résultat du changement des priorités d’interface OSPF. La commande <span class="cmd"><b>show ip ospf neighbor</b></span> du RouterC affiche à présent que le RouterA (ID de routeur 192.168.31.11) est DR, avec une priorité d’interface OSPF maximum de 200, et que le RouterB (ID de routeur 192.168.31.22) est toujours routeur désigné de sauvegarde, avec la priorité d’interface OSPF suivante de 100. Remarquez que la commande <span class="cmd"><b>show ip ospf neighbor</b></span> du RouterA n’indique aucun DR, car c’est le RouterA lui-même qui est DR de ce réseau. </p></content-text>
</page>
<page type="OneColumn" id="tl0911040302">
<content-media type="ActivityPKA" id="cm9468065065"><title><content-text></content-text></title><media ref="tl0911000000/tl0911040000/tl0911040300/tl0911040302/cm9468065065/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911040000/tl0911040300/tl0911040302/cm9468065065/icontext.xml"/></content-media>
<content-text><p>Réalisez l’exercice Packet Tracer pour étudier les rôles de routeur désigné et de routeur désigné de sauvegarde actuels et leur modification, puis forcer un changement de priorité pour les nouveaux rôles.</p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911050000">
<title><content-text>Configuration OSPF supplémentaire</content-text></title>
<topic type="" id="tl0911050100">
<title><content-text>Redistribution du routage OSPF par défaut</content-text></title>
<page type="OneColumn" id="tl0911050101">
<content-media type="InteractiveGraphicHotspots" id="cm6772299099"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050100/tl0911050101/cm6772299099.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911050000/tl0911050100/tl0911050101/cm6772299099text.xml"/></content-media>
<content-text><p><b>Topologie</b></p> <p>Revenons à la topologie précédente, qui comporte maintenant un nouveau lien vers FAI. Comme avec les protocoles RIP et EIGRP, le routeur connecté à Internet sert à diffuser une route par défaut aux autres routeurs du domaine de routage OSPF. Ce dernier porte parfois le nom de routeur d’entrée ou de routeur passerelle. Toutefois, dans la terminologie OSPF, le routeur situé entre un domaine de routage OSPF et un réseau non-OSPF est appelé <content-link target="cg8572378873" type="glossary">routeur ASBR</content-link> (Autonomous System Boundary Router, routeur de périphérie de système autonome). Dans cette topologie, la boucle1 (Lo1) représente une liaison vers un réseau non-OSPF. Nous ne configurerons pas le réseau 172.30.1.1/30 dans le cadre du processus de routage OSPF.</p> <p><b>Cliquez sur Configuration statique par défaut R1, dans le schéma.</b></p> <p>Le schéma indique le routeur ASBR (R1) configuré avec l’adresse IP Loopback1 et la route statique par défaut pour le transfert du trafic vers le routeur ISP :</p> <p><span class="cmd">R1(config)#<b>ip route 0.0.0.0 0.0.0.0 loopback 1</b></span></p> <p><b>Remarque :</b> la route statique par défaut utilise la boucle en tant qu’interface de sortie parce que le routeur ISP de la topologie n’existe pas physiquement. En utilisant une interface de bouclage, nous pouvons simuler une connexion vers un autre routeur.</p> <p>Comme RIP, OSPF nécessite la commande <span class="cmd"><b>default-information originate</b></span> pour annoncer la route statique par défaut 0.0.0.0/0 aux autres routeurs de la zone. Si la commande <span class="cmd"><b>default-information originate</b></span> n’est pas utilisée, la route par défaut « quatre zéros » ne sera pas diffusée aux autres routeurs de la zone OSPF. </p> <p>La syntaxe de commande est la suivante :</p> <p><span class="cmd">R1(config-router)#<b>default-information originate</b> </span></p> <p><b>Cliquez sur R1, R2 et R3 dans le schéma.</b></p> <p>R1, R2 et R3 sont à présent marqués de la mention « gateway of last resort » (passerelle de dernier recours), dans la table de routage. Notez la route par défaut de R2 et R3, avec la source de routage OSPF, qui porte un code supplémentaire, <span class="cmd"><b>E2</b></span>. Pour R2, la route est :</p> <p><span class="cmd">O*<span class="blue">E2</span> 0.0.0.0/0 [110/1] via 192.168.10.10, 00:05:34, Serial0/0/1</span></p> <p><b>E2</b> indique que cette route est une route OSPF externe de type 2. </p> <p>Les routes externes OSPF rentrent dans une des deux catégories qui suivent : Type externe 1 (E1) ou Type externe 2 (E2). La différence entre les deux est la façon dont leur coût OSPF respectif est calculé. OSPF cumule le coût d’une route E1 au moment où elle est diffusée à travers la zone OSPF. Ce processus est identique aux calculs de coût pour les routes internes OSPF normales. Cependant, le coût d’une route E2 est toujours un coût externe, qui ne prend pas en compte le coût interne permettant d’atteindre cette route. Dans cette topologie, la route par défaut sur le routeur R1 ayant un coût externe de 1, R2 et R3 affichent également un coût de 1 pour la route par défaut <b>E2</b>. Les routes E2 d’un coût de 1, ont aussi reçu une configuration OSPF par défaut. Le changement de ces paramètres par défaut, ainsi que de plus amples informations sur les routes externes seront abordés dans le cours CCNP.</p></content-text>
</page>
</topic>
<topic type="" id="tl0911050200">
<title><content-text>Réglage du protocole OSPF</content-text></title>
<page type="OneColumn" id="tl0911050201">
<content-media type="InteractiveGraphicHotspots" id="cm1011211104"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050200/tl0911050201/cm1011211104.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911050000/tl0911050200/tl0911050201/cm1011211104text.xml"/></content-media>
<content-text><p><b>Bande passante de référence</b></p> <p>Comme vous vous en souvenez, le coût OSPF Cisco utilise le cumul des bandes passantes. La valeur de bande passante de chaque interface est calculée à l’aide de la formule 100 000 000/bande passante. 100 000 000 ou 10 élevé à la puissance 8 est connu comme bande passante de référence.</p> <p>Donc, 100 000 000 représente la bande passante par défaut référencée lorsque la bande passante réelle est convertie en métrique de coût. Comme vous l’avez appris pendant les études précédentes, nous avons maintenant des débits de liaison bien supérieurs aux vitesses Fast Ethernet, notamment le Gigabit Ethernet et 10GigE. L’utilisation d’une bande passante de référence de 100 000 000 a pour résultat que les interfaces avec un débit de 100 Mbits/s et plus ont un coût OSPF de 1.</p> <p>Pour obtenir des calculs de coûts plus précis, un ajustement des valeurs de bande passante de référence peut s’avérer nécessaire. La bande passante de référence peut être modifiée pour prendre en compte ces liaisons plus rapides, grâce à la commande OSPF <span class="cmd"><b>auto-cost reference-bandwidth</b></span>. Lorsque cette commande est nécessaire, utilisez-la sur tous les routeurs afin que la métrique de routage OSPF reste cohérente.</p> <span class="cmd"><p>R1(config-router)#<b>auto-cost reference-bandwidth ?</b></p></span> <span class="cmd"><p> 1-4294967 The reference bandwidth in terms of Mbits per second</p></span> <p>Notez que la valeur est exprimée en Mb/s. Par conséquent, la valeur par défaut est égale à 100. Pour passer à des vitesses en 10GigE, vous devez définir la bande passante de référence sur 10 000.</p> <p><span class="cmd">R1(config-router)#<b>auto-cost reference-bandwidth 10000</b></span></p> <p>De nouveau, configurez cette commande sur tous les routeurs du domaine de routage OSPF. L’IOS peut vous le rappeler, comme indiqué dans le schéma.</p> <p><b>Dans le schéma, cliquez sur R1 avant et R1 après.</b></p> <p>La table de routage de R1 affiche les modifications intervenues dans la métrique de coût. Notez que les routes OSPF présentent des valeurs de coût bien supérieures. Par exemple, dans <b>R1 avant</b>, le coût vers 10.10.10.0/24 est de <b>1172</b>. Une fois la nouvelle bande passante de référence configurée, le coût pour la même route est de <b>117287</b>.</p></content-text>
</page>
<page type="OneColumn" id="tl0911050202">
<content-media type="InteractiveGraphicHotspots" id="cm3932849466"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050200/tl0911050202/cm3932849466.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911050000/tl0911050200/tl0911050202/cm3932849466text.xml"/></content-media>
<content-text><p><b>Modification des intervalles OSPF</b></p> <p><b>Dans le schéma, cliquez sur Voisins 1 de R1.</b></p> <p>La commande <span class="cmd"><b>show ip ospf neighbor</b></span> exécutée sur R1 vérifie que R1 est contigu à R2 et R3. Notez que la sortie pour le délai Dead amorce un compte à rebours de 40 secondes. Par défaut, cette valeur est réactualisée toutes les 10 secondes lorsque R1 reçoit un Hello de son voisin.</p> <p>Il peut être préférable de modifier les minuteurs OSPF pour qu’ils soient en mesure de détecter les défaillances plus rapidement. Ceci augmentera le trafic, mais cela peut être un critère secondaire lorsqu’une convergence rapide est requise.</p> <p>Les intervalles Dead et Hello OSPF peuvent être modifiés manuellement à l’aide des commandes d’interface suivantes :</p> <span class="cmd"><p>Router(config-if)#<b>ip ospf hello-interval </b><i>secondes</i></p></span> <span class="cmd"><p>Router(config-if)#<b>ip ospf dead-interval </b><i>secondes</i></p></span> <p><b>Cliquez sur Modifier les minuteurs R1 dans le schéma.</b></p> <p>La figure affiche les intervalles Dead et Hello modifiés, à 5 et 20 secondes respectivement, sur l’interface Serial 0/0/0 pour R1. Immédiatement après la modification de l’intervalle Hello, l’IOS Cisco modifie automatiquement l’intervalle Dead pour le porter à 4 fois la valeur de l’intervalle Hello. Cependant, le fait de modifier de façon explicite le minuteur est une saine pratique, plutôt que de compter sur une fonction automatique d’IOS. Les modifications figurent ainsi dans la configuration. </p> <p>Au bout de 20 secondes, le compteur d’arrêt expire sur R1. La contiguïté entre R1 et R2 est perdue. Nous avons modifié uniquement les valeurs de l’une des extrémités de la liaison série entre R1 et R2.</p> <p><span class="cmd">%OSPF-5-ADJCHG: Process 1, Nbr 10.2.2.2 on Serial0/0/0 from FULL to DOWN, Neighbor Down: Dead timer expired</span></p> <p><b>Dans le schéma, cliquez sur Voisins 2 de R1.</b></p> <p>Souvenez-vous que les intervalles OSPF Hello et Dead doivent être identiques entre voisins. Vous pouvez vérifier la perte de la contiguïté en exécutant la commande <span class="cmd"><b>show ip ospf neighbor</b></span> sur R1. Notez que le voisin 10.2.2.2 n’est plus présent. Cependant, 10.3.3.3 ou R3 est toujours un voisin. Les minuteurs définis sur Serial 0/0/0 n’affectent pas la contiguïté de voisinage avec R3.</p> <p><b>Dans le schéma, cliquez sur Minuteurs R2.</b></p> <p>Vous pouvez vérifier que les intervalles Hello et Dead ne correspondent pas en utilisant la commande <span class="cmd"><b>show ip ospf interface serial 0/0/0</b></span> sur R2. Les valeurs d’intervalle sur R2, ID de routeur 10.2.2.2, sont toujours de 10 secondes pour Hello et de 40 secondes pour Dead. </p> <p><b>Cliquez sur Modifier les minuteurs R2 dans le schéma.</b></p> <p>Pour restaurer la contiguïté entre R1 et R2, modifiez les intervalles Hello et Dead de l’interface série Serial 0/0/0 sur R2 pour qu’ils correspondent à l’interface série Serial 0/0/0 de R1. L’IOS affiche un message indiquant que la contiguïté a été établie avec un état <span class="cmd"><b>FULL</b></span> (complet).</p> <p><span class="cmd">14:22:27: %OSPF-5-ADJCHG: Process 1, Nbr 10.1.1.1 on Serial0/0 from LOADING to FULL, Loading Done</span></p> <p><b>Dans le schéma, cliquez sur Voisins 3 de R1.</b></p> <p>Vérifiez que la contiguïté a été restaurée en exécutant la commande show ip ospf neighbor sur R1. Notez que le délai Dead de Serial 0/0/0 est maintenant bien plus bas, car il amorce un compte à rebours à partir de 20 secondes au lieu des 40 secondes par défaut. L’interface Serial0/0/1 a conservé ses minuteurs par défaut.</p> <p><b>Remarque :</b> OSPF exige que les intervalles Hello et Dead de deux routeurs correspondent pour devenir contigus, contrairement au protocole EIGRP. Les minuteurs Hello et de mise hors (Holddown) service de deux routeurs n’ont pas à correspondre pour former une contiguïté EIGRP. </p> <p> </p></content-text>
</page>
<page type="OneColumn" id="tl0911050203">
<content-media type="ActivityPKA" id="cm2090191812"><title><content-text></content-text></title><media ref="tl0911000000/tl0911050000/tl0911050200/tl0911050203/cm2090191812/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911050000/tl0911050200/tl0911050203/cm2090191812/icontext.xml"/></content-media>
<content-text><p>Utilisez l’exercice Packet Tracer pour configurer une route par défaut et la diffuser dans le processus de routage OSPF. Entraînez-vous également à modifier la bande passante de référence, ainsi que les intervalles Hello et Dead.</p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl0911060000">
<title><content-text>Travaux pratiques de configuration OSPF</content-text></title>
<topic type="" id="tl0911060100">
<title><content-text>Travaux pratiques de configuration de base du protocole OSPF</content-text></title>
<page type="OneColumn" id="tl0911060101">
<content-media type="ActivityLab" id="cm1737336076"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060100/tl0911060101/cm1737336076/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060100/tl0911060101/cm1737336076/icontext.xml"/></content-media>
<content-text><p>Ces travaux pratiques comprennent deux scénarios distincts. Dans le premier scénario, vous apprendrez comment configurer le protocole de routage OSPF en utilisant le réseau figurant dans le schéma de topologie du scénario A. Les segments réseau ont été divisés en sous-réseaux à l’aide de la technique VLSM. OSPF est un protocole de routage sans classe qui peut être utilisé pour fournir des données de masque de sous-réseau dans les mises à jour de routage. Cela permettra aux données de sous-réseau VLSM d’être diffusées sur tout le réseau. </p> <p>Dans le deuxième scénario, vous apprendrez à configurer le protocole OSPF sur un réseau à accès multiple. Vous apprendrez aussi à utiliser le processus de sélection OSPF pour déterminer les états du routeur désigné (DR), du routeur désigné de sauvegarde (BDR) et du routeur DRother.</p></content-text>
</page>
<page type="OneColumn" id="tl0911060102">
<content-media type="ActivityPKA" id="cm1867715526"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060100/tl0911060102/cm1867715526/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060100/tl0911060102/cm1867715526/icontext.xml"/></content-media>
<content-text><p>Utilisez cet exercice Packet Tracer pour refaire une simulation des travaux pratiques 11.6.1. Souvenez-vous cependant que Packet Tracer n’est pas un substitut aux travaux pratiques avec un équipement réel. </p> <p>Un résumé des instructions est fourni pendant cet exercice. Pour plus de détails, utilisez le PDF des travaux pratiques.</p> <p><b>Cliquez sur l’icône Packet Tracer pour lancer le scénario A. Tous les scénarios relatifs à cette simulation de travaux pratiques peuvent être lancés à partir des liens ci-dessous.</b></p> <p><content-link target="E2_PTAct_11_6_1a.pka" type="internalfile">Scénario A</content-link></p> <p><content-link target="E2_PTAct_11_6_1b.pka" type="internalfile">Scénario B</content-link></p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0911060200">
<title><content-text>Travaux pratiques de configuration avancée du protocole OSPF</content-text></title>
<page type="OneColumn" id="tl0911060201">
<content-media type="ActivityLab" id="cm3141260913"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060200/tl0911060201/cm3141260913/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060200/tl0911060201/cm3141260913/icontext.xml"/></content-media>
<content-text><p>Dans ces travaux pratiques, vous devrez diviser une adresse réseau en sous-réseaux à l’aide des masques de sous-réseau de longueur variable (VLSM) pour procéder à l’adressage du réseau qui est illustré dans le schéma de topologie. Une combinaison de routage OSPF et de routage statique sera nécessaire afin que des hôtes de réseaux qui ne sont pas connectés directement puissent communiquer entre eux. L’ID de zone OSPF 0 et l’ID de processus ID 1 seront utilisés dans toutes les configurations OSPF.</p></content-text>
</page>
<page type="OneColumn" id="tl0911060202">
<content-media type="ActivityPKA" id="cm9785155336"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060200/tl0911060202/cm9785155336/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060200/tl0911060202/cm9785155336/icontext.xml"/></content-media>
<content-text><p>Utilisez cet exercice Packet Tracer pour refaire une simulation des travaux pratiques 11.6.2. Souvenez-vous cependant que Packet Tracer n’est pas un substitut aux travaux pratiques avec un équipement réel. </p> <p>Un résumé des instructions est fourni pendant cet exercice. Pour plus de détails, utilisez le PDF des travaux pratiques.</p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl0911060300">
<title><content-text>Travaux pratiques de dépannage du protocole OSPF</content-text></title>
<page type="OneColumn" id="tl0911060301">
<content-media type="ActivityLab" id="cm7917924119"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060300/tl0911060301/cm7917924119/" mime="application/pdf" scale="icontext.xml" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060300/tl0911060301/cm7917924119/icontext.xml"/></content-media>
<content-text><p>Dans ces travaux pratiques, vous commencerez par charger des scripts de configuration sur chacun des routeurs. Ces scripts contiennent des erreurs qui empêcheront la communication de bout en bout sur le réseau. </p> <p>Vous devrez dépanner chacun des routeurs pour déterminer les erreurs de configuration, puis utiliser les commandes appropriées pour corriger les différentes configurations. </p> <p>Une fois l’ensemble des erreurs de configuration corrigées, tous les hôtes du réseaux devraient être en mesure de communiquer entre eux. </p></content-text>
</page>
<page type="OneColumn" id="tl0911060302">
<content-media type="ActivityPKA" id="cm5792827552"><title><content-text></content-text></title><media ref="tl0911000000/tl0911060000/tl0911060300/tl0911060302/cm5792827552/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911060000/tl0911060300/tl0911060302/cm5792827552/icontext.xml"/></content-media>
<content-text><p>Utilisez cet exercice Packet Tracer pour refaire une simulation des travaux pratiques 11.6.3. Souvenez-vous cependant que Packet Tracer n’est pas un substitut aux travaux pratiques avec un équipement réel. </p> <p>Un résumé des instructions est fourni pendant cet exercice. Pour plus de détails, utilisez le PDF des travaux pratiques.</p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="tl0911070000">
<title><content-text>Résumé du chapitre</content-text></title>
<topic type="" id="tl0911070100">
<title><content-text>Résumé et révision</content-text></title>
<page type="OneColumn" id="tl0911070101">
<content-media type="StaticGraphic" id="cm6481762101"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070101/cm6481762101.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911070000/tl0911070100/tl0911070101/cm6481762101text.xml"/></content-media>
<content-text><p><b>Résumé</b></p> <p>Le protocole OSPF (Open Shortest Path First) est un protocole de routage à état de liens sans classe. La version actuelle du protocole OSPF pour IPv4 est OSPFv2, présenté dans le document RFC 1247 et mis à jour dans le document RFC 2328 par John Moy. En 1999, OSPFv3 pour IPv6 a été publié dans le document RFC 2740.</p> <p>Le protocole OSPF a une distance administrative par défaut de 110 et est signalé dans la table de routage par un code source de route de <b>O</b>. OSPF est activé à l’aide de la commande de configuration globale <span class="cmd"><b>router ospf </b><i>process-id</i></span>. Le <span class="cmd"><i>process-id</i></span> n’a qu’une signification locale, ce qui veut dire qu’il n’a pas à correspondre à celui des autres routeurs OSPF pour établir des contiguïtés avec des voisins.</p> <p>La commande network utilisée avec le protocole OSPF a la même fonction que lorsqu’elle est utilisée avec les autres protocoles de routage IGP, mais sa syntaxe diffère légèrement. </p> <p><span class="cmd">Router(config-router)#<b>network </b><i>network-address wildcard-mask </i><b> area </b><i>area-id</i></span></p> <p>Le <span class="cmd"><i>wildcard-mask </i></span> est l’inverse du masque de sous-réseau et <span class="cmd"><i>area-id</i></span> doit être défini sur 0.</p> <p>OSPF n’utilise pas de protocole de couche transport, car les paquets OSPF sont envoyés directement sur IP. Le paquet Hello OSPF est utilisé par OSPF pour établir des contiguïtés de voisinage. Par défaut, les paquets Hello OSPF sont envoyés toutes les 10 secondes sur des segments à accès multiple et point à point et toutes les 30 secondes sur les segments NBMA (Non-broadcast multiaccess - Accès multiple sans diffusion) (Frame Relay, X.25, ATM). L’intervalle Dead est la période pendant laquelle le routeur attend de recevoir un paquet Hello avant de mettre fin à une contiguïté avec un voisin. Par défaut, l’intervalle Dead est quatre fois plus long que l’intervalle Hello. Pour les segments à accès multiple et point à point, cette période est de 40 secondes. Pour les réseaux NBMA, l’intervalle Dead est de 120 secondes.</p> <p>Pour que les routeurs deviennent contigus, leurs intervalles Hello et Dead, leurs types de réseau et masque de sous-réseau doivent correspondre. La commande <span class="cmd"><b>show ip ospf neighbors</b></span> peut être utilisée pour vérifier les contiguïtés OSPF.</p> <p>L’ID de routeur OSPF permet d’identifier chaque routeur de façon unique dans le domaine de routage OSPF. Les routeurs Cisco créent l’ID de routeur en fonction de trois critères et dans l’ordre de priorité ci-dessous :</p> <p>1. Utilisation de l’adresse IP configurée avec la commande <span class="cmd"><b>router-id</b></span> du protocole OSPF.</p> <p>2. Si <span class="cmd"><b>router-id</b></span> n’est pas configuré, le routeur choisit l’adresse IP la plus élevée parmi ses interfaces de bouclage IP.</p> <p>3. Si aucune interface de bouclage n’est configurée, le routeur choisit l’adresse IP active la plus élevée parmi ses interfaces physiques.</p> <p>Le document RFC 2328 n’indique pas les valeurs à utiliser pour déterminer le coût. Pour calculer un coût, l’IOS de Cisco cumule les bandes passantes des interfaces de sortie depuis le routeur vers le réseau de destination.</p> <p>Les réseaux à accès multiple peuvent être à l’origine de deux difficultés relatives aux LSA pour OSPF, notamment la création de contiguïtés multiples, une pour chaque paire de routeurs, et une diffusion massive de LSA (Link-State Advertisements). OSPF sélectionne un DR (Routeur désigné) pour servir de point de collecte et de distribution pour les LSA envoyées et reçues dans le réseau à accès multiple. Un BDR (Backup Designated Router - Routeur désigné de secours) est sélectionné pour reprendre le rôle du DR en cas de panne. Touts les autres routeurs sont connus sous le nom de DROthers. Tous les routeurs envoient leur LSA au DR, qui les diffuse ensuite aux autres routeurs du réseau à accès multiple. </p> <p>Le routeur possédant l’ID de routeur le plus élevé est le DR, et celui avec le second ID le plus élevé est le BDR. Vous pouvez passer outre cette situation en utilisant la commande <span class="cmd"><b>ip ospf priority</b></span> sur cette interface. Par défaut, la priorité <span class="cmd"><b>ip ospf priority</b></span> est de « 1 » sur les interfaces à accès multiple. Si le routeur est configuré avec une nouvelle valeur de priorité, le routeur possédant la valeur de priorité la plus élevée est le DR, et celui dont la valeur est la suivante, le BDR. Lorsqu’elle est attribuée à un routeur, la valeur de priorité 0 empêche sa sélection en tant que DR ou BDR.</p> <p>Une route par défaut est diffusée sur OSPF, comme sur RIP. La commande de mode de routeur OSPF, <span class="cmd"><b>default-information originate</b></span>, sert à diffuser une route par défaut statique.</p> <p>La commande <span class="cmd"><b>show ip protocols</b></span> sert à vérifier les données de configuration OSPF importantes, notamment l’ID de processus OSPF, l’ID de routeur et les réseaux auxquels le routeur fait ses annonces.</p></content-text>
</page>
<page type="FullScreen" id="tl0911070102">
<content-media type="ChapterSummary" id="cm4988293699"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070102/cm4988293699.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911070000/tl0911070100/tl0911070102/cm4988293699text.xml"/></content-media>
<content-text></content-text>
</page>
<page type="OneColumn" id="tl0911070103">
<content-media type="ActivityPKA" id="cm4174693481"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070103/cm4174693481/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl0911000000/tl0911070000/tl0911070100/tl0911070103/cm4174693481/icontext.xml"/></content-media>
<content-text><p>L’exercice d’intégration des compétences Packet Tracer intègre toutes les connaissances et compétences que vous avez acquises dans les chapitres précédents de ce cours, et dans des cours précédents. Les compétences relatives au présent chapitre sur OSPF y sont également incluses. </p> <p>Dans cet exercice, vous créez un réseau entièrement nouveau. À partir d’un espace d’adressage et d’exigences réseau, vous mettrez en œuvre un concept de réseau répondant aux spécifications. Vous mettrez ensuite en œuvre une configuration de routage OSPF efficace, avec routage par défaut intégré. Des instructions détaillées vous sont fournies pendant l’exercice. </p> <p><content-link target="E2_PTAct_11_7_1_Directions.pdf" type="internalfile">Instructions d’intégration des compétences Packet Tracer (PDF)</content-link></p><p><b>Cliquez sur l’icône Packet Tracer pour plus de détails.</b></p></content-text>
</page>
<page type="OneColumn" id="tl0911070104">
<content-media type="StaticGraphic" id="cm9917528955"><title><content-text></content-text></title><media ref="tl0911000000/tl0911070000/tl0911070100/tl0911070104/cm9917528955.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl0911000000/tl0911070000/tl0911070100/tl0911070104/cm9917528955text.xml"/></content-media>
<content-text><p><b>Autres sources d’informations</b></p> <p> </p> <p><b>RFC 2328 OSPF version 2</b></p> <p>Les documents RFC sont une série de documents soumis au groupe de travail IETF pour proposer une norme Internet ou transmettre de nouveaux concepts, de nouvelles informations ou parfois des notes d’humour. Le document RFC 2328 est celui qui concerne OSPFv2. </p> <p>Les documents RFC sont accessibles à partir de plusieurs sites, notamment <content-link target="http://www.ietf.org" type="external">www.ietf.org</content-link>. Prenez connaissance de tout ou partie des RFC OSPF pour en apprendre davantage sur ce protocole de routage sans classe à état de liens. </p> <p><b>Protocole OSPF à zones multiples</b></p> <p>Certains des avantages réels d’OSPF, particulièrement dans les grands réseaux, sont visibles dans le protocole OSPF à zones multiples. OSPF à zones multiples est un des sujets du cours CCNP, mais il se peut que vous vouliez voir certains de ses concepts dès maintenant. </p> <p>Voici quelques suggestions de sources :</p> <p><ul><li> <i>Routing TCP/IP, Volume I</i>, de Jeff Doyle et Jennifer Carroll</li><li> <i>OSPF, Anatomy of an Internet Routing Protocol</i>, de John Moy</li></ul></p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="tl0911080000">
<title><content-text>Questionnaire du chapitre</content-text></title>
<topic type="" id="tl0911080100">
<title><content-text>Questionnaire du chapitre</content-text></title>
<page type="FullScreen" id="tl0911080101">
<content-media type="ChapterQuiz" id="cm6500755456"><title><content-text></content-text></title><media ref="tl0911000000/tl0911080000/tl0911080100/tl0911080101/cm6500755456/" mime="" scale="true" type="directory" width="100%" height="100%" external="tl0911000000/tl0911080000/tl0911080100/tl0911080101/cm6500755456/icontext.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
