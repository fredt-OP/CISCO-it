<chapter type="" id="en0902000000">
<title><content-text>Static Routing</content-text></title>
<section type="ChapterIntroduction" id="en0902000000">
<title><content-text>Chapter Introduction</content-text></title>
<topic type="" id="en0902000100">
<title><content-text>Chapter Introduction</content-text></title>
<page type="OneColumn" id="en0902000101">
<content-media type="StaticGraphic" id="cm1838215924"><title><content-text></content-text></title><media ref="en0902000000/en0902000000/en0902000100/en0902000101/cm1838215924.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902000000/en0902000100/en0902000101/cm1838215924text.xml"/></content-media>
<content-text><p><b>Chapter Introduction</b></p> <p>Routing is at the core of every data network, moving information across an internetwork from source to destination. Routers are the devices responsible for the transfer of packets from one network to the next.</p> <p>As we learned in the previous chapter, routers learn about remote networks either dynamically using routing protocols or manually using static routes. In many cases routers use a combination of both dynamic routing protocols and static routes. This chapter focuses on static routing.</p> <p>Static routes are very common and do not require the same amount of processing and overhead as we will see with dynamic routing protocols.</p> <p>In this chapter, we will follow a sample topology as we configure static routes and learn troubleshooting techniques. In the process, we will examine several key IOS commands and the results they display. We will also introduce the routing table using both directly connected networks and static routes.</p> <p>As you work through the Packet Tracer activities associated with these commands, take the time to experiment with the commands and examine the results. Reading the routing tables will soon become second nature.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902010000">
<title><content-text>Routers and Network</content-text></title>
<topic type="" id="en0902010100">
<title><content-text>Role of the Router</content-text></title>
<page type="OneColumn" id="en0902010101">
<content-media type="StaticGraphic" id="cm5752858752"><title><content-text></content-text></title><media ref="en0902000000/en0902010000/en0902010100/en0902010101/cm5752858752.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902010000/en0902010100/en0902010101/cm5752858752text.xml"/></content-media>
<content-text><p><b>Role of the Router</b></p> <p>The router is a special-purpose computer that plays a key role in the operation of any data network. Routers are primarily responsible for interconnecting networks by:</p> <ul><li> Determining the best path to send packets </li> <li> Forwarding packets toward their destination</li></ul> <p>Routers perform packet forwarding by learning about remote networks and maintaining routing information. The router is the junction or intersection that connects multiple IP networks. The routers primary forwarding decision is based on Layer 3 information, the destination IP address. </p> <p>The router's routing table is used to find the best match between the destination IP of a packet and a network address in the routing table. The routing table will ultimately determine the exit interface to forward the packet and the router will encapsulate that packet in the appropriated data link frame for that outgoing interface.</p></content-text>
</page>
</topic>
<topic type="" id="en0902010200">
<title><content-text>Introducing the Topology</content-text></title>
<page type="OneColumn" id="en0902010201">
<content-media type="StaticGraphic" id="cm8855462765"><title><content-text></content-text></title><media ref="en0902000000/en0902010000/en0902010200/en0902010201/cm8855462765.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902010000/en0902010200/en0902010201/cm8855462765text.xml"/></content-media>
<content-text><p><b>Introducing the Topology</b></p> <p>The figure shows the topology used in this chapter. The topology consists of three routers, labeled R1, R2, and R3. Routers R1 and R2 are connected through one WAN link, and routers R2 and R3 are connected through another WAN link. Each router is connected to a different Ethernet LAN, represented by a switch and a PC.</p> <p>Each router in this example is a Cisco 1841. A Cisco 1841 router has the following interfaces:</p> <ul><li>Two FastEthernet interfaces: FastEthernet 0/0 and FastEthernet 0/1</li> <li> Two serial interfaces: Serial 0/0/0 and Serial0/0/1</li></ul> <p>The interfaces on your routers may vary from those on the 1841, but you should be able to follow the commands in this chapter-with some slight modifications-and complete the hands-on labs. In addition, Packet Tracer activities are available throughout the discussion of static routing so that you can practice skills as they are presented. Lab 2.8.1, "Basic Static Route Configuration," mirrors the topology, configurations, and commands discussed in this chapter.</p></content-text>
</page>
</topic>
<topic type="" id="en0902010300">
<title><content-text>Examining the Connections of the Router</content-text></title>
<page type="OneColumn" id="en0902010301">
<content-media type="InteractiveGraphicHotspots" id="cm1194388007"><title><content-text></content-text></title><media ref="en0902000000/en0902010000/en0902010300/en0902010301/cm1194388007.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902010000/en0902010300/en0902010301/cm1194388007text.xml"/></content-media>
<content-text><p><b>Router Connections</b></p> <p>Connecting a router to a network requires a router interface connector to be coupled with a cable connector. As you can see in the figure, Cisco routers support many different connector types.</p> <p><b>Serial Connectors</b></p> <p><b>Click 1 in the figure.</b></p> <p>For WAN connections, Cisco routers support the EIA/TIA-232, EIA/TIA-449, V.35, X.21, and EIA/TIA-530 standards for serial connections, as shown. Memorizing these connection types is not important. Just know that a router has a DB-60 port that can support five different cabling standards. Because five different cable types are supported with this port, the port is sometimes called a five-in-one serial port. The other end of the serial cable is fitted with a connector that is appropriate to one of the five possible standards. </p> <p><b>Note</b>: The documentation for the device to which you want to connect should indicate the standard for that device. </p> <p><b>Click 2 and 3 in the figure.</b></p> <p>Newer routers support the smart serial interface that allows for more data to be forwarded across fewer cable pins. The serial end of the smart serial cable is a 26-pin connector. It is much smaller than the DB-60 connector used to connect to a five-in-one serial port. These transition cables support the same five serial standards and are available in either DTE or DCE configurations.</p> <p><b>Note:</b> For a thorough explanation of DTE and DCE, see Lab 1.5.1, "Cabling a Network and Basic Router Configuration." </p> <p>These cable designations are only important to you when configuring your lab equipment to simulate a "real-world" environment. In a production setting, the cable type is determined for you by the WAN service you are using.</p> <p><b>Ethernet Connectors</b></p> <p><b>Click 4 in the figure.</b></p> <p>A different connector is used in an Ethernet-based LAN environment. An RJ-45 connector for the unshielded twisted-pair (UTP) cable is the most common connector used to connect LAN interfaces. At each end of an RJ-45 cable, you should be able to see eight colored strips, or pins. An Ethernet cable uses pins 1, 2, 3, and 6 for transmitting and receiving data. </p> <p>Two types of cables can be used with Ethernet LAN interfaces:</p> <ul><li> A straight-through, or patch cable, with the order of the colored pins the same on each end of the cable</li> <li> A crossover cable, with pin 1 connected to pin 3, and pin 2 connected to pin 6</li></ul> <p>Straight-through cables are used for:</p> <ul><li> Switch-to-router</li> <li> Switch-to-PC</li> <li> Hub-to-PC</li> <li> Hub-to-server</li></ul> <p>Crossover cables are used for:</p> <ul><li> Switch-to-switch </li> <li> PC-to-PC </li> <li> Switch-to-hub</li> <li> Hub-to-hub</li> <li> Router-to-router</li> <li> Router-to-server</li></ul> <p><b>Note:</b> Wireless connectivity is discussed in another course.</p></content-text>
</page>
<page type="OneColumn" id="en0902010302">
<content-media type="ActivityPKA" id="cm8107970031"><title><content-text></content-text></title><media ref="en0902000000/en0902010000/en0902010300/en0902010302/cm8107970031/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902010000/en0902010300/en0902010302/cm8107970031/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to build the topology that you will use for the rest of this chapter. You will add all the necessary devices and connect them with the correct cabling.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902020000">
<title><content-text>Router Configuration Review</content-text></title>
<topic type="" id="en0902020100">
<title><content-text>Examining Router Interfaces</content-text></title>
<page type="OneColumn" id="en0902020101">
<content-media type="InteractiveGraphicHotspots" id="cm5023387160"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020100/en0902020101/cm5023387160.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020100/en0902020101/cm5023387160text.xml"/></content-media>
<content-text><p><b>Examining Router Interfaces</b></p> <p>As we learned in Chapter 1, the <span class="cmd">show ip route</span> command is used to display the routing table. Initially, the routing table is empty if no interfaces have been configured. </p> <p>As you can see in the routing table for R1, no interfaces have been configured with an IP address and subnet mask. </p> <p><b>Note:</b> Static routes and dynamic routes will not be added to the routing table until the appropriate local interfaces, also known as the exit interfaces, have been configured on the router. This procedure will be examined more closely in later chapters.</p>  <p><b>Interfaces and their Status</b></p> <p>The status of each interface can be examined by using several commands. </p> <p><b>Click </b><span class="cmd"><b>show interfaces</b></span><b> in the figure.</b></p>  <p>The <span class="cmd"><b>show interfaces</b></span> command shows the status and gives a detailed description for all interfaces on the router. As you can see, the output from the command can be rather lengthy. To view the same information, but for a specific interface, such as FastEthernet 0/0, use the <span class="cmd"> <b>show interfaces</b></span> command with a parameter that specifies the interface. For example: </p> <span class="cmd"><p>R1#<b>show interfaces fastethernet 0/0</b></p></span> <span class="cmd"><p>FastEthernet0/0 is <span class="blue">administratively down, line protocol is down</span></p></span> <p>Notice that the interface is <b>administratively down</b> and the <b>line protocol is down</b>. Administratively down means that the interface is currently in the shutdown mode, or turned off. Line protocol is down means, in this case, that the interface is not receiving a carrier signal from a switch or the hub. This condition may also be due to the fact that the interface is in shutdown mode.</p>  <p>You will notice that the <span class="cmd"><b>show interfaces</b></span> command does not show any IP addresses on R1's interfaces. The reason for this is because we have not yet configured IP addresses on any of the interfaces.</p>  <p><b>Additional Commands for Examining Interface Status</b></p>  <p><b>Click </b><span class="cmd"><b>show ip interface brief </b></span> <b>in the figure.</b></p> <p></p> <p>The <span class="cmd"><b>show ip interface brief</b></span> command can be used to see a portion of the interface information in a condensed format. </p> <p><b>Click </b><span class="cmd"><b>show running-config</b></span><b> in the figure.</b></p> <p>The <span class="cmd"><b>show running-config</b></span> command displays the current configuration file that the router is using. Configuration commands are temporarily stored in the running configuration file and implemented immediately by the router. Using this command is another way to verify the status of an interface such as FastEthernet 0/0.</p> <span class="cmd"><p>R1#<b>show running-config</b></p></span> <span class="cmd"><p>&lt;some output omitted></p></span> <span class="cmd"><p>interface FastEthernet0/0</p></span> <span class="cmd"><p><span class="blue">no ip address</span></p></span> <span class="cmd"><p><span class="blue">shutdown</span></p></span> <span class="cmd"><p>&lt;some output omitted></p></span> <p>However, using <span class="cmd"><b>show running-config</b></span> is not necessarily the best way to verify interface configurations. Use the <span class="cmd"><b>show ip interface brief</b></span> command to quickly verify that interfaces are <b>up </b>and <b>up </b>(administratively <b>up </b>and line protocol is <b>up</b>).</p></content-text>
</page>
</topic>
<topic type="" id="en0902020200">
<title><content-text>Configuring an Ethernet Interface</content-text></title>
<page type="OneColumn" id="en0902020201">
<content-media type="InteractiveGraphicHotspots" id="cm1048398155"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020200/en0902020201/cm1048398155.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020200/en0902020201/cm1048398155text.xml"/></content-media>
<content-text><p><b>Configuring an Ethernet Interface</b></p> <p>As shown, R1 does not yet have any routes. Let's add a route by configuring an interface and explore exactly what happens when that interface is activated. By default, all router interfaces are <b>shutdown</b>, or turned off. To enable this interface, use the <span class="cmd"><b>no shutdown</b> </span> command, which changes the interface from <b>administratively down</b> to <b>up</b>.</p> <span class="cmd"><p>R1(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>ip address 172.16.3.1 255.255.255.0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>no shutdown</b></p></span> <p>The following message is returned from the IOS:</p> <span class="cmd"><p>*Mar 1 01:16:08.212: %LINK-3-UPDOWN: Interface FastEthernet0/0, <span class="blue">changed state to up</span></p></span> <span class="cmd"><p>*Mar 1 01:16:09.214: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, <span class="blue">changed state to up</span></p></span> <p>Both of these messages are important. The first <b>changed state to up</b> message indicates that, physically, the connection is good. If you do not get this first message, be sure that the interface is properly connected to a switch or a hub. </p> <p><b>Note: </b>Although enabled with <span class="cmd"><b>no shutdown</b></span>, an Ethernet interface will not be active, or <b>up</b>, unless it is receiving a carrier signal from another device (switch, hub, PC, or another router). </p> <p>The second changed state to <b>up</b> message indicates that the Data Link layer is operational. On LAN interfaces, we do not normally change the Data Link layer parameters. However, WAN interfaces in a lab environment require clocking on one side of the link as discussed in Lab 1.5.1, "Cabling a Network and Basic Router Configuration," as well as later in the section, "Configuring a Serial Interface." If you do not correctly set the clock rate, then line protocol (the Data Link layer) <b>will not change to up</b>.</p> <p><b>Unsolicited Messages from IOS</b></p> <p><b>Click Unsolicited Messages from IOS in the figure.</b></p> <p>The IOS often sends unsolicited messages similar to the <b>changed state to up</b> messages just discussed. As you can see in the figure, sometimes these messages will occur when you are in the middle of typing a command, such as configuring a description for the interface. The IOS message does not affect the command, but it can cause you to lose your place when typing. </p> <p><b>Click Logging Synchronous in the figure.</b></p> <p>In order to keep the unsolicited output separate from your input, enter line configuration mode for the consoled port and add the <span class="cmd"><b>logging synchronous</b></span> command, as shown. You will see that messages returned by IOS no longer interfere with your typing.</p></content-text>
</page>
<page type="OneColumn" id="en0902020202">
<content-media type="StaticGraphic" id="cm1891083338"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020200/en0902020202/cm1891083338.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020200/en0902020202/cm1891083338text.xml"/></content-media>
<content-text><p><b>Reading the Routing Table</b></p> <p>Now look at routing table shown in the figure. Notice R1 now has a "directly connected" FastEthernet 0/0 interface a new network. The interface was configured with the 172.16.3.1/24 IP address which makes it a member of the 172.16.3.0/24 network.</p> <p>Examine the following line of output from the table:</p> <span class="cmd"><p>C 172.16.3.0 is directly connected, FastEthernet0/0</p></span> <p>The <b>C</b> at the beginning of the route indicates that this is a directly connected network. In other words, R1 has an interface that belongs to this network. The meaning of <b>C</b> is defined in the list of codes at the top of the routing table.</p> <p>The <b>/24</b> subnet mask for this route is displayed in the line above the actual route. </p> <span class="cmd"><p>172.16.0.0/24 is subnetted, 1 subnets</p></span> <span class="cmd"><p>C 172.16.3.0 is directly connected, FastEthernet0/0</p></span> <p><b>Routers Usually Store Network Addresses</b></p> <p>With very few exceptions, routing tables have routes for network addresses rather than individual host addresses. The 172.16.3.0/24 route in the routing table means that this route matches all packets with a destination address belonging to this network. Having a single route represent an entire network of host IP addresses makes the routing table smaller, with fewer routes, which results in faster routing table lookups. The routing table could contain all 254 individual host IP addresses for the 172.16.3.0/24 network, but that is an inefficient way of storing addresses.</p> <p>A phone book is a good analogy for a routing table structure. A phone book is a list of names and phone numbers, sorted in alphabetical order by last name. When looking for a number, we can assume that the fewer names there are in the book, the faster it will be to find a particular name. A phone book of 20 pages and perhaps 2,000 entries will be much easier to search than a book of 200 pages and 20,000 entries. </p> <p>The phone book only contains one listing for each phone number. For example, the Stanford family might be listed as:</p> <p><b>Stanford, Harold, 742 Evergreen Terrace, 555-1234</b></p> <p>This is the single entry for everyone who lives at this address and has the same phone number. The phone book could contain a listing for every individual, but this would increase the size of the phone book. For example, there could be a separate listing for Harold Stanford, Margaret Stanford, Brad Stanford, Leslie Stanford, and Maggie Stanford - all with the same address and phone number. If this were done for every family, the phone book would be larger and take longer to search. </p> <p>Routing tables work the same way: one entry in the table represents a "family" of devices that all share the same network or address space (the difference between a network and an address space will become clearer as you move through the course). The fewer the entries in the routing table, the faster the lookup process. To keep routing tables smaller, network addresses with subnet masks are listed instead of individual host IP addresses.</p> <p><b>Note: </b>Occasionally, a "host route" is entered in the routing table, which represents an individual host IP address. It is listed with the device's host IP address and a /32 (255.255.255.255) subnet mask. The topic of host routes is discussed in another course.</p></content-text>
</page>
</topic>
<topic type="" id="en0902020300">
<title><content-text>Verifying Ethernet interface</content-text></title>
<page type="OneColumn" id="en0902020301">
<content-media type="InteractiveGraphicHotspots" id="cm7397576153"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020300/en0902020301/cm7397576153.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020300/en0902020301/cm7397576153text.xml"/></content-media>
<content-text><p><b>Commands to Verify Interface Configuration</b></p> <p>The <span class="cmd"><b>show interfaces fastethernet 0/0</b></span> command in the figure now shows that the interface is <b>up</b>, and the line protocol is <b>up</b>. The <span class="cmd"><b>no shutdown</b></span> command changed the interface from <b>administratively down</b> to <b>up</b>. Notice that the IP address is now displayed.</p> <p>Click <span class="cmd"><b>show ip interface brief</b></span> in the figure.</p> <p>The <span class="cmd"><b>show ip interface brief</b></span> command also shows verifies this same information. Under the status and protocol, you should see "up".</p> <p>The <span class="cmd"><b>show running-config</b></span> command shows the current configuration of this interface. When the interface is disabled, the <span class="cmd"><b>running-config</b></span> command displays <span class="cmd"><b>shutdown</b></span>; however, when the interface is enabled, <span class="cmd"><b>no shutdown</b></span> is not displayed. </p> <span class="cmd"><p>R1#<b>show running-config</b></p></span> <span class="cmd"><p>&lt;output omitted></p></span> <span class="cmd"><p>interface FastEthernet0/0</p></span> <span class="cmd"><p>ip address 172.16.3.1 255.255.255.0</p></span> <span class="cmd"><p>&lt;output omitted></p></span> <p>As explained in Chapter 1, a router cannot have multiple interfaces that belong to the same IP subnet. Each interface must belong to a separate subnet. For example, a router cannot have both its FastEthernet 0/0 interface configured as 172.16.3.1/24 address and mask and its FastEthernet 0/1 interface configured as 172.16.3.2/24. </p> <p>The IOS will return the following error message if you attempt to configure the second interface with the same IP subnet as the first interface: </p> <span class="cmd"><p>R1(config-if)#<b>int fa0/1</b></p></span> <span class="cmd"><p>R1(config-if)<b>#ip address 172.16.3.2 255.255.255.0</b></p></span> <span class="cmd"><p><span class="blue">172.16.3.0 overlaps with FastEthernet0/0</span></p></span> <span class="cmd"><p>R1(config-if)#</p></span> <p>Typically, the router's Ethernet or FastEthernet interface will be the default gateway IP address for any devices on that LAN. For example, PC1 would be configured with a host IP address belonging to the 172.16.3.0/24 network, with the default gateway IP address 172.16.3.1. 172.16.3.1 is router R1's FastEthernet IP address. Remember, a router's Ethernet or FastEthernet interface will also participate in the ARP process as a member of that Ethernet network.</p></content-text>
</page>
<page type="OneColumn" id="en0902020302">
<content-media type="StaticGraphic" id="cm9849595011"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020300/en0902020302/cm9849595011.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020300/en0902020302/cm9849595011text.xml"/></content-media>
<content-text><p><b>Ethernet Interfaces Participate in ARP</b></p> <p>A router's Ethernet interface participates in a LAN network just like any other device on that network. This means that these interfaces have a Layer 2 MAC address, as shown in the figure. The <span class="cmd"><b>show interfaces</b></span> command displays the MAC address for the Ethernet interfaces.</p> <span class="cmd"><p>R1#<b>show interfaces fastethernet 0/0</b></p></span> <p>As demonstrated in Chapter 1, an Ethernet interface participates in ARP requests and replies and maintains an ARP table. If a router has a packet destined for a device on a directly connected Ethernet network, it checks the ARP table for an entry with that destination IP address in order to map it to the MAC address. If the ARP table does not contain this IP address, the Ethernet interface sends out an ARP request. The device with the destination IP address sends back an ARP reply that lists its MAC address. The IP address and MAC address information is then added to the ARP table for that Ethernet interface. The router is now able to encapsulate the IP packet into an Ethernet frame with the destination MAC address from its ARP table. The Ethernet frame, with the encapsulated packet, is then sent via that Ethernet interface.</p></content-text>
</page>
<page type="OneColumn" id="en0902020303">
<content-media type="ActivityPKA" id="cm2918706651"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020300/en0902020303/cm2918706651/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902020000/en0902020300/en0902020303/cm2918706651/icontext.xml" /></content-media>
<content-text><p>Use the Packet Tracer Activity to practice configuring Ethernet interfaces. Follow the additional instructions provided in the activity to examine the ARP process in simulation mode.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902020400">
<title><content-text>Configuring A Serial Interface</content-text></title>
<page type="OneColumn" id="en0902020401">
<content-media type="StaticGraphic" id="cm9138951276"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020400/en0902020401/cm9138951276.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020400/en0902020401/cm9138951276text.xml"/></content-media>
<content-text><p><b>Configuring a Serial Interface</b></p> <p>Next, let's configure the Serial 0/0/0 interface on router R1. This interface is on the 172.16.2.0/24 network and is assigned the IP address and subnet mask of 172.16.2.1/24. The process we use for the configuration of the serial interface 0/0/0 is similar to the process we used to configure the FastEthernet 0/0 interface.</p> <span class="cmd"><p>R1(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>ip address 172.16.2.1 255.255.255.0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>no shutdown</b></p></span> <p>After entering the commands above, the state of the serial interface may vary depending upon the type of WAN connection. This will be discussed in more detail in a later course. In this course, we will be using dedicated, serial point-to-point connections between two routers. The serial interface will be in the <b>up</b> state only after the other end of the serial link has also been properly configured. We can display the current state of serial 0/0/0 using the <span class="cmd"><b>show interfaces serial 0/0/0</b></span> command, as shown in the figure.</p> <p>As you can see, the link is still down. The link is down because we have not yet configured and enabled the other end of the serial link.</p> <span class="cmd"><p>R1#<b>show interfaces serial 0/0/0</b></p></span> <span class="cmd"><p>Serial0/0/0 is administratively <span class="blue">down</span>, line protocol is <span class="blue">down</span></p></span> <p>We will now configure the other end of this link, Serial 0/0/0 link for router R2. </p> <p><b>Note: </b>There is no requirement that both ends of the serial link use the same interface, in this case, Serial 0/0/0. However, because both interfaces are members of the same network, they both must have IP addresses that belong to the 172.16.2.0/24 network. (The terms <i>network</i> and <i>subnet</i> can be used interchangeably in this case.) R2's interface Serial 0/0/0 is configured with the IP address and subnet mask 172.16.2.2/24.</p> <span class="cmd"><p>R2(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip address 172.16.2.2 255.255.255.0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>no shutdown</b></p></span> <p>If we now issue the <span class="cmd"><b>show interfaces serial 0/0/0</b></span> command on either router, we still see that the link is <b>up/down</b>. </p> <span class="cmd"><p>R2#<b>show interfaces serial 0/0/0</b></p></span> <span class="cmd"><p>Serial0/0/0 is <span class="blue">up</span>, line protocol is <span class="blue">down</span></p></span> <span class="cmd"><p>&lt;output omitted></p></span> <p>The physical link between R1 and R2 is <b>up</b> because both ends of the serial link have been configured correctly with an IP address/mask and enabled with the <span class="cmd"><b>no shutdown</b></span> command. However, the line protocol is still <b>down</b>. This is because the interface is not receiving a clock signal. There is still one more command that we need to enter, the <span class="cmd"><b>clock rate</b></span> command, on the router with the DCE cable. The <span class="cmd"><b>clock rate</b></span> command will set the clock signal for the link. Configuring the clock signal will be discussed in the next section.</p></content-text>
</page>
</topic>
<topic type="" id="en0902020500">
<title><content-text>Examining Router Interfaces</content-text></title>
<page type="OneColumn" id="en0902020501">
<content-media type="StaticGraphic" id="cm6612899463"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020500/en0902020501/cm6612899463.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020500/en0902020501/cm6612899463text.xml"/></content-media>
<content-text><p><b>Physically Connecting a WAN Interface</b></p> <p>The WAN Physical layer describes the interface between the data terminal equipment (DTE) and the data circuit-terminating equipment (DCE). Generally, the DCE is the service provider and the DTE is the attached device. In this model, the services offered to the DTE are made available either through a modem or a CSU/DSU.</p> <p>Typically, the router is the DTE device and is connected to a CSU/DSU, which is the DCE device. The CSU/DSU (DCE device) is used to convert the data from the router (DTE device) into a form acceptable to the WAN service provider. The CSU/DSU (DCE device) is also responsible for converting the data from the WAN service provider into a form acceptable by the router (DTE device). The router is usually connected to the CSU/DSU using a serial DTE cable, as shown. </p> <p><b>Serial interfaces require a clock signal to control the timing of the communications</b>. In most environments, the service provider (a DCE device such as a CSU/DSU) will provide the clock. By default, Cisco routers are DTE devices. However, in a lab environment, we are not using any CSU/DSUs and, of course, we do not have a WAN service provider. </p> <p><b>Roll over the cables and devices in the figure to see what they are.</b></p></content-text>
</page>
<page type="OneColumn" id="en0902020502">
<content-media type="InteractiveGraphicHotspots" id="cm9991825749"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020500/en0902020502/cm9991825749.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020500/en0902020502/cm9991825749text.xml"/></content-media>
<content-text><p><b>Configuring Serial Links in a Lab Environment</b></p> <p>For serial links that are directly interconnected, as in a lab environment, one side of a connection must be considered a DCE and provide a clocking signal. Although Cisco serial interfaces are DTE devices by default, they can be configured as DCE devices.</p> <p>To configure a router to be the DCE device:</p> <p>1. Connect the DCE end of the cable to the serial interface.</p> <p>2. Configure the clock signal on the serial interface using the <span class="cmd"><b>clock rate</b></span> command.</p> <p>The serial cables used in the lab are typically one of two types. </p> <ul><li> A DTE/DCE crossover cable on which one end is DTE and the other end is DCE</li> <li> A DTE cable connected to a DCE cable</li></ul> <p>In our lab topology, the Serial 0/0/0 interface on R1 is connected with the DCE end of the cable, and the serial 0/0/0 interface on R2 is connected to the DTE end of the cable. The cable should be labeled either DTE or DCE. </p> <p>You can also distinguish DTE from DCE by looking at the connector between the two cables. The DTE cable has a male connector, whereas the DCE cable has a female connector.</p> <p>If a cable is connected between the two routers, you can use the <span class="cmd"><b>show controllers</b></span> command to determine which end of the cable is attached to that interface. In the command output, notice that R1 has the DCE cable attached to its serial 0/0 interface and that no clock rate is set. </p> <span class="cmd"><p>R1#<b>show controllers serial 0/0/0</b></p></span> <span class="cmd"><p>Interface Serial0/0/0</p></span> <span class="cmd"><p>Hardware is PowerQUICC <span class="blue">MPC860</span></p></span> <span class="cmd"><p><span class="blue">DCE V.35</span>, no clock</p></span> <span class="cmd"><p>&lt;output omitted></p></span> <p>Once the cable is attached, the clock can now be set with the <span class="cmd"><b>clock rate</b></span> command. The available clock rates, in bits per second, are 1200, 2400, 9600, 19200, 38400, 56000, 64000, 72000, 125000, 148000, 500000, 800000, 1000000, 1300000, 2000000, and 4000000. Some bit rates might not be available on certain serial interfaces. Because Serial 0/0/0 interface on R1 has the DCE cable attached, we will configure that interface with a clock rate. </p> <span class="cmd"><p>R1(config)#<b>interface serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config-if)#<b>clock rate 64000</b></p></span> <span class="cmd"><p>01:10:28: %LINEPROTO-5-UPDOWN: Line protocol on Interface Serial0/0/0, changed state to up</p></span> <p><b>Note:</b> If a router's interface with a DTE cable is configured with the clock rate command, the IOS will disregard the command and there will be no ill effects.</p></content-text>
</page>
<page type="OneColumn" id="en0902020503">
<content-media type="StaticGraphic" id="cm8645466049"><title><content-text></content-text></title><media ref="en0902000000/en0902020000/en0902020500/en0902020503/cm8645466049.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902020000/en0902020500/en0902020503/cm8645466049text.xml"/></content-media>
<content-text><p><b>Verifying the Serial Interface Configuration</b></p> <p>As you can see from the figure, we can determine that the line protocol is now up and verify this on both ends of the serial link by using the <span class="cmd"><b>show interfaces</b></span> and <span class="cmd"><b>show ip interface brief</b></span> commands. Remember, the serial interface will be up only if both ends of the link are configured correctly. In our lab environment, we have configured the clock rate on the end with the DCE cable.</p> <p>We can further verify that the link is up/up by pinging the remote interface.</p> <span class="cmd"><p>R1#<b>ping 172.16.2.2</b></p></span> <p>Finally, we can see the 172.16.2.0/24 serial network in the routing tables of both routers. If we issue the <span class="cmd"><b>show ip route</b></span> command on R1, we will see the directly connected route for the 172.16.2.0/24 network.</p> <span class="cmd"><p>R1#<b>show ip route</b></p></span> <p>Now take a look at router R1's running configuration by using the <span class="cmd"><b>show running-config</b></span> command. </p> <span class="cmd"><p>R1#<b>show running-config</b></p></span> <p><b>Note</b>: Although the <span class="cmd"><b>clock rate</b></span> command is two words, the IOS spells <b>clockrate </b>as a single word in the running configuration and startup configuration files.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902030000">
<title><content-text>Exploring Directly Connected Networks</content-text></title>
<topic type="" id="en0902030100">
<title><content-text>Verifying Changes to the Routing Table</content-text></title>
<page type="OneColumn" id="en0902030101">
<content-media type="StaticGraphic" id="cm8922664555"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030100/en0902030101/cm8922664555.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030100/en0902030101/cm8922664555text.xml"/></content-media>
<content-text><p><b>Routing Table Concepts</b></p> <p>As you can see in the figure, the <span class="cmd"><b>show ip route</b></span> command reveals the content of the routing table. Let's review the purpose of a routing table. A routing table is a data structure used to store routing information acquired from different sources. The main purpose of a routing table is to provide the router with paths to different destination networks. </p> <p>The routing table consists of a list of "known" network addresses - that is, those addresses that are directly connected, configured statically, and learned dynamically. R1 and R2 only have routes for directly connected networks. </p> <p> </p></content-text>
</page>
<page type="OneColumn" id="en0902030102">
<content-media type="StaticGraphic" id="cm6964272567"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030100/en0902030102/cm6964272567.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030100/en0902030102/cm6964272567text.xml"/></content-media>
<content-text><p><b>Observing Routes as They are Added to the Routing Table</b></p> <p>We will now take a closer look at how directly connected routes are added to, and deleted from, the routing table. In contrast to <span class="cmd"><b>show</b></span> commands, <span class="cmd"><b>debug</b></span> commands can be used to monitor router operations in real time. The <span class="cmd"><b>debug ip routing</b></span> command will let us see any changes that the router performs when adding or removing routes. We will configure the interfaces on the R2 router and examine this process.</p> <p>First, we will enable debugging with the <span class="cmd"><b>debug ip routing</b></span> command so that we can see the directly connected networks as they are added to the routing table.</p> <span class="cmd"><p>R2#<b>debug ip routing</b></p></span> <span class="cmd"><p>IP routing debugging is on</p></span> <p><b>Configuring the IP address and Subnet Mask</b></p> <p>Next, we will configure the IP address and subnet mask for the FastEthernet 0/0 interface on R2 and use the <span class="cmd"><b>no shutdown</b></span> command. Because the FastEthernet interface connects to the 172.16.1.0/24 network, it must be configured with a host IP address for that network.</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip address 172.16.1.1 255.255.255.0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>no shutdown</b></p></span> <p>The following message will be returned from the IOS:</p> <span class="cmd"><p>02:35:30: %LINK-3-UPDOWN: Interface FastEthernet0/0, changed state to <span class="blue">up</span></p></span> <span class="cmd"><p>02:35:31: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to <span class="blue">up</span></p></span> <p>After the <span class="cmd"><b>no shutdown</b></span> command is entered and the router determines that the interface and line protocol are in the <b>up</b> and <b>up</b> state, the debug output shows R2 adding this directly connected network to the routing table.</p> <span class="cmd"><p>02:35:30: RT: add 172.16.1.0/24 via 0.0.0.0, connected metric [0/0]</p></span> <span class="cmd"><p>02:35:30: RT: <span class="blue">interface FastEthernet0/0 added to routing table</span></p></span> <p><b>Click Routing Table 1 in the figure.</b></p> <p>The routing table now shows the route for the directly connected network 172.16.1.0/24, as seen in the figure.</p> <p>The <span class="cmd"><b>debug ip routing</b></span> command displays routing table processes for any route, whether that route is a directly connected network, a static route, or a dynamic route.</p> <p><b>Click Disable Debug in the figure.</b></p> <p>Disable <span class="cmd"><b>debug ip routing</b></span> by using either the <span class="cmd"><b>undebug ip routing</b></span> command or the <span class="cmd"><b>undebug all</b></span> command.</p> <p><b>Changing an IP Address</b></p> <p>To change an IP address or subnet mask for an interface, reconfigure the IP address and subnet mask for that interface. This change will overwrite the previous entry. There are ways to configure a single interface with multiple IP addresses, as long as each address is on a different subnet. This topic will be discussed in a later course.</p> <p>To remove a directly connected network from a router, use these two commands: <span class="cmd"><b>shutdown</b></span> and <span class="cmd"><b>no ip address</b></span>.</p> <p>The <span class="cmd"><b>shutdown</b></span> command is used to disable interfaces. This command can be used by itself if you want to retain the IP address/mask configuration on the interface but want to shut it down temporarily. In our example, this command will disable R2's FastEtherent interface. The IP address, however, will still be in the configuration file, <b>running-config</b>. </p> <p>After the <span class="cmd"><b>shutdown</b></span> command is used, you can remove the IP address and subnet mask from the interface. The order in which you perform these two commands does not matter.</p> <p><b>Click Debug 2 in the figure.</b></p> <p>Using <span class="cmd"><b>debug ip routing</b></span> we can see the routing table process, we will delete the configuration for R2's FastEthernet 0/0 interface.</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>shutdown</b></p></span> <p>We can see the routing table process removing the directly connected route.</p> <span class="cmd"><p>02:53:58: RT:<span class="blue"> interface FastEthernet0/0 removed from routing table</span></p></span> <span class="cmd"><p>02:53:58: RT: del 172.16.1.0/24 via 0.0.0.0, connected metric [0/0]</p></span> <span class="cmd"><p>02:53:58: RT: <span class="blue">delete subnet route to 172.16.1.0/24</span></p></span> <p>The IOS also indicates that the interface and line protocol are now <b>down</b>:</p> <span class="cmd"><p>02:54:00: %LINK-5-CHANGED: Interface FastEthernet0/0, changed state to administratively <span class="blue">down</span></p></span> <span class="cmd"><p>02:54:01: %LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to <span class="blue">down</span></p></span> <p> </p> <p>We will now remove the IP address on the interface.</p> <span class="cmd"><p>R2(config-if)#<b>no ip address</b></p></span> <p>Disable debugging:</p> <span class="cmd"><p>R2#<b>undebug all</b></p></span> <span class="cmd"><p>All possible debugging has been turned off</p></span> <p><b>Click Routing Table 2 in the figure.</b></p> <p>To verify that the route was removed from the routing table, we use the command <b><span class="cmd">show ip route</span></b>. Notice that the route to 172.16.1.0/24 has been removed.</p> <p><b>Reconfiguring the interface to continue with the chapter.</b></p> <p>For the purposes of the rest of this chapter, we will assume that the addressing for FastEthernet 0/0 was not removed. To reconfigure the interface, simply enter the commands again:</p> <span class="cmd"><p>R2(config)#<b>interface fastethernet 0/0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>ip address 172.16.1.1 255.255.255.0</b></p></span> <span class="cmd"><p>R2(config-if)#<b>no shutdown</b></p></span> <p><b>WARNING:</b> Debug commands, especially the <span class="cmd"><b>debug all</b></span> command, should be used sparingly. These commands can disrupt router operations. Debug commands are useful when configuring or troubleshooting a network; however, they can make intensive use of CPU and memory resources. It is recommended that you run as few debug processes as necessary and disable them immediately when they are no longer needed. Debug commands should be used with caution on production networks because they can affect the performance of the device. </p></content-text>
</page>
<page type="OneColumn" id="en0902030103">
<content-media type="ActivityPKA" id="cm1541781751"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030100/en0902030103/cm1541781751/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902030000/en0902030100/en0902030103/cm1541781751/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to practice configuring Serial interfaces. You will also use <span class="cmd"><b>debug ip routing</b></span> to observe the routing table processes.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902030200">
<title><content-text>Devices on Directly Connected Networks</content-text></title>
<page type="OneColumn" id="en0902030201">
<content-media type="InteractiveGraphicHotspots" id="cm6511590538"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030200/en0902030201/cm6511590538.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030200/en0902030201/cm6511590538text.xml"/></content-media>
<content-text><p><b>Accessing Devices on Directly Connected Networks</b></p> <p>To return to our configuration in the sample topology, we will now assume that all directly connected networks are configured for all three routers. The figure shows the rest of the configurations for routers R2 and R3.</p> <p><b>Click </b><span class="cmd"><b>show ip interface brief </b></span> <b>in the figure.</b></p> <p>The output in this figure verifies that all configured interfaces are "<b>up" </b>and "<b>up"</b>.</p> <p><b>Click </b><span class="cmd"><b>show ip route </b></span> <b>in the figure.</b></p> <p>By reviewing the routing tables in the figure, we can verify that all directly connected networks are installed for routing.</p>  <p>The crucial step in configuring your network is to verify that all the interfaces are "up" and "up" and that the routing tables are complete. Regardless of what routing scheme you ultimately configure - static, dynamic, or a combination of both - verify your initial network configurations with the <span class="cmd"><b>show ip interface brief</b></span> command and the <span class="cmd"><b>show ip route</b></span> command before proceeding with more complex configurations.</p>  <p>When a router only has its interfaces configured, and the routing table contains the directly connected networks but no other routes, only devices on those directly connected networks are reachable. </p> <ul><li> R1 can communicate with any device on the 172.16.3.0/24 and 172.16.2.0/24 networks.</li> <li> R2 can communicate with any device on the 172.16.1.0/24, 172.16.2.0/24, and 192.168.1.0/24 networks.</li> <li> R3 can communicate with any device on the 192.168.1.0/24 and 192.168.2.0/24 networks.</li></ul>  <p>Because these routers only know about their directly connected networks, the routers can only communicate with those devices on their own directly connected LANs and serial networks. </p> <p>For example, PC1 in the topology has been configured with the IP address 172.16.3.10 and the subnet mask 255.255.255.0. PC1 has also been configured with the default gateway IP address 172.16.3.1, which is the router's FastEtherent 0/0 interface IP address. Because R1 only knows about directly connected networks, it can forward packets from PC1 to devices on the 172.16.2.0/24 network, such as 172.16.2.1 and 172.16.2.2. Packets from PC1 with any other destination IP address, such as PC2 at 172.16.1.10, would be dropped by R1.</p> <p>Let's take a look at the routing table for R2 in the figure. R2 only knows about its three directly connected networks. Try to predict what will happen if we ping one of the FastEthernet interfaces on one of the other routers.</p> <p><b>Click <span class="cmd">ping</span> in the figure.</b></p> <p>Notice that the pings failed, as indicated by the series of five periods. It failed because R2 does not have a route in its routing table that matches either 172.16.3.1 or 192.168.2.1, which is the ping packet's destination IP address. To have a match between the packet's destination IP address of 172.16.3.1 and a route in the routing table, the address must match the number of left-most bits of the network address as indicated by the prefix of the route. For R2, all the routes have a /24 prefix, therefore, the left-most 24 bits are checked for each route.</p></content-text>
</page>
<page type="OneColumn" id="en0902030202">
<content-media type="AnimationPartialScreen" id="cm3706041267"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030200/en0902030202/cm3706041267.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030200/en0902030202/cm3706041267text.xml"/></content-media>
<content-text><p><b>Checking Each Route in Turn</b></p> <p>The first route in the table for R1 is 172.16.1.0/24.</p> <span class="cmd"><p>172.16.0.0/24 is subnetted, 2 subnets</p></span> <span class="cmd"><p>C 172.16.1.0 is directly connected, FastEthernet0/0</p></span> <p>The IOS routing table process checks to see if the 24 left-most bits of the packet's destination IP address, 172.16.3.1, match the 172.16.1.0/24 network. </p> <p><b>Play the first animation in the figure.</b></p> <p>If you convert these addresses to binary and compare them, as shown in the animation, you will see that the first 24 bits of this route do not match because the 23rd bit does not match. Therefore, this route is rejected.</p> <span class="cmd"><p> 172.16.0.0/<span class="blue">24 </span>is subnetted, 2 subnets</p></span> <span class="cmd"><p>C 172.16.2.0 is directly connected, Serial0/0/0</p></span> <p>In the animation, we see that the first 24 bits of the second route do not match because the 24<sup>th</sup> bit does not match. Therefore, this route is also rejected, and the process moves on to the next route in the routing table.</p> <span class="cmd"><p>C 192.168.1.0/<span class="blue">24 </span>is directly connected, Serial0/0/1</p></span> <p>The third route is also not a match. As shown, 10 of the first 24 bits do not match. Therefore, this route is rejected. Because there are no more routes in the routing table, the pings are discarded. The router makes its forwarding decision at Layer 3, a "best effort" to forward the packet, but it makes no guarantees.</p> <p><b>Click Pings are sent to R3 on the figure and play the animation.</b></p> <p>Let's look at the second animation to see what happens if the router R2 pings the 192.168.1.1 interface on router R3.</p> <p>This time the ping succeeds! It is successful because R2 has a route in its routing table that matches 192.168.1.1, which is the ping packet's destination IP address. The first two routes, 172.16.1.0/24 and 172.16.2.0/24, are rejected. But the last route, 192.168.1.0/24, matches the first 24 bits of the destination IP address. The ping packet is encapsulated in the Layer 2 HDLC protocol of Serial0/0/1, the exit interface, and forwarded via the Serial0/0/1 interface. R2 is now done making the forwarding decisions for this packet; the decisions made by other routers regarding this packet are not its concern.</p> <p><b>Note:</b> The routing table lookup process will be discussed in further detail in Chapter 8, "The Routing Table: A Closer Look."</p></content-text>
</page>
<page type="OneColumn" id="en0902030203">
<content-media type="ActivityPKA" id="cm5876133420"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030200/en0902030203/cm5876133420/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902030000/en0902030200/en0902030203/cm5876133420/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to test connectivity between directly connected devices.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902030300">
<title><content-text>Cisco Discovery Protocol (CDP)</content-text></title>
<page type="OneColumn" id="en0902030301">
<content-media type="StaticGraphic" id="cm1748284186"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030300/en0902030301/cm1748284186.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030300/en0902030301/cm1748284186text.xml"/></content-media>
<content-text><p><b>Network discovery with CDP</b></p> <p>Cisco Discovery Protocol (CDP) is a powerful network monitoring and troubleshooting tool. CDP is an information-gathering tool used by network administrators to get information about directly connected Cisco devices. CDP is a proprietary tool that enables you to access a summary of protocol and address information about Cisco devices that are directly connected. By default, each Cisco device sends periodic messages, which are known as CDP advertisements, to directly connected Cisco devices. These advertisements contain information such as the types of devices that are connected, the router interfaces they are connected to, the interfaces used to make the connections, and the model numbers of the devices.</p> <p>Most network devices, by definition, do not work in isolation. A Cisco device frequently has other Cisco devices as neighbors on the network. Information gathered from other devices can assist you in making network design decisions, troubleshooting, and making changes to equipment. CDP can be used as a network discovery tool, helping you to build a logical topology of a network when such documentation is missing or lacking in detail. </p> <p>Familiarity with the general concept of <i>neighbors</i> is important for understanding CDP as well as for future discussions about dynamic routing protocols.</p> <p><b>Layer 3 Neighbors</b></p> <p>At this point in our topology configuration, we only have directly connected neighbors. At Layer 3, routing protocols consider <i>neighbors</i> to be devices that share the same network address space. </p> <p>For example, R1 and R2 are neighbors. Both are members of the 172.16.1.0/24 network. R2 and R3 are also neighbors because they both share the 192.168.1.0/24 network. But R1 and R3 are <i>not</i> neighbors because they do not share any network address space. If we connected R1 and R3 with a cable and configured each with an IP address from the same network, then they would be neighbors.</p> <p><b>Layer 2 Neighbors</b></p> <p>CDP operates at Layer 2 only. Therefore, CDP neighbors are Cisco devices that are directly connected physically and share the same data link. In the CDP Protocol figure, the network administrator is logged in to S3. S3 will receive CDP advertisements from S1, S2, and R2 only.</p> <p>Assuming that all routers and switches in the figure are Cisco devices running CDP, what neighbors would R1 have? Can you determine the CDP neighbors for each device?</p> <p><b>Click the Topology button in the figure.</b></p> <p>In our chapter topology, we can see the following CDP neighbor relationships:</p> <ul><li> R1 and S1 are CDP neighbors.</li> <li> R1 and R2 are CDP neighbors.</li> <li> R2 and S2 are CDP neighbors.</li> <li> R2 and R3 are CDP neighbors.</li> <li> R3 and S3 are CDP neighbors.</li></ul> <p>Notice the difference between Layer 2 and Layer 3 neighbors. The switches are not neighbors to the routers at Layer 3, because the switches are operating at Layer 2 only. However, the switches are Layer 2 neighbors to their directly connected routers. </p> <p>Let's see how CDP can be helpful to a network administrator.</p></content-text>
</page>
<page type="OneColumn" id="en0902030302">
<content-media type="StaticGraphic" id="cm7540033566"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030300/en0902030302/cm7540033566.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030300/en0902030302/cm7540033566text.xml"/></content-media>
<content-text><p><b>CDP Operation</b></p> <p>Examine the output from the <span class="cmd"><b>show cdp neighbors</b></span> and <span class="cmd"><b>show cdp neighbors detail</b></span> commands in the figure. Notice that R3 has gathered some detailed information about R2 and the switch connected to the Fast Ethernet interface on R3.</p> <p>CDP runs at the Data Link layer connecting the physical media to the upper-layer protocols (ULPs). Because CDP operates at the Data Link layer, two or more Cisco network devices, such as routers that support different Network layer protocols (for example, IP and Novell <content-link target="cg7950820394" type="glossary">IPX</content-link>), can learn about each other.</p> <p>When a Cisco device boots up, CDP starts up by default. CDP automatically discovers neighboring Cisco devices running CDP, regardless of which protocol or suites are running. CDP exchanges hardware and software device information with its directly connected CDP neighbors.</p> <p>CDP provides the following information about each CDP neighbor device:</p> <ul><li> <b>Device identifiers</b> - For example, the configured host name of a switch</li> <li> <b>Address list</b> - Up to one Network layer address for each protocol supported</li> <li> <b>Port identifier</b> - The name of the local and remote port-in the form of an ASCII character string such as ethernet0</li> <li> <b>Capabilities list</b> - For example, whether this device is a router or a switch</li> <li> <b>Platform </b>- The hardware platform of the device; for example, a Cisco 7200 series router</li></ul></content-text>
</page>
<page type="OneColumn" id="en0902030303">
<content-media type="ActivityPKA" id="cm5792531794"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030300/en0902030303/cm5792531794/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902030000/en0902030300/en0902030303/cm5792531794/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to explore the features of the Cisco Discovery Protocol (CDP). Practice enabling and disabling CDP - globally and on a per-interface basis. Investigate the power of using CDP to discover the topology of a network.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902030400">
<title><content-text>Using CDP for Network Discovery</content-text></title>
<page type="OneColumn" id="en0902030401">
<content-media type="StaticGraphic" id="cm5259822858"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030400/en0902030401/cm5259822858.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902030000/en0902030400/en0902030401/cm5259822858text.xml"/></content-media>
<content-text><p><b>CDP </b><span class="cmd"><b>show </b></span><b>commands</b></p> <p>The information gathered by the CDP protocol can be examined with the <span class="cmd"><b>show cdp neighbors</b></span> command. For each CDP neighbor, the following information is displayed:</p> <ul><li> Neighbor device ID</li> <li> Local interface</li> <li> Holdtime value, in seconds </li> <li> Neighbor device capability code</li> <li> Neighbor hardware platform </li> <li> Neighbor remote port ID</li></ul> <p><b>Click <span class="cmd">show cdp neighbors detail </span> in the figure.</b></p> <p>The <span class="cmd"><b>show cdp neighbors detail</b></span> command also reveals the IP address of a neighboring device. CDP will reveal the neighbor's IP address regardless of whether or not you can ping the neighbor. This command is very helpful when two Cisco routers cannot route across their shared data link. The <span class="cmd"><b>show cdp neighbors detail</b></span> command will help determine if one of the CDP neighbors has an IP configuration error.</p> <p>For network discovery situations, knowing the IP address of the CDP neighbor is often all the information needed to telnet into that device. With an established Telnet session, information can be gathered about a neighbor's directly connected Cisco devices. In this fashion, you can telnet around a network and build a logical topology. In the next Packet Tracer Activity, you will do just that.</p> <p><b>Disabling CDP</b></p> <p>Could CDP be a security risk? Yes, it could be. You may already have seen CDP packets in your packet capturing labs from a previous course. Because some IOS versions send out CDP advertisements by default, it is important to know how to disable CDP.</p> <p><b>Click Disabling CDP in the figure.</b></p> <p>If you need to disable CDP globally, for the entire device, use this command:</p> <span class="cmd"><p>Router(config)#<b>no cdp run</b></p></span> <p>If you want to use CDP but need to stop CDP advertisements on a particular interface, use this command:</p> <span class="cmd"><p>Router(config-if)#<b>no cdp enable</b></p></span></content-text>
</page>
<page type="OneColumn" id="en0902030402">
<content-media type="ActivityPKA" id="cm3840698242"><title><content-text></content-text></title><media ref="en0902000000/en0902030000/en0902030400/en0902030402/cm3840698242/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902030000/en0902030400/en0902030402/cm3840698242/icontext.xml"/></content-media>
<content-text><p>CDP <span class="cmd"><b>show </b></span>commands can be used to discover information about unknown devices in a network. CDP <span class="cmd"><b>show </b></span>commands display information about directly connected Cisco devices, including an IP address that can be used to reach the device. You can then telnet to the device and repeat the process until the entire network is mapped. </p> <p>Use the Packet Tracer Activity to discover and map an unknown network using CDP and Telnet.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902040000">
<title><content-text>Static Routes with "Next Hop" Addresses</content-text></title>
<topic type="" id="en0902040100">
<title><content-text>Purpose and Command Syntax of ip route</content-text></title>
<page type="OneColumn" id="en0902040101">
<content-media type="StaticGraphic" id="cm3707745981"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040100/en0902040101/cm3707745981.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040100/en0902040101/cm3707745981text.xml"/></content-media>
<content-text><p><b>Purpose and Command Syntax of ip route</b></p> <p>As we have discussed previously, a router can learn about remote networks in one of two ways:</p> <ul><li> Manually, from configured static routes</li> <li> Automatically, from a dynamic routing protocol </li></ul> <p>The rest of this chapter focuses on configuring static routes. Dynamic routing protocols are introduced in the next chapter.</p> <p><b>Static routes</b></p> <p>Static routes are commonly used when routing from a network to a stub network. <b>A stub network is a network accessed by a single route.</b> For an example, see the figure. Here we see that any network attached to R1 would only have one way to reach other destinations, whether to networks attached to R2 or to destinations beyond R2. Therefore, network 172.16.3.0 is a stub network and R1 is a stub router. </p> <p>Running a routing protocol between R1 and R2 is a waste of resources because R1 has only one way out for sending non-local traffic. Therefore, static routes are configured for connectivity to remote networks that are not directly connected to a router. Again, referring to the figure, we would configure a static route on R2 to the LAN attached to R1. We will also see how to configure a default static route from R1 to R2 later in the chapter so that R1 can send traffic to any destination beyond R2.</p></content-text>
</page>
<page type="OneColumn" id="en0902040102">
<content-media type="StaticGraphic" id="cm1702038481"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040100/en0902040102/cm1702038481.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040100/en0902040102/cm1702038481text.xml"/></content-media>
<content-text><p><b>The </b><span class="cmd"><b>ip route</b></span><b> command</b></p> <p>The command for configuring a static route is <span class="cmd"><b>ip route</b></span>. The complete syntax for configuring a static route is:</p> <span class="cmd"><p>Router(config)#<b>ip route prefix mask</b> {i<i>p-address | interface-type interface-number </i>[i<i>p-address</i>]} [<i>distance</i>] [<i>name</i>] [<b>permanent</b>] [<b>tag </b>tag] </p></span> <p>Most of these parameters are not relevant for this chapter or for your CCNA studies. As shown in the figure, we will use a simpler version of the syntax:</p> <span class="cmd"><p>Router(config)#<b>ip route </b><i>network-address subnet-mask</i> {<i>ip-address</i> | <i>exit-interface </i>}</p></span> <p>The following parameters are used:</p> <ul><li> <span class="cmd"><i>network-address</i></span> - Destination network address of the remote network to be added to the routing table</li> <li> <span class="cmd"><i>subnet-mask</i></span> - Subnet mask of the remote network to be added to the routing table. The subnet mask can be modified to summarize a group of networks. </li></ul> <p>One or both of the following parameters must also be used:</p> <ul><li> <span class="cmd"><i>ip-address</i></span> - Commonly referred to as the next-hop router's IP address </li> <li> <span class="cmd"><i>exit-interface</i></span> - Outgoing interface that would be used in forwarding packets to the destination network</li></ul> <p><b>Note: </b>The <span class="cmd"><i>ip-address</i></span> parameter is commonly referred to as the "next-hop" router's IP address. The actual next-hop router's IP address is commonly used for this parameter. However, the <span class="cmd"><i>ip-address</i></span> parameter could be any IP address, as long as it is resolvable in the routing table. This is beyond the scope of this course, but we've added this point to maintain technical accuracy.</p></content-text>
</page>
</topic>
<topic type="" id="en0902040200">
<title><content-text>Configuring Static Routes</content-text></title>
<page type="OneColumn" id="en0902040201">
<content-media type="InteractiveGraphicHotspots" id="cm8293580789"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040200/en0902040201/cm8293580789.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040200/en0902040201/cm8293580789text.xml"/></content-media>
<content-text><p><b>Installing a Static Route in the Routing Table</b></p> <p>Remember R1 knows about its directly connected networks. These are the routes currently in its routing table. The remote networks that R1 does <b>not</b> know about are:</p> <ul><li> 172.16.1.0/124 - The LAN on R2</li> <li> 192.168.1.0/24 - The serial network between R2 and R3</li> <li> 192.168.2.0/24 - The LAN on R3</li></ul> <p><b>Click Static Route in the figure.</b></p> <p>First, enable <span class="cmd"><b>debug ip routing</b></span> to have the IOS display a message when the new route is added to the routing table. Then, use the <span class="cmd"><b>ip route</b></span> command to configure static routes on R1 for each of these networks. The figure shows the first route configured.</p> <span class="cmd"><p>R1#<b>debug ip routing</b></p></span> <span class="cmd"><p>R1#<b>conf t</b></p></span> <span class="cmd"><p>R1(config)#<b>ip route 172.16.1.0 255.255.255.0 172.16.2.2</b></p></span> <p>Let's examine each element in this output:</p> <ul><li> <span class="cmd"><b>ip route</b></span> - Static route command</li> <li> <span class="cmd"><b>172.16.1.0</b></span> - Network address of remote network</li> <li> <span class="cmd"><b>255.255.255.0</b></span> - Subnet mask of remote network</li> <li> <span class="cmd"><b>172.16.2.2</b></span> - Serial 0/0/0 interface IP address on R2, which is the "next-hop" to this network</li></ul> <p>When the IP address is the actual next-hop router's IP address, this IP address is reachable from one of this router's directly connected networks. In other words, the next-hop IP address <b>172.16.2.2</b> is on router R1's directly connected Serial 0/0/0 network <b>172.16.2.0/24</b>.</p> <p><b>Verifying the Static Route</b></p> <p>The output from <span class="cmd"><b>debug ip routing</b></span> shows that this route has been added to the routing table. </p> <span class="cmd"><p>00:20:15: RT: <span class="blue">add 172.16.1.0/24 via 172.16.2.2</span>, static metric [1/0]</p></span> <p>Notice in the figure that entering <span class="cmd"><b>show ip route</b></span> on R1 shows the new routing table. The static route entry is highlighted.</p> <p>Let's examine this output:</p> <ul><li> <span class="cmd"><b>S</b></span> - Routing table code for static route</li> <li> <span class="cmd"><b>172.16.1.0</b></span> - Network address for the route</li> <li><span class="cmd"><b>/24</b></span> - Subnet mask for this route; this is displayed in the line above, known as the parent route, and discussed in Chapter 8</li> <li> <span class="cmd"><b>[1/0]</b></span> - Administrative distance and metric for the static route (explained in a later chapter)</li> <li> <span class="cmd"><b>via 172.16.2.2</b></span> - IP address of the next-hop router, the IP address of R2's Serial 0/0/0 interface</li></ul> <p>Any packets with a destination IP address that have the 24 left-most bits matching <b>172.16.1.0</b> will use this route.</p></content-text>
</page>
<page type="OneColumn" id="en0902040202">
<content-media type="StaticGraphic" id="cm2247731259"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040200/en0902040202/cm2247731259.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040200/en0902040202/cm2247731259text.xml"/></content-media>
<content-text><p><b>Configuring Routes to Two More Remote Networks</b></p> <p>The commands to configure the routes for the other two remote networks are shown in the figure. Notice that all three static routes configured on R1 have the same next-hop IP address: 172.16.2.2. Using the topology diagram as a reference, we can see that this is true because packets for all of the remote networks must be forwarded to router R2, the next-hop router.</p> <p>Use the <span class="cmd"><b>show ip route</b></span> command again to examine the new static routes in the routing table, as shown.</p> <span class="cmd"><p>S 192.168.1.0/<span class="blue">24 </span>[1/0] via 172.16.2.2</p></span> <span class="cmd"><p>S 192.168.2.0/<span class="blue">24 </span>[1/0] via 172.16.2.2</p></span> <p>The /24 subnet masks are located on the same line as the network address. For now, this difference is not important. It will be explained in detail in Chapter 8, "The Routing Table: A Closer Look."</p> <p><b>Click Verify Static Route Configuration in the figure.</b></p> <p>The static routes that have been configured can also be verified by examining the running configuration with the <span class="cmd"><b>show running-config</b></span> command.</p> <p>Now is a good time to save the configuration to NVRAM:</p> <span class="cmd"><p>R1#<b>copy running-config startup-config</b></p></span></content-text>
</page>
</topic>
<topic type="" id="en0902040300">
<title><content-text>Routing Table Principles and Static Routes</content-text></title>
<page type="OneColumn" id="en0902040301">
<content-media type="StaticGraphic" id="cm5151278335"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040300/en0902040301/cm5151278335.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040300/en0902040301/cm5151278335text.xml"/></content-media>
<content-text><p><b>Routing Table Principles</b></p> <p>Now that three static routes are configured, can you predict whether packets destined for these networks will reach their destination? Will packets from all these networks destined for network 172.16.3.0/24 reach their destination? </p> <p>Let's introduce three routing table principles, as described by Alex Zinin in his book, <i>Cisco IP Routing</i>. </p> <p><b>Principle 1: "Every router makes its decision alone, based on the information it has in its own routing table."</b></p> <p>R1 has three static routes in its routing table and makes forwarding decisions based solely upon the information in the routing table. R1 does not consult the routing tables in any other routers. Nor does it know whether or not those routers have routes to other networks. Making each router aware of remote networks is the responsibility of the network administrator.</p> <p><b>Principle 2: "The fact that one router has certain information in its routing table does not mean that other routers have the same information."</b></p> <p>R1 does not know what information other routers have in their routing table. For example, R1 has a route to the 192.168.2.0/24 network through router R2. Any packets that match this route belong to the 192.168.2.0/24 network and will be forwarded to router R2. R1 does not know whether or not R2 has a route to the 192.168.2.0/24 network. Again, the network administrator would be responsible for ensuring that the next-hop router also has a route to this network.</p> <p>Using Principle 2, we still need to configure the proper routing on the other routers (R2 and R3) to make sure that they have routes to these three networks. </p> <p><b>Principle 3: "Routing information about a path from one network to another does not provide routing information about the reverse, or return path."</b></p> <p>Most of the communication over networks is bidirectional. This means that packets must travel in both directions between the end devices involved. A packet from PC1 may reach PC3 because all the routers involved have routes to the destination network 192.168.2.0/24. However, the success of any returning packets going from PC3 to PC1 depends upon whether or not the routers involved have a route to the return path, PC1's 172.16.3.0/24 network. </p> <p>Using Principle 3 as guidance, we will configure proper static routes on the other routers to make sure they have routes back to the 172.16.3.0/24 network.</p></content-text>
</page>
<page type="OneColumn" id="en0902040302">
<content-media type="InteractiveGraphicHotspots" id="cm7642174641"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040300/en0902040302/cm7642174641.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040300/en0902040302/cm7642174641text.xml"/></content-media>
<content-text><p><b>Applying the Principles</b></p> <p>With these principles in mind, how would you answer the questions we posed regarding packets that originate from PC1?</p> <p>1. Would packets from PC1 reach their destination? </p> <p>In this case, packets destined for 172.16.1.0/24 and 192.168.1.0/24 networks would reach their destination. This is because router R1 has a route to these networks through R2. When packets reach router R2, these networks are directly connected on R2 and are routed using its routing table.</p> <p>Packets destined for 192.168.2.0/24 network would not reach their destination. R1 has a static route to this network through R2. However, when R2 receives a packet, it will drop it because R2 does not yet contain a route for this network in its routing table.</p> <p>2. Does this mean that any packets from these networks destined for 172.16.3.0/24 network will reach their destination?</p> <p>If R2 or R3 receives a packet destined for 172.16.3.0/24, the packet will not reach its destination, because neither router has a route to the 172.16.3.0/24 network.</p> <p><b>Click R2 and R3 Static Routes in the figure.</b></p> <p>With the commands shown in the figure, all routers now have routes to all remote networks. </p> <p><b>Click </b><span class="cmd"><b>show ip route</b></span><b> in the figure.</b></p> <p>Examine the routing tables in the figure to verify that all routers now have routes to all remote networks.</p> <p><b>Click </b><span class="cmd"><b>ping </b></span><b>in the figure.</b></p> <p>Connectivity can be further verified by pinging remote router interfaces from router R1, as shown in the figure.</p> <p>Full connectivity is now achieved for the devices in our topology. Any PC, on any LAN, can now access PCs on all other LANs.</p></content-text>
</page>
</topic>
<topic type="" id="en0902040400">
<title><content-text>Resolving to an Exit Interface</content-text></title>
<page type="OneColumn" id="en0902040401">
<content-media type="StaticGraphic" id="cm8459832998"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040400/en0902040401/cm8459832998.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040400/en0902040401/cm8459832998text.xml"/></content-media>
<content-text><p><b>Recursive Route Lookup</b></p> <p>Before any packet is forwarded by a router, the routing table process must determine the exit interface to use to forward the packet. This is known as route resolvability. Let's examine this process by looking at the routing table for R1 in the figure. R1 has a static route for the remote network 192.168.2.0/24, which forwards all packets to the next-hop IP address 172.16.2.2. </p> <span class="cmd"><p><b>S 192.168.2.0/24 [1/0] via 172.16.2.2</b></p></span> <p>Finding a route is only the first step in the lookup process. R1 must determine how to reach the next-hop IP address 172.16.2.2. It will do a second search looking for a match for 172.16.2.2. In this case, the IP address 172.16.2.2 matches the route for the directly connected network 17216.2.0/24. </p> <span class="cmd"><p><b>C 172.16.2.0 is directly connected, Serial0/0/0</b></p></span> <p>The 172.16.2.0 route is a directly connected network with the exit interface Serial 0/0/0. This lookup tells the routing table process that this packet will be forwarded out that interface. Therefore, it actually takes two routing table lookup processes to forward any packet to the 192.168.2.0/24 network. When the router has to perform multiple lookups in the routing table before forwarding a packet, it is performing a process known as a <i>recursive lookup</i>. In this example:</p> <p>1. The packet's destination IP address is matched to the static route 192.168.2.0/24 with the next-hop IP address 172.16.2.2.</p> <p>2. The next-hop IP address of the static route, 172.16.2.2, is matched to the directly connected network 172.16.2.0/24 with the exit interface of Serial 0/0/0.</p>  <p>Every route that references only a next-hop IP address, and does not reference an exit-interface, must have the next-hop IP address resolved using another route in the routing table that has an exit interface. </p> <p>Typically, these routes are resolved to routes in the routing table that are directly connected networks, because these entries will always contain an exit interface. We will see in the next section that static routes can be configured with an exit interface. This means that they do not need to be resolve using another route entry.</p></content-text>
</page>
<page type="OneColumn" id="en0902040402">
<content-media type="StaticGraphic" id="cm6416309300"><title><content-text></content-text></title><media ref="en0902000000/en0902040000/en0902040400/en0902040402/cm6416309300.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902040000/en0902040400/en0902040402/cm6416309300text.xml"/></content-media>
<content-text><p><b>Exit Interface is Down</b></p> <p>Let's consider what would happen if an exit interface goes down. For example, what would happen to R1's static route to 192.16.2.0/24 if its Serial 0/0/0 interface went down? If the static route cannot be resolved to an exit interface, in this case Serial 0/0/0, the static route is removed from the routing table. </p> <p>Examine this process with <span class="cmd"><b>debug ip routing</b></span> on R1 and then configure the Serial 0/0/0 to <span class="cmd"><b>shutdown</b></span>, as shown. </p> <p>Notice from the debug output that all three static routes were deleted when the Serial 0/0/0 interface was shut down. They were deleted because all three static routes were resolved to Serial 0/0/0. However, the static routes are still in the R1's running configuration. If the interface comes back up (is enabled again with <span class="cmd"><b>no shutdown</b></span>), the IOS routing table process will reinstall these static routes back into the routing table. </p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902050000">
<title><content-text>Static Routes with Exit Interfaces</content-text></title>
<topic type="" id="en0902050100">
<title><content-text>Configuring a Static Route with an Exit Interface</content-text></title>
<page type="OneColumn" id="en0902050101">
<content-media type="StaticGraphic" id="cm9764670292"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050100/en0902050101/cm9764670292.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902050000/en0902050100/en0902050101/cm9764670292text.xml"/></content-media>
<content-text><p><b>Configuring a Static Route with an Exit Interface</b></p> <p>Let's investigate another way to configure the same static routes. Currently, R1's static route for the 192.168.2.0/24 network is configured with the next-hop IP address of 172.16.2.2. In the running configuration, note the following line: </p> <span class="cmd"><p><b>ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>As you will recall from the previous section, this static route requires a second routing table lookup to resolve the 172.16.2.2 next-hop IP address to an exit interface. However, most static routes can be configured with an exit interface, which allows the routing table to resolve the exit interface in a single search instead of two searches. </p></content-text>
</page>
<page type="OneColumn" id="en0902050102">
<content-media type="StaticGraphic" id="cm8438402046"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050100/en0902050102/cm8438402046.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902050000/en0902050100/en0902050102/cm8438402046text.xml"/></content-media>
<content-text><p><b>Static Route and an Exit Interface</b></p> <p>Let's reconfigure this static route to use an exit interface instead of a next-hop IP address. The first thing to do is to delete the current static route. This is done using the <span class="cmd"><b>no ip route</b></span> command as shown in the figure.</p> <p>Next, configure R1's static route to <b>192.168.2.0/24</b> using the exit interface Serial 0/0/0</p> <p>Then use the <span class="cmd"><b>show ip route</b></span> command to examine the change in the routing table. Notice that the entry in the routing table no longer refers to the next-hop IP address but refers directly to the exit interface. This exit interface is the same one that the static route was resolved to when it used the next-hop IP address. </p> <span class="cmd"><p><b>S 192.168.2.0/24 </b><b><span class="blue">is directly connected, Serial0/0/0</span></b></p></span> <p>Now, when the routing table process has a match for a packet and this static route, it will be able to resolve the route to an exit interface in a single lookup. As you can see in the figure, the other two static routes still must be processed in two steps, resolving to the same Serial 0/0/0 interface.</p> <p><b>Note: </b>The static route displays the route as <b>directly connected</b>. It is important to understand that this does not mean that this route is a directly connected network or directly connected route. This route is still a static route. We will examine the importance of this fact when we discuss Administrative Distances in the next chapter. We will learn that this type of static route still has an Administrative Distance of "1". For now, just note that this route is still a static route with an administrative distance of "1" and is not a directly connected network.</p> <p><b>Static routes and point-to-point networks</b></p> <p>Static routes that are configured with exit interfaces instead of next-hop IP addresses are ideal for most serial point-to-point networks. Point-to-point networks that use protocols such as HDLC and PPP do not use the next-hop IP address in the packet forwarding process. The routed IP packet is encapsulated in an HDLC Layer 2 frame with a broadcast Layer 2 destination address. </p> <p>These types of point-to-point serial links are like pipes. A pipe has only two ends. What enters one end can only have a single destination - the other end of the pipe. Any packets that are sent via R1's Serial 0/0/0 interface can only have one destination: R2's Serial 0/0/0 interface. R2's serial interface happens to be the IP address 172.16.2.2. </p> <p><b>Note:</b> Under certain conditions, the network administrator will not want to configure the static route with an exit interface but with the next-hop IP address. This type of situation is beyond the scope of this course but is important to note.</p></content-text>
</page>
</topic>
<topic type="" id="en0902050200">
<title><content-text>Modifying Static Routes</content-text></title>
<page type="OneColumn" id="en0902050201">
<content-media type="StaticGraphic" id="cm4808586953"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050200/en0902050201/cm4808586953.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902050000/en0902050200/en0902050201/cm4808586953text.xml"/></content-media>
<content-text><p><b>Modifying Static Routes</b></p> <p>There are times when a previously configured static route needs to be modified:</p> <ul><li> The destination network no longer exists, and therefore the static route should be deleted.</li> <li> There is a change in the topology, and either the intermediate address or the exit interface has to be changed. </li></ul> <p>There is no way to modify an existing static route. The static route must be deleted and a new one configured. </p> <p>To delete a static route, add <span class="cmd"><b>no </b></span>in front of the <span class="cmd"><b>ip route</b></span> command, followed by the rest of the static route to be removed.</p> <p>In the previous section, we had a static route:</p> <span class="cmd"><p><b>ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>We can delete that static route with the <span class="cmd"><b>no ip route</b></span> command:</p> <span class="cmd"><p><b>no ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>As you will recall, we deleted the static route because we wanted to modify it to use an exit interface instead of a next-hop IP address. We configured a new static route using the exit interface:</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 </b><b><span class="blue">serial 0/0/0</span></b></p></span> <p>It is more efficient for the routing table lookup process to have static routes with exit interfaces - at least for serial point-to-point outbound networks. Let's reconfigure the rest of the static routes on R1, R2, and R3 to use exit interfaces.</p> <p>As you can see in the figure, as we delete each route, we will configure a new route to the same network using an exit interface.</p></content-text>
</page>
</topic>
<topic type="" id="en0902050300">
<title><content-text>Verifying the Static Route Configuration</content-text></title>
<page type="OneColumn" id="en0902050301">
<content-media type="InteractiveGraphicHotspots" id="cm5446374560"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050300/en0902050301/cm5446374560.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902050000/en0902050300/en0902050301/cm5446374560text.xml"/></content-media>
<content-text><p><b>Verifying the Static Route Configuration</b></p> <p>Whenever changes are made to static routes - or to other aspects of the network - verify that the changes took effect and that they produce the desired results.</p> <p><b>Verifying Static Route Changes</b></p> <p>In the previous section, we deleted and reconfigured the static routes for all three routers. Remember, the running configuration contains the current router configuration - the commands and parameters that the router is currently using. Verify your changes by examining the running configuration. The figure shows the portions of each router's running configuration that show the current static route.</p> <p><b>Click </b><span class="cmd"><b>show ip route</b></span><b> in the figure.</b></p> <p>This figure shows the routing table for all three routers. Notice that static routes with exit interfaces have been added to the routing table and that the previous static routes with next-hop addresses have been deleted.</p> <p><b>Click </b><span class="cmd"><b>ping</b></span><b> in the figure.</b></p> <p>The ultimate test is to route packets from source to destination. Using the <span class="cmd"><b>ping</b></span> command, we can test that packets from each router are reaching their destination and that the return path is also working properly. This figure shows successful ping outputs.</p></content-text>
</page>
<page type="OneColumn" id="en0902050302">
<content-media type="ActivityPKA" id="cm9988989788"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050300/en0902050302/cm9988989788/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902050000/en0902050300/en0902050302/cm9988989788/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to practice removing static routes and reconfiguring static routes using the exit interface argument. Then verify the new configuration and test connectivity.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902050400">
<title><content-text>Static Routes with Ethernet Interfaces</content-text></title>
<page type="OneColumn" id="en0902050401">
<content-media type="StaticGraphic" id="cm9316366598"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050400/en0902050401/cm9316366598.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902050000/en0902050400/en0902050401/cm9316366598text.xml"/></content-media>
<content-text><p><b>Ethernet Interfaces and ARP</b></p> <p>Sometimes the exit interface is an Ethernet network. </p> <p>Suppose that the network link between R1 and R2 is an Ethernet link and that the FastEthernet 0/1 interface of R1 is connected to that network, as shown in the figure. A static route, using a next-hop IP address for the 192.168.2.0/24 network, can be set using this command:</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 172.16.2.2</b></p></span> <p>As discussed in the previous section "Configuring an Ethernet interface", the IP packet must be encapsulated into an Ethernet frame with an Ethernet destination MAC address. If the packet should be sent to a next-hop router, the destination MAC address will be the address of the next-hop router's Ethernet interface. In this case, the Ethernet destination MAC address will be matched to the next-hop IP address 172.16.2.2. R1 checks its FastEthernet 0/1 ARP table for an entry with 172.16.2.2 and a corresponding MAC address. </p> <p><b>Sending an ARP Request</b></p> <p>If this entry is not in the ARP table, R1 sends an ARP request via its FastEthernet 0/1 interface. The Layer 2 broadcast is requesting that if any device has the IP address 172.16.2.2, it should respond with its MAC address. Because R2's FastEthernet 0/1 interface has the IP address 172.16.2.2, it sends back an ARP reply with the MAC address for that interface.</p> <p>R1 receives the ARP reply and adds the 172.16.2.2 IP address, and the associated MAC address, to its ARP table. The IP packet is now encapsulated into an Ethernet frame with the destination MAC address found in the ARP table. The Ethernet frame with the encapsulated packet is then sent out the FastEthernet 0/1 interface to router R2.</p></content-text>
</page>
<page type="OneColumn" id="en0902050402">
<content-media type="StaticGraphic" id="cm4941855589"><title><content-text></content-text></title><media ref="en0902000000/en0902050000/en0902050400/en0902050402/cm4941855589.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902050000/en0902050400/en0902050402/cm4941855589text.xml"/></content-media>
<content-text><p><b>Static routes and Ethernet exit interfaces</b></p> <p>Let's configure a static route with an Ethernet exit interface instead of a next-hop IP address. Change the static route for 192.168.2.0/24 to use an exit interface with this command:</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 fastethernet 0/1</b></p></span> <p>The difference between an Ethernet network and a point-to-point serial network is that a point-to-point network has only one other device on that network - the router at the other end of the link. With Ethernet networks, there may be many different devices sharing the same multi-access network, including hosts and even multiple routers. By only designating the Ethernet exit interface in the static route, the router will not have sufficient information to determine which device is the next-hop device. </p> <p>R1 knows that the packet needs to be encapsulated in an Ethernet frame and sent out the FastEthernet 0/1 interface. However, R1 does not know the next-hop IP address and therefore it cannot determine the destination MAC address for the Ethernet frame.</p> <p>Depending upon the topology and the configurations on other routers, this static route may or may not work. We will not go into the details here, but it is recommended that when the exit interface is an Ethernet network, you do not use only the exit interface in the static route. </p> <p>One might ask: Is there any way to configure a static route over an Ethernet network so that it does not have to use the recursive lookup of the next-hop IP address? Yes - this can be done by configuring the static route to include both the exit interface and the next-hop IP address. </p> <p>As you can see in the figure, the exit interface would be FastEthernet 0/1 and the next-hop IP address would be 172.16.2.2.</p> <span class="cmd"><p>R1(config)#<b>ip route 192.168.2.0 255.255.255.0 fastethernet 0/1 172.16.2.2</b></p></span> <p>The routing table entry for this route would be:</p> <span class="cmd"><p><b>S 192.168.2.0/24 [1/0] via 172.16.2.2 FastEthernet0/1</b></p></span> <p>The routing table process will only need to perform a single lookup to get both the exit interface and the next-hop IP address.</p> <p><b>Advantages of using an exit interface with static routes</b></p> <p>There is an advantage to utilizing exit interfaces in static routes for both serial point-to-point and Ethernet outbound networks. The routing table process only has to perform a single lookup to find the exit interface instead of a second lookup to resolve a next-hop address.</p> <p>For static routes with outbound point-to-point serial networks, it is best to configure static routes with only the exit interface. For point-to-point serial interfaces, the next-hop address in the routing table is never used by the packet delivery procedure, and so it is not needed. </p> <p>For static routes with outbound Ethernet networks, it is best to configure the static routes with both the next-hop address and the exit-interface.</p> <p><b>Note: </b>For more information about the issues that can occur with static routes that only use an Ethernet or FastEthernet exit interface, see the book <i>Cisco IP Routing</i>, by Alex Zinin.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902060000">
<title><content-text>Summary and Default Static Routes</content-text></title>
<topic type="" id="en0902060100">
<title><content-text>Summary Static Routes</content-text></title>
<page type="OneColumn" id="en0902060101">
<content-media type="InteractiveGraphicHotspots" id="cm8063643556"><title><content-text></content-text></title><media ref="en0902000000/en0902060000/en0902060100/en0902060101/cm8063643556.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902060000/en0902060100/en0902060101/cm8063643556text.xml"/></content-media>
<content-text><p><b>Summarizing Routes to Reduce the Size of the Routing Table</b></p> <p>Creating smaller routing tables makes the routing table lookup process more efficient, because there are fewer routes to search. If one static route can be used instead of multiple static routes, the size of the routing table will be reduced. In many cases, a single static route can be used to represent dozens, hundreds, or even thousands of routes.</p> <p>We can use a single network address to represent multiple subnets. For example, the networks 10.0.0.0/16, 10.1.0.0/16, 10.2.0.0/16, 10.3.0.0/16, 10.4.0.0/16, 10.5.0.0/16, all the way through 10.255.0.0/16 can be represented by a single network address: 10.0.0.0/8.</p> <p><b>Route Summarization</b></p> <p>Multiple static routes can be summarized into a single static route if:</p> <ul><li> The destination networks can be summarized into a single network address, and </li> <li> The multiple static routes all use the same exit-interface or next-hop IP address </li></ul> <p>This is called <content-link target="cg3862210443" type="glossary">route summarization</content-link>.</p> <p>In our example, R3 has three static routes. All three routes are forwarding traffic out the same Serial0/0/1 interface. The three static routes on R3 are:</p> <span class="cmd"><p><b>ip route 172.16.1.0 255.255.255.0 Serial0/0/1</b></p></span> <span class="cmd"><p><b>ip route 172.16.2.0 255.255.255.0 Serial0/0/1</b></p></span> <span class="cmd"><p><b>ip route 172.16.3.0 255.255.255.0 Serial0/0/1</b></p></span> <p>If possible, we would like to summarize all of these routes into a single static route. 172.16.1.0/24, 172.16.2.0/24 and 172.16.3.0/24 can be summarized to the 172.16.0.0/22 network. Because all three routes use the same exit interface, they can be summarized to the single 172.16.0.0 255.255.252.0 network, and we can create a single summary route.</p> <p><b>Calculating a summary route</b></p> <p>Here's the process of creating the summary route 172.16.1.0/22, as shown in the figure:</p> <p>1. Write out the networks that you want to summarize in binary. </p> <p>2. To find the subnet mask for summarization, start with the left-most bit. </p> <p>3. Work your way to the right, finding all the bits that match consecutively.</p> <p>4. When you find a column of bits that do <i>not</i> match, stop. You are at the summary boundary. </p> <p>5. Now, count the number of left-most matching bits, which in our example is 22. This number becomes your subnet mask for the summarized route, /22 or 255.255.252.0</p> <p>6. To find the network address for summarization, copy the matching 22 bits and add all 0 bits to the end to make 32 bits.</p> <p>By following these steps, we can discover that the three static routes on R3 can be summarized into a single static route, using the summary network address of 172.16.0.0 255.255.252.0:</p> <span class="cmd"><p><b>ip route 172.16.0.0 255.255.252.0 Serial0/0/1</b></p></span> <p></p></content-text>
</page>
<page type="OneColumn" id="en0902060102">
<content-media type="InteractiveGraphicHotspots" id="cm8842667530"><title><content-text></content-text></title><media ref="en0902000000/en0902060000/en0902060100/en0902060102/cm8842667530.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902060000/en0902060100/en0902060102/cm8842667530text.xml"/></content-media>
<content-text><p><b>Configuring a <content-link target="cg7394034673" type="glossary">Summary Route</content-link></b></p> <p>To implement the summary route, we must first delete the three current static routes:</p> <span class="cmd"><p>R3(config)#<b>no ip route 172.16.1.0 255.255.255.0 serial0/0/1</b></p></span> <span class="cmd"><p>R3(config)#<b>no ip route 172.16.2.0 255.255.255.0 serial0/0/1</b></p></span> <span class="cmd"><p>R3(config)#<b>no ip route 172.16.3.0 255.255.255.0 serial0/0/1</b></p></span> <p>Next, we will configure the summary static route:</p> <span class="cmd"><p>R3(config)#<b>ip route 172.16.0.0 255.255.252.0 serial0/0/1</b></p></span> <p><b>Click Effect of Summary Route in the figure.</b></p> <p>To verify the new static route, examine R3's routing table with the <span class="cmd">show ip route</span> command, as shown:</p> <span class="cmd"><p>172.16.0.0/<span class="blue">22 </span>is subnetted, 1 subnets</p></span> <span class="cmd"><p><span class="blue">S 172.16.0.0 is directly connected, Serial0/0/1</span></p></span> <p>With this summary route, the destination IP address of a packet only needs to match the left-most 22 bits of the 172.16.0.0 network address. Any packet with a destination IP address belonging to the 172.16.1.0/24, 172.16.2.0/24, or 172.16.3.0/24 network matches this summarized route.</p> <p><b>Click Verify Summary Route in the figure.</b></p> <p>As you can see in the figure, we can test the reconfiguration using the <span class="cmd"><b>ping </b></span>command. We verify that we still have proper connectivity throughout the network.</p> <p><b>Note:</b> As of March 2007, there are over 200,000 routes in the Internet core routers. Most of these are summarized routes.</p></content-text>
</page>
</topic>
<topic type="" id="en0902060200">
<title><content-text>Default Static Route</content-text></title>
<page type="OneColumn" id="en0902060201">
<content-media type="StaticGraphic" id="cm7376673512"><title><content-text></content-text></title><media ref="en0902000000/en0902060000/en0902060200/en0902060201/cm7376673512.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902060000/en0902060200/en0902060201/cm7376673512text.xml"/></content-media>
<content-text><p><b>Most Specific Match</b></p> <p>It is possible that the destination IP address of a packet will match multiple routes in the routing table. For example, what if we had the following two static routes in the routing table:</p> <span class="cmd"><p>172.16.0.0/<span class="blue">24 </span>is subnetted, 3 subnets</p></span> <span class="cmd"><p><span class="blue">S 172.16.1.0</span> is directly connected, Serial0/0/0 and</p></span> <span class="cmd"><p><span class="blue">S 172.16.0.0/16</span> is directly connected, Serial0/0/1</p></span> <p>Consider a packet with the destination IP address 172.16.1.10. This IP address matches both routes. The routing table lookup process will use the most-specific match. Because 24 bits match the 172.16.1.0/24 route, and only 16 bits of the 172.16.0.0/16 route match, the static route with the 24 bit match will be used. This is the longest match. The packet will then be encapsulated in a Layer 2 frame and sent via the Serial 0/0/0 interface. Remember, the subnet mask in the route entry is what determines how many bits must match the packet's destination IP address for this route to be a match.</p> <p><b>Note:</b> This process is the same for all routes in the routing table including static routes, routes learned from a routing protocol and directly connected networks. The routing table lookup process will be explained in more detail in a later chapter.</p> <p>The default static route matches all packets</p> <p>A default static route is a route that will match all packets. Default static routes are used:</p> <ul><li> When no other routes in the routing table match the packet's destination IP address. In other words, when a more specific match does not exist. A common use is when connecting a company's edge router to the ISP network.</li> <li> When a router has only one other router to which it is connected. This condition is known as a stub router. </li></ul> <p><b>Configuring a Default Static Route</b></p> <p>The syntax for a default static route is similar to any other static route, except that the network address is 0.0.0.0 and the subnet mask is 0.0.0.0:</p> <span class="cmd"><p>Router(config)#<b>ip route 0.0.0.0 0.0.0.0</b> [<b>exit-interface</b> | <b>ip-address</b> ]</p></span> <p>The <span class="cmd">0.0.0.0 0.0.0.0</span> network address and mask is called a "quad-zero" route. </p> <p>R1 is a stub router. It is only connected to R2. Currently R1 has three static routes, which are used to reach all of the remote networks in our topology. All three static routes have the exit interface Serial 0/0/0, forwarding packets to the next-hop router R2. </p> <p>The three static routes on R1 are:</p> <span class="cmd"><p><b>ip route 172.16.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p><b>ip route 192.168.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p><b>ip route 192.168.2.0 255.255.255.0 serial 0/0/0</b></p></span> <p>R1 is an ideal candidate to have all of its static routes replaced by a single default route. First, delete the three static routes:</p> <span class="cmd"><p>R1(config)#<b>no ip route 172.16.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config)#<b>no ip route 192.168.1.0 255.255.255.0 serial 0/0/0</b></p></span> <span class="cmd"><p>R1(config)#<b>no ip route 192.168.2.0 255.255.255.0 serial 0/0/0</b></p></span> <p>Next, configure the single default static route using the same Serial 0/0/0 exit interface as the three previous static routes:</p> <span class="cmd"><p>R1(config)#<b>ip route 0.0.0.0 0.0.0.0 serial 0/0/0</b></p></span></content-text>
</page>
<page type="OneColumn" id="en0902060202">
<content-media type="StaticGraphic" id="cm5763692333"><title><content-text></content-text></title><media ref="en0902000000/en0902060000/en0902060200/en0902060202/cm5763692333.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902060000/en0902060200/en0902060202/cm5763692333text.xml"/></content-media>
<content-text><p><b>Verifying a Default Static Route</b></p> <p>Verify the change to the routing table with the <span class="cmd">show ip route</span> command, as shown in the Figure:</p> <span class="cmd"><p><b>S* 0.0.0.0/0 is directly connected, Serial0/0/0</b></p></span> <p>Note the <b>*</b> or asterisk next to the <b>S</b>. As you can see from the <b>Codes</b> table in the figure, the asterisk indicates that this static route is a <b>candidate default</b> route. That is why it is called a "default static" route. We will see in later chapters that a "default" route does not always have to be a "static" route. </p> <p>The key to this configuration is the <span class="cmd"> <b>/0</b></span> mask. We previously said that it is the subnet mask in the routing table that determines how many bits must match between the destination IP address of the packet and the route in the routing table. A /0 mask indicates that zero or no bits are needed to match. As long as a more specific match doesn't exist, the default static route will match all packets.</p> <p><b>Default routes are very common on routers.</b> Instead of routers having to store routes for all of the networks in the Internet, they can store a single default route to represent any network that is not in the routing table. This topic will be discussed in more detail when we discuss dynamic routing protocols. </p></content-text>
</page>
<page type="OneColumn" id="en0902060203">
<content-media type="ActivityPKA" id="cm4520039658"><title><content-text></content-text></title><media ref="en0902000000/en0902060000/en0902060200/en0902060203/cm4520039658/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902060000/en0902060200/en0902060203/cm4520039658/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to practice configuring summary routes and default routes. Then verify the new configuration by testing for connectivity.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902070000">
<title><content-text>Managing and Troubleshooting Static Routes</content-text></title>
<topic type="" id="en0902070100">
<title><content-text>Static Routes and Packet Forwarding</content-text></title>
<page type="OneColumn" id="en0902070101">
<content-media type="AnimationPartialScreen" id="cm4895681103"><title><content-text></content-text></title><media ref="en0902000000/en0902070000/en0902070100/en0902070101/cm4895681103.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902070000/en0902070100/en0902070101/cm4895681103text.xml"/></content-media>
<content-text><p><b>Static Routes and Packet Forwarding</b></p> <p>The following is an example of the packet forwarding process with static routes. As you can see in the animation, PC1 is sending a packet to PC3:</p> <p>1. The packet arrives on the FastEthernet 0/0 interface of R1.</p> <p>2. R1 does not have a specific route to the destination network, 192.168.2.0/24; therefore, R1 uses the default static route.</p> <p>3. R1 encapsulates the packet in a new frame. Because the link to R2 is a point-to-point link, R1 adds an "all 1s" address for the Layer 2 destination address.</p> <p>4. The frame is forwarded out the serial 0/0/0 interface. The packet arrives on the Serial 0/0/0 interface on R2.</p> <p>5. R2 decapsulates the frame and looks for a route to the destination. R2 has a static route to 192.168.2.0/24 out Serial0/0/1.</p> <p>6. R2 encapsulates the packet in a new frame. Because the link to R3 is a point-to-point link, R2 adds an "all 1s" address for the Layer 2 destination address.</p> <p>7. The frame is forwarded out the Serial0/0/1 interface. The packet arrives on the Serial0/0/1 interface on R3.</p> <p>8. R3 decapsulates the frame and looks for a route to the destination. R3 has a connected route to 192.168.2.0/24 out FastEthernet 0/1.</p> <p>9. R3 looks up the ARP table entry for 192.168.2.10 to find the Layer 2 MAC address for PC3.</p> <p> a. If no entry exists, R3 sends an ARP request out FastEthernet 0/0.</p> <p> b. PC3 responds with an ARP reply which includes the PC3 MAC address.</p> <p>10. R3 encapsulates the packet in a new frame with the MAC address of interface FastEthernet 0/0 as the source Layer 2 address and the MAC address of PC3 as the destination MAC address.</p> <p>11. The frame is forwarded out the FastEthernet 0/0 interface. The packet arrives on the NIC interface of PC3.</p> <p>This process is no different from the process demonstrated in Chapter 1. As was explained in Chapter 1, you must be able to describe this process in detail. Knowing how a router performs its two basic functions-path determination and packet forwarding - is fundamental to all routing discussions. In Lab 2.8.1, "Basic Static Route Configuration," you have an opportunity to demonstrate your knowledge of the path determination and packet forwarding process.</p></content-text>
</page>
</topic>
<topic type="" id="en0902070200">
<title><content-text>Troubleshooting a Missing Route</content-text></title>
<page type="OneColumn" id="en0902070201">
<content-media type="StaticGraphic" id="cm1421063275"><title><content-text></content-text></title><media ref="en0902000000/en0902070000/en0902070200/en0902070201/cm1421063275.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902070000/en0902070200/en0902070201/cm1421063275text.xml"/></content-media>
<content-text><p><b>Troubleshooting a Missing Route</b></p> <p>Networks are subject to many different forces that can cause their status to change quite often:</p> <ul><li> An interface fails. </li> <li> A service provider drops a connection.</li> <li> There is an over-saturation of links.</li> <li> An administrator enters a wrong configuration.</li></ul> <p>When there is a change in the network, connectivity may be lost. As a network administrator, you are the one responsible for pinpointing and solving the problem.</p> <p>What steps can you take? </p> <p>By now, you should be very familiar with some tools that can help you isolate routing problems. Listed in the figure, they include: </p> <span class="cmd"><p><b>ping</b></p></span> <span class="cmd"><p><b>traceroute</b></p></span> <span class="cmd"><p><b>show ip route</b></p></span> <p>Although we have not used traceroute yet in this course, you should be very familiar with its capabilities from previous studies. Recall that traceroute commands will find a break in the path from source to destination. </p> <p>As we go further into this course, you will discover more tools. For example, <span class="cmd"><b>show ip interface brief</b></span> gives you a quick summary of interface status. CDP can help you gather information about the IP configuration of a directly connected Cisco device using the <span class="cmd"><b>show cdp neighbors detail</b></span> command.</p></content-text>
</page>
</topic>
<topic type="" id="en0902070300">
<title><content-text>Solving the Missing Route</content-text></title>
<page type="OneColumn" id="en0902070301">
<content-media type="AnimationPartialScreen" id="cm8455311047"><title><content-text></content-text></title><media ref="en0902000000/en0902070000/en0902070300/en0902070301/cm8455311047.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902070000/en0902070300/en0902070301/cm8455311047text.xml"/></content-media>
<content-text><p><b>Solving the Missing Route</b></p> <p>Finding a missing (or misconfigured) route is relatively straightforward if you methodically use the correct tools. </p> <p>Consider this problem: PC1 cannot ping PC3. A traceroute reveals that R2 is responding but that there is no response from R3. Displaying the routing table on R2 reveals that the 172.16.3.0/24 network is configured incorrectly. The exit interface is configured to send packets to R3. Obviously, from the topology, we can see that R1 has the 172.16.3.0/24 network. Therefore, R2 must use Serial 0/0/0 as the exit interface - not Serial0/0/1. </p> <p>To remedy the situation, remove the incorrect route and add the route for network 172.16.3.0/24 with the Serial 0/0/0 specified as the exit interface.</p> <span class="cmd"><p>R2(config)#<b>no ip route 172.16.3.0 255.255.255.0 serial0/0/1</b></p></span> <span class="cmd"><p>R2(config)#<b>ip route 172.16.3.0 255.255.255.0 serial 0/0/0</b></p></span></content-text>
</page>
<page type="OneColumn" id="en0902070302">
<content-media type="ActivityPKA" id="cm7418519817"><title><content-text></content-text></title><media ref="en0902000000/en0902070000/en0902070300/en0902070302/cm7418519817/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902070000/en0902070300/en0902070302/cm7418519817/icontext.xml"/></content-media>
<content-text><p>Use the Packet Tracer Activity to see how the loop explained in this section can occur. In Simulation mode, watch as R2 and R3 loop a packet for 172.16.3.10 until the TTL field reaches zero. Then fix the problem and test for connectivity between PC1 and PC3.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en0902080000">
<title><content-text>Static Route Configuration Labs</content-text></title>
<topic type="" id="en0902080100">
<title><content-text>Basic Static Route Configuration</content-text></title>
<page type="OneColumn" id="en0902080101">
<content-media type="ActivityLab" id="cm6056393233"><title><content-text></content-text></title><media ref="en0902000000/en0902080000/en0902080100/en0902080101/cm6056393233/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902080000/en0902080100/en0902080101/cm6056393233/icontext.xml"/></content-media>
<content-text><p>In this lab activity, you will create a network like the one used in this chapter. You will cable the network and perform the initial router configurations required for connectivity. After completing the basic configuration, you will test connectivity between the devices on the network. You will then configure the static routes that are needed to allow communication between the hosts. </p><p><b>Click the lab icon for more details</b></p></content-text>
</page>
<page type="OneColumn" id="en0902080102">
<content-media type="ActivityPKA" id="cm2782798220"><title><content-text></content-text></title><media ref="en0902000000/en0902080000/en0902080100/en0902080102/cm2782798220/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902080000/en0902080100/en0902080102/cm2782798220/icontext.xml"/></content-media>
<content-text><p>Use this Packet Tracer Activity to repeat a simulation of Lab 2.8.1. Remember, however, that Packet Tracer is not a substitute for a hands-on lab experience with real equipment. </p> <p>A summary of the instructions is provided within the activity. Use the Lab PDF for more details.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902080200">
<title><content-text>Challenge Static Route Configuration</content-text></title>
<page type="OneColumn" id="en0902080201">
<content-media type="ActivityLab" id="cm9282976089"><title><content-text></content-text></title><media ref="en0902000000/en0902080000/en0902080200/en0902080201/cm9282976089/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902080000/en0902080200/en0902080201/cm9282976089/icontext.xml"/></content-media>
<content-text><p>In this lab activity, you will be given a network address that must be subnetted to complete the addressing of the network. The addressing for the LAN connected to the ISP router and the link between the HQ and ISP routers has already been completed. Static routes will also need to be configured so that hosts on networks that are not directly connected will be able to communicate with each other.</p><p><b>Click the lab icon for more details</b></p></content-text>
</page>
<page type="OneColumn" id="en0902080202">
<content-media type="ActivityPKA" id="cm8783985248"><title><content-text></content-text></title><media ref="en0902000000/en0902080000/en0902080200/en0902080202/cm8783985248/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902080000/en0902080200/en0902080202/cm8783985248/icontext.xml"/></content-media>
<content-text><p>Use this Packet Tracer Activity to repeat a simulation of Lab 2.8.2. Remember, however, that Packet Tracer is not a substitute for a hands-on lab experience with real equipment. </p> <p>A summary of the instructions is provided within the activity. Use the Lab PDF for more details.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en0902080300">
<title><content-text>Troubleshooting Static Routes</content-text></title>
<page type="OneColumn" id="en0902080301">
<content-media type="ActivityLab" id="cm8500443686"><title><content-text></content-text></title><media ref="en0902000000/en0902080000/en0902080300/en0902080301/cm8500443686/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902080000/en0902080300/en0902080301/cm8500443686/icontext.xml"/></content-media>
<content-text><p>In this lab, you will begin by loading corrupted configuration scripts on each of the routers. These scripts contain errors that will prevent end-to-end communication across the network. You will need to troubleshoot each router to determine the configuration errors, and then use the appropriate commands to correct the configurations. When you have corrected all of the configuration errors, all of the hosts on the network should be able to communicate with each other.</p><p><b>Click the lab icon for more details</b></p></content-text>
</page>
<page type="OneColumn" id="en0902080302">
<content-media type="ActivityPKA" id="cm1198614412"><title><content-text></content-text></title><media ref="en0902000000/en0902080000/en0902080300/en0902080302/cm1198614412/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902080000/en0902080300/en0902080302/cm1198614412/icontext.xml"/></content-media>
<content-text><p>Use this Packet Tracer Activity to repeat a simulation of Lab 2.8.3. Remember, however, that Packet Tracer is not a substitute for a hands-on lab experience with real equipment. </p> <p>A summary of the instructions is provided within the activity. Use the Lab PDF for more details.</p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en0902090000">
<title><content-text>Chapter Summary</content-text></title>
<topic type="" id="en0902090100">
<title><content-text>Summary and Review</content-text></title>
<page type="OneColumn" id="en0902090101">
<content-media type="StaticGraphic" id="cm4869270145"><title><content-text></content-text></title><media ref="en0902000000/en0902090000/en0902090100/en0902090101/cm4869270145.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902090000/en0902090100/en0902090101/cm4869270145text.xml"/></content-media>
<content-text><p><b>Summary</b></p> <p>In this chapter you learned how static routes can be used to reach remote networks. Remote networks are networks that can only be reached by forwarding the packet to another router. Static routes are easily configured. However, in large networks this manual operation can become quite cumbersome. As we will see in later chapters, static routes are still used - even when a dynamic routing protocol is implemented.</p> <p>Static routes can be configured with a next-hop IP address, which is commonly the IP address of the next-hop router. When a next-hop IP address is used, the routing table process must resolve this address to an exit interface. On point-to-point serial links it is usually more efficient to configure the static route with an exit interface. On multiaccess networks such as Ethernet, both a next-hop IP address and an exit interface can be configured on the static route.</p> <p>Static routes have a default administrative distance of "1". This administrative distance also applies to static routes configured with a next-hop address as well as an exit-interface.</p> <p>A static route will only be entered in the routing table if the next-hop IP address can be resolved through an exit interface. Whether the static route is configured with a next-hop IP address or exit interface, if the exit interface that is used to forward that packet is not in the routing table, the static route will not be included in the routing table.</p> <p>In many cases, several static routes can be configured as a single summary route. This means fewer entries in the routing table and results in a faster routing table lookup process. The ultimate summary route is a default route, configured with a 0.0.0.0 network address and a 0.0.0.0 subnet mask. If there is not a more specific match in the routing table, the routing table will use the default route to forward the packet to another router.</p> <p><b>Note:</b> The routing table lookup process is examined more closely in Chapter 8, "The Routing Table: A Closer Look."</p></content-text>
</page>
<page type="FullScreen" id="en0902090102">
<content-media type="ChapterSummary" id="cm4413444998"><title><content-text></content-text></title><media ref="en0902000000/en0902090000/en0902090100/en0902090102/cm4413444998.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902090000/en0902090100/en0902090102/cm4413444998text.xml"/></content-media>
<content-text></content-text>
</page>
<page type="OneColumn" id="en0902090103">
<content-media type="ActivityPKA" id="cm4056788680"><title><content-text></content-text></title><media ref="en0902000000/en0902090000/en0902090100/en0902090103/cm4056788680/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en0902000000/en0902090000/en0902090100/en0902090103/cm4056788680/icontext.xml"/></content-media>
<content-text><p>The Packet Tracer Skills Integration Challenge Activity for this chapter integrates all the knowledge and skills you acquired in the first two chapters of this course. In this activity, you will build a network from the ground up. Starting with an addressing space and network requirements, you must implement a network design that satisfies the specifications. Then implement an effective static routing configuration.</p> <p><content-link target="E2_PTAct_2_9_1_Directions.pdf" type="internalfile">Packet Tracer Skills Integration Instructions (PDF)</content-link></p><p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
<page type="OneColumn" id="en0902090104">
<content-media type="InteractiveGraphicHotspots" id="cm2077447823"><title><content-text></content-text></title><media ref="en0902000000/en0902090000/en0902090100/en0902090104/cm2077447823.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en0902000000/en0902090000/en0902090100/en0902090104/cm2077447823text.xml"/></content-media>
<content-text><p><b>To Learn More</b></p> <p> </p> <p><b>Floating Static Routes</b></p> <p>A floating static route is a backup route to a route which is either a dynamic route or another static route. The default administrative distance of a static route is "1". See if you can create a static route using a different exit-interface or next-hop IP address which would only be added to the routing table if the primary static route fails. </p> <p>Hints: Remember, if the router has two routes to the same destination network with two different administrative distance values, it will add the route with the lower administrative distance. A static route will be removed from the routing table if the exit-interface or next-hop IP address is no longer available.</p> <p><b>Discard Route</b></p> <p>A common configuration in many networks is to have a static default route on the edge router forwarding packets to the ISP. The ISP router then has a static route pointing to the customer's network. </p> <p>For example, Customer A has the network address of 172.16.0.0/16, which is subnetted into several /24 subnets. The edge router of Customer A has a static default route forwarding all other traffic to the ISP router: </p> <span class="cmd"><p><b>ip route 0.0.0.0 0.0.0.0 serial 0/0/0</b></p></span> <p>The ISP router has a static default route for forwarding traffic to Customer A's network: </p> <span class="cmd"><p><b>ip route 172.16.0.0 255.255.0.0 serial 0/0/1</b></p></span> <p>A problem can occur when packets are originated from the Customer A's network for a subnet that does not exist. Customer A's edge router will use its default route to forward those packets onto the ISP, The ISP router will receive those packets and send them back to Customer A's edge router because they are part of the 172.16.0.0/16 network, The edge router will once again send them back to the ISP. The packets are caught in a loop until the TTL of the packet expires.</p> <p>Configure a static route on the Customer A's edge router to discard those packets instead of forwarding them onto the ISP router.</p> <p><b>Further Reading on Static Routing</b></p> <p>Although static routes can be easily understood and configured, there are some situations when the IOS processing of static routes can be quite complex. This is especially true when there are various static routes configured that cover the same range of networks. </p> <p>Alex Zinin's book, <i>Cisco IP Routing</i>, covers static routing and IOS's static route processing in detail. This book goes beyond just the configuration and looks at the inner-workings of the Cisco IOS and its routing processes.</p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="en0902100000">
<title><content-text>Chapter Quiz</content-text></title>
<topic type="" id="en0902100100">
<title><content-text>Chapter Quiz</content-text></title>
<page type="FullScreen" id="en0902100101">
<content-media type="ChapterQuiz" id="cm8806838992"><title><content-text></content-text></title><media ref="en0902000000/en0902100000/en0902100100/en0902100101/cm8806838992/" mime="" scale="true" type="directory" width="100%" height="100%" external="en0902000000/en0902100000/en0902100100/en0902100101/cm8806838992/icontext.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
