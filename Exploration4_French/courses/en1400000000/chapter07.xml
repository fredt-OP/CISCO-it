<chapter type="" id="en1407000000">
<title><content-text>IP Addressing Services</content-text></title>
<section type="ChapterIntroduction" id="en1407000000">
<title><content-text>Chapter Introduction</content-text></title>
<topic type="" id="en1407000100">
<title><content-text>Introduction</content-text></title>
<page type="OneColumn" id="en1407000101">
<content-media type="ChapterIntroduction" id="cm9929790282">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407000000/en1407000100/en1407000101/cm9929790282.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407000000/en1407000100/en1407000101/cm9929790282text.xml"/></content-media>
<content-text><p>The Internet and IP-related technologies have experienced rapid growth. One reason for the growth has been due in part to the flexibility of the original design. However, that design did not anticipate the Internet's popularity and the resulting demand for IP addresses. For example, every host and device on the Internet requires a unique IP version 4 (<content-link target="{A2FC74BA-9345-4EEF-9664-0AD95F5A5C92}" type="glossary">IPv4</content-link>) address. Because of the dramatic growth, the number of available IP addresses is quickly running out. </p> <p>To cope with the depletion of IP addresses, several short-term solutions were developed. Two short-term solutions are private addresses and Network Address Translation (NAT). </p> <p>An inside host typically receives its IP address, subnet mask, default gateway IP address, DNS server IP address, and other information from a Dynamic Host Configuration Protocol (DHCP) server. Instead of providing inside hosts with valid Internet IP addresses, the DHCP server usually provides IP addresses from a private pool of addresses. The problem is that these hosts may still require valid IP addresses to access Internet resources. This is where NAT comes in.</p>  <p>NAT enables inside network hosts to borrow a legitimate Internet IP address while accessing Internet resources. When the requested traffic returns, the legitimate IP address is repurposed and available for the next Internet request by an inside host. Using NAT, network administrators only need one or a few IP addresses for the router to provide to the hosts, instead of one unique IP address for every client joining the network. Although it sounds inefficient, the process is actually very efficient, because host traffic occurs very quickly.</p> <p>Although private addresses with DHCP and NAT have helped reduce the need for IP addresses, it is estimated that we will run out of unique IPv4 addresses by 2010. For this reason, in the mid-1990s, the IETF requested proposals for a new IP addressing scheme. The IP Next Generation (<content-link target="{BBC0327C-A3E3-428A-A9BF-187065EB517D}" type="glossary">IPng</content-link>) working group responded. By 1996, the IETF started releasing a number of RFCs defining <content-link target="{D0CBF8A2-CE70-4F3D-8662-0FB584419C75}" type="glossary">IPv6</content-link>. </p> <p>The main feature of IPv6 that is driving adoption today is the larger address space: addresses in IPv6 are 128 bits long versus 32 bits in IPv4.</p> <p>This chapter describes how to implement DHCP, NAT, and IPv6 on enterprise networks.</p></content-text>
</page>
</topic>
</section>
<section type="" id="en1407010000">
<title><content-text>DHCP</content-text></title>
<topic type="" id="en1407010100">
<title><content-text>Introducing DHCP</content-text></title>
<page type="OneColumn" id="en1407010101">
<content-media type="AnimationPartialScreen" id="cm9402876046">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010100/en1407010101/cm9402876046.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010100/en1407010101/cm9402876046text.xml"/></content-media>
<content-text><p><b>What is DHCP?</b></p> <p>Every device that connects to a network needs an IP address. Network administrators assign static IP addresses to routers, servers, and other network devices whose locations (physical and logical) are not likely to change. Administrators enter static IP addresses manually when they configure devices to join the network. Static addresses also enable administrators to manage those devices remotely.</p> <p>However, computers in an organization often change locations, physically and logically. Administrators are unable to keep up with having to assign new IP addresses every time an employee moves to a different office or cubicle. Desktop clients do not require a static address. Instead, a workstation can use any address within a range of addresses. This range is typically within an IP subnet. A workstation within a specific subnet can be assigned any address within a specified range. Other items such as the subnet mask, default gateway, and Domain Name System (DNS) server are assigned a value which is common either to that subnet or entire administrated network. For example, all hosts within the same subnet will receive different host IP addresses, but will receive the same subnet mask and default gateway IP address." </p> <p>Recall from CCNA Exploration: Network Fundamentals that DHCP makes the process of assigning new IP addresses almost transparent. DHCP assigns IP addresses and other important network configuration information dynamically. Because desktop clients typically make up the bulk of network nodes, DHCP is an extremely useful and timesaving tool for network administrators. RFC 2131 describes DHCP.</p> <p>Administrators typically prefer a network server to offer DHCP services, because these solutions are scalable and relatively easy to manage. However, in a small branch or SOHO location, a Cisco router can be configured to provide DHCP services without the need for an expensive dedicated server. A Cisco IOS feature set called Easy IP offers an optional, full-featured DHCP server. </p></content-text>
</page>
</topic>
<topic type="" id="en1407010200">
<title><content-text>DHCP Operation</content-text></title>
<page type="OneColumn" id="en1407010201">
<content-media type="InteractiveGraphicHotspots" id="cm3631719746">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010200/en1407010201/cm3631719746.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010200/en1407010201/cm3631719746text.xml"/></content-media>
<content-text><p><b>DHCP Operation</b></p> <p>Providing IP addresses to clients is the most fundamental task performed by a DHCP server. DHCP includes three different address allocation mechanisms to provide flexibility when assigning IP addresses: </p> <p><ul><li><b>Manual Allocation:</b> The administrator assigns a pre-allocated IP address to the client and DHCP only communicates the IP address to the device. </li><li><b>Automatic Allocation:</b> DHCP automatically assigns a static IP address permanently to a device, selecting it from a pool of available addresses. There is no lease and the address is permanently assigned to a device. </li><li><b>Dynamic Allocation:</b> DHCP automatically dynamically assigns, or leases, an IP address from a pool of addresses for a limited period of time chosen by the server, or until the client tells the DHCP server that it no longer needs the address. </li></ul></p> <p>This section focuses on dynamic allocation.</p> <p>DHCP works in a client/server mode and operates like any other client/server relationship. When a PC connects to a DHCP server, the server assigns or leases an IP address to that PC. The PC connects to the network with that leased IP address until the lease expires. The host must contact the DHCP server periodically to extend the lease. This lease mechanism ensures that hosts that move or power off do not hold onto addresses that they do not need. The DHCP server returns these addresses to the address pool and reallocates them as necessary.</p> <p><b>Click the Discover button in the figure.</b></p> <p>When the client boots or otherwise wants to join a network, it completes four steps in obtaining a lease. In the first step, the client broadcasts a DHCPDISCOVER message. The DHCPDISCOVER message finds DHCP servers on the network. Because the host has no valid IP information at bootup, it uses L2 and L3 broadcast addresses to communicate with the server. </p> <p><b>Click the Offer button in the figure.</b></p> <p>When the DHCP server receives a DHCDISCOVER message, it finds an available IP address to lease, creates an ARP entry consisting of the MAC address of the requesting host and the leased IP address, and transmits a binding offer with a DHCPOFFER message. The DHCPOFFER message is sent as a unicast, using the L2 MAC address of the server as the source address and the L2 address of the client as the destination.</p> <p><b>Note:</b> Under certain circumstances, the DHCP message exchange from the server may be broadcasted and not unicasted.</p> <p><b>Click the Request button in the figure.</b></p> <p>When the client receives the DHCPOFFER from the server, it sends back a DHCPREQUEST message. This message has two purposes: lease origination and lease renewal and verification. When used for lease origination, the DHCPREQUEST of the client is requesting that the IP information be verified just after it has been assigned. The message provides error checking to ensure that the assignment is still valid. The DHCPREQUEST also serves as a binding acceptance notice to the selected server and an implicit decline to any other servers that may have provided the host a binding offer. </p> <p>Many enterprise networks use multiple DHCP servers. The DHCPREQUEST message is sent in the form of a broadcast to inform this DHCP server and any other DHCP servers about the accepted offer.</p> <p><b>Click the Acknowledge button in the figure.</b></p> <p>On receiving the DHCPREQUEST message, the server verifies the lease information, creates a new ARP entry for the client lease, and replies with a unicast DHCPACK message. The DHCPACK message is a duplicate of the DHCPOFFER, except for a change in the message type field. When the client receives the DHCPACK message, it logs the configuration information and performs an ARP lookup for the assigned address. If it does not receive a reply, it knows that the IP address is valid and starts using it as its own. </p> <p>Clients lease the information from the server for an administratively defined period. Administrators configure DHCP servers to set the leases to time out at different intervals. Most ISPs and large networks use default lease durations of up to three days. When the lease expires, the client must ask for another address, although the client is typically reassigned the same address.</p> <p>The DHCPREQUEST message also addresses the dynamic DHCP process. The IP information sent in the DHCPOFFER might have been offered to another client during the dynamic allocation. Each DHCP server creates pools of IP addresses and associated parameters. Pools are dedicated to individual, logical IP subnets. The pools allow multiple DHCP servers to respond and IP clients to be mobile. If multiple servers respond, a client can choose only one of the offers.</p></content-text>
</page>
</topic>
<topic type="" id="en1407010300">
<title><content-text>BOOTP and DHCP</content-text></title>
<page type="OneColumn" id="en1407010301">
<content-media type="StaticGraphic" id="cm5563077473">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010300/en1407010301/cm5563077473.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010300/en1407010301/cm5563077473text.xml"/></content-media>
<content-text><p><b>BOOTP and DHCP</b></p> <p>The <content-link target="{204BC05A-D48A-4006-822D-91247379C9BC}" type="glossary">Bootstrap Protocol</content-link> (BOOTP), defined in RFC 951, is the predecessor of DHCP and shares some operational characteristics. BOOTP is a way to download address and boot configurations for diskless workstations. A diskless workstation does not have a hard drive or an operating system. For example, many automated cash register systems at your local super market are examples of diskless workstations. Both DHCP and BOOTP are client/server based and use UDP ports 67 and 68. Those ports are still known as BOOTP ports. </p> <p>DHCP and BOOTP have two components, as shown in the figure. The server is a host with a static IP address that allocates, distributes, and manages IP and configuration data assignments. Each allocation (IP and configuration data) is stored on the server in a data set called a binding. The client is any device using DHCP as a method for obtaining IP addressing or supporting configuration information. </p> <p>To understand the functional differences between BOOTP and DHCP, consider the four basic IP parameters needed to join a network: </p> <p><ul><li>IP address </li><li>Gateway address </li><li>Subnet mask </li><li>DNS server address</li></ul></p> <p>There are three primary differences between DHCP and BOOTP: </p> <p><ul><li>The main difference is that BOOTP was designed for manual pre-configuration of the host information in a server database, while DHCP allows for dynamic allocation of network addresses and configurations to newly attached hosts. When a BOOTP client requests an IP address, the BOOTP server searches a predefined table for an entry that matches the MAC address for the client. If an entry exists, the corresponding IP address for that entry is returned to the client. This means that the binding between the MAC address and the IP address must have already been configured in the BOOTP server.</li><li>DHCP allows for recovery and reallocation of network addresses through a leasing mechanism. Specifically, DHCP defines mechanisms through which clients can be assigned an IP address for a finite lease period. This lease period allows for reassignment of the IP address to another client later, or for the client to get another assignment if the client moves to another subnet. Clients may also renew leases and keep the same IP address. BOOTP does not use leases. Its clients have reserved IP address which cannot be assigned to any other host. </li><li>BOOTP provides a limited amount of information to a host. DHCP provides additional IP configuration parameters, such as WINS and domain name. </li></ul></p></content-text>
</page>
<page type="OneColumn" id="en1407010302">
<content-media type="StaticGraphic" id="cm4887772734">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010300/en1407010302/cm4887772734.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010300/en1407010302/cm4887772734text.xml"/></content-media>
<content-text><p><b>DHCP Message Format</b></p> <p>The developers of DHCP needed to maintain compatibility with BOOTP and consequently used the same BOOTP message format. However, because DHCP has more functionality than BOOTP, the DHCP options field was added. When communicating with older BOOTP clients, the DHCP options field is ignored.</p> <p>The figure shows the format of a DHCP message. The fields are as follows:</p> <p><ul><li><b>Operation Code</b><b> (OP)</b> - Specifies the general type of message. A value of 1 indicates a request message; a value of 2 is a reply message.</li><li><b>Hardware Type</b> - Identifies the type of hardware used in the network. For example, 1 is Ethernet, 15' is Frame Relay, and 20 is a serial line. These are the same codes used in ARP messages.</li><li><b><content-link target="{5E19C782-5C80-4A00-B827-4624A1D4A74E}" type="glossary">Hardware Address</content-link> length</b> - 8 bits to specify the length of the address.</li><li><b>Hops </b>- Set to 0 by a client before transmitting a request and used by relay agents to control the forwarding of DHCP messages.</li><li><b>Transaction Identifier</b> - 32-bit identification generated by the client to allow it to match up the request with replies received from DHCP servers.</li><li><b>Seconds</b> - Number of seconds elapsed since a client began attempting to acquire or renew a lease. Busy DHCP servers use this number to prioritize replies when multiple client requests are outstanding.</li><li><b>Flags</b> - Only one of the 16 bits is used, which is the broadcast flag. A client that does not know its IP address when it sends a request, sets the flag to 1. This value tells the DHCP server or relay agent receiving the request that it should send the reply back as a broadcast. </li><li><b>Client IP Address</b> - The client puts its own IP address in this field if and only if it has a valid IP address while in the bound state; otherwise, it sets the field to 0. The client can only use this field when its address is actually valid and usable, not during the process of acquiring an address. </li><li><b>Your IP Address</b> - IP address that the server assigns to the client.</li><li><b>Server IP Address</b> - Address of the server that the client should use for the next step in the bootstrap process, which may or may not be the server sending this reply. The sending server always includes its own IP address in a special field called the Server Identifier DHCP option. </li><li><b>Gateway IP Address</b> - Routes DHCP messages when DHCP relay agents are involved. The gateway address facilitates communications of DHCP requests and replies between the client and a server that are on different subnets or networks.</li><li><b>Client Hardware Address</b> - Specifies the Physical layer of the client.</li><li><b>Server Name</b> - The server sending a DHCPOFFER or DHCPACK message may optionally put its name in this field. This can be a simple text nickname or a DNS domain name, such as dhcpserver.netacad.net.</li><li><b>Boot Filename</b> - Optionally used by a client to request a particular type of boot file in a DHCPDISCOVER message. Used by a server in a DHCPOFFER to fully specify a boot file directory and filename.</li><li><b>Options</b> - Holds DHCP options, including several parameters required for basic DHCP operation. This field is variable in length. Both client and server may use this field.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en1407010303">
<content-media type="AnimationPartialScreen" id="cm6471917777">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010300/en1407010303/cm6471917777.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010300/en1407010303/cm6471917777text.xml"/></content-media>
<content-text><p><b>DHCP Discovery and Offer Methods</b></p> <p>These figures provide some detail of the packet content of the DHCP discover and offer messages. </p> <p>When a client wants to join the network, it requests addressing values from the network DHCP server. If a client is configured to receive its IP settings dynamically, it transmits a DHCPDISCOVER message on its local physical subnet when it boots or senses an active network connection. Because the client has no way of knowing the subnet to which it belongs, the DHCPDISCOVER is an IP broadcast (destination IP address of 255.255.255.255). The client does not have a configured IP address, so the source IP address of 0.0.0.0 is used. As you see in the figure, the client IP address (CIADDR), default gateway address (GIADDR), and subnetwork mask are all marked with question marks.</p> <p><b>Click the DHCP Offer button in the figure.</b></p> <p>The DHCP server manages the allocation of the IP addresses and answers configuration requests from clients. </p> <p>When the DHCP server receives the DHCPDISCOVER message, it responds with a DHCPOFFER message. This message contains initial configuration information for the client, including the MAC address of the client, followed by the IP address that the server is offering, the subnet mask, the lease duration, and the IP address of the DHCP server making the offer. The subnet mask and default gateway are specified in the options field, subnet mask, and router options, respectively. The DHCPOFFER message can be configured to include other information, such as the lease renewal time, domain name server, and <content-link target="{750B79DE-7275-411F-8249-A4E30CA96827}" type="glossary">NetBIOS</content-link> Name Service (Microsoft Windows Internet Name Service [Microsoft WINS]). </p> <p>The server determines the configuration, based on the hardware address of the client as specified in the CHADDR field. </p> <p>As shown in the diagram, the DHCP server has responded to the DHCPDISCOVER by assigning values to the CIADDR and subnetwork mask. </p> <p>Administrators set up DHCP servers to assign addresses from predefined pools. Most DHCP servers also allow the administrator to define specifically which client MAC addresses can be serviced and automatically assign them the same IP address each time. </p> <p>DHCP uses User Datagram Protocol (UDP) as its transport protocol. The client sends messages to the server on port 67. The server sends messages to the client on port 68.</p> <p>The client and server acknowledge messages, and the process is complete. The client sets the CIADDR only when a host is in a bound state, which means that the client has confirmed and is using the IP address. </p> <p>For more information on DHCP, see "Cisco IOS DHCP Server" at: <content-link target="http://www.cisco.com/univercd/cc/td/doc/product/software/ios120/120newft/120t/120t1/easyip2.htm#wp4363" type="external">http://www.cisco.com/univercd/cc/td/doc/product/software/ios120/120newft/120t/120t1/easyip2.htm#wp4363</content-link>.</p></content-text>
</page>
</topic>
<topic type="" id="en1407010400">
<title><content-text>Configuring a DHCP Server</content-text></title>
<page type="OneColumn" id="en1407010401">
<content-media type="InteractiveGraphicHotspots" id="cm2951434100">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010400/en1407010401/cm2951434100.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010400/en1407010401/cm2951434100text.xml"/></content-media>
<content-text><p><b>Configuring a DHCP Server</b></p> <p>Cisco routers running Cisco IOS software provide full support for a router to act as a DHCP server. The Cisco IOS DHCP server assigns and manages IP addresses from specified address pools within the router to DHCP clients. </p> <p>The steps to configure a router as a DHCP server are as follows:</p> <p><b>Step 1.</b> Define a range of addresses that DHCP is not to allocate. These are usually static addresses reserved for the router interface, switch management IP address, servers, and local network printers. </p> <p><b>Step 2.</b> Create the DHCP pool using the <span class="cmd"><b>ip dhcp pool</b></span> command.</p> <p><b>Step 3.</b> Configure the specifics of the pool.</p> <p>A best practice is to configure excluded addresses in global configuration mode before creating the DHCP pool. This ensures that DHCP does not assign reserved addresses accidentally. </p> <p>You should specify the IP addresses that the DHCP server should not assign to clients. Typically, some IP addresses belong to static network devices, such as servers or printers. DHCP should not assign these IP addresses to other devices. A best practice is to configure excluded addresses in global configuration mode before creating the DHCP pool. This ensures that DHCP does not assign reserved addresses accidentally. To exclude specific addresses, use the <span class="cmd"><b>ip dhcp excluded-address</b></span> command.</p> <p><b>Click the DHCP Pool button in the figure.</b></p> <p>Configuring a DHCP server involves defining a pool of addresses to assign. The <span class="cmd"><b>ip dhcp pool</b></span> command creates a pool with the specified name and puts the router in DHCP configuration mode, which is identified by the <span class="cmd">Router(dhcp-config)#</span> prompt. </p> <p><b>Click the DHCP Tasks button in the figure.</b></p> <p>This figure lists the tasks to complete the DHCP pool configuration. Some of these are optional, while others must be configured. </p> <p>You must configure the available addresses and specify the subnet network number and mask of the DHCP address pool. Use the <span class="cmd"><b>network</b></span> statement to define the range of available addresses. </p> <p>You should also define the default gateway or router for the clients to use with the <span class="cmd"><b>default-router</b></span> command. Typically, the gateway is the LAN interface of the router. One address is required, but you can list up to eight addresses.</p> <p>The next DHCP pool commands are considered optional. For example, you can configure the IP address of the DNS server that is available to a DHCP client using the <span class="cmd"><b>dns-server</b></span> command. When configured, one address is required, but up to eight addresses can be listed.</p> <p>Other parameters include configuring the duration of the DHCP lease. The default setting is one day, but you can change this by using the <span class="cmd"><b>lease</b></span> command. You can also configure a NetBIOS WINS server that is available to a Microsoft DHCP client. Usually, this would be configured in an environment that supports pre-Windows 2000 clients. Because most installations now have clients with newer Windows operating system, this parameter is usually not required.</p> <p><b>Click the DHCP Example button in the figure.</b></p> <p>This figure displays a sample configuration with basic DHCP parameters configured on router R1.</p> <p><b>Disabling DHCP</b></p> <p>The DHCP service is enabled by default on versions of Cisco IOS software that support it. To disable the service, use the <span class="cmd"><b>no service dhcp</b></span> command. Use the <span class="cmd"><b>service dhcp</b></span> global configuration command to re-enable the DHCP server process. Enabling the service has no effect if the parameters are not configured.</p></content-text>
</page>
<page type="OneColumn" id="en1407010402">
<content-media type="StaticGraphic" id="cm7669371726">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010400/en1407010402/cm7669371726.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010400/en1407010402/cm7669371726text.xml"/></content-media>
<content-text><p><b>Verifying DHCP</b></p> <p>To illustrate how a Cisco router can be configured to provide DHCP services, refer to the figure. PC1 has not been powered up and therefore does not have an IP address. </p> <p>Router R1 has been configured with the following commands:</p> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.10.1 192.168.10.9</b></p></span> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.10.254</b></p></span> <span class="cmd"><p><b>ip dhcp pool LAN-POOL-1</b></p></span> <span class="cmd"><p><b> network 192.168.10.0 255.255.255.0</b></p></span> <span class="cmd"><p><b> default-router 192.168.10.1</b></p></span> <span class="cmd"><p><b> domain-name span.com</b></p></span> <p>To verify the operation of DHCP, use the <span class="cmd"><b>show ip dhcp binding</b></span> command. This command displays a list of all IP address to MAC address bindings that have been provided by the DHCP service. </p> <p>To verify that messages are being received or sent by the router, use the <span class="cmd"><b>show ip dhcp server</b></span> statistics command. This command displays count information regarding the number of DHCP messages that have been sent and received.</p> <p><b>Click the DHCP-1 button in the figure.</b></p> <p>As you can see in the figure, currently there are no bindings or statistics being displayed.</p> <p>Now, assume that PC1 has been powered and completed its booting process.</p> <p><b>Click the DHCP-2 button on the figure.</b></p> <p>Notice that the binding information now displays that the IP address of 192.168.10.10 has been bound to a MAC address. The statistics are also displaying DHCPDISCOVER, DHCPREQUEST, DHCPOFFER, and DHCPACK activity.</p> <p><b>Click the DHCP Client button in the figure.</b></p> <p>The <span class="cmd"><b>ipconfig /all</b></span> command displays the TCP/IP configured parameters on PC1. Because PC1 was connected to the network segment 192.168.10.0 /24, it automatically received an IP address, DNS suffix, and default gateway from that pool. There is no DHCP interface configuration required. If a PC is connected to a network segment that has a DHCP pool available, it can obtain an IP address automatically.</p> <p>So how does PC2 receive an IP address? Router R1 would have to be configured to provide a 192.168.11.0 /24 DHCP pool as follows:</p> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.11.1 192.168.11.9</b></p></span> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.11.254</b></p></span> <span class="cmd"><p><b>ip dhcp pool LAN-POOL-2</b></p></span> <span class="cmd"><p><b> network 192.168.11.0 255.255.255.0</b></p></span> <span class="cmd"><p> <b>default-router 192.168.11.1</b></p></span> <span class="cmd"><p> <b>domain-name span.com</b></p></span> <p>When PC2 has completed its booting process, it is provided with an IP address for the network segment to which it is connected. </p> <p><b>Click the Verifying DHCP-3 button in the figure.</b></p> <p>Notice that the DHCP bindings now indicate that two hosts have been provided with IP addresses. The DHCP statistics are also reflecting the exchange of DHCP messages.</p> <p>Another useful command to view multiple pools is the <span class="cmd"><b>show ip dhcp pool</b></span> command. </p> <p><b>Click the DHCP Pools button in the figure.</b></p> <p>This command summarizes the DHCP pool information.</p></content-text>
</page>
</topic>
<topic type="" id="en1407010500">
<title><content-text>Configuring a DHCP Client</content-text></title>
<page type="OneColumn" id="en1407010501">
<content-media type="StaticGraphic" id="cm9863707146">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010500/en1407010501/cm9863707146.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010500/en1407010501/cm9863707146text.xml"/></content-media>
<content-text><p><b>Configuring a DHCP Client</b></p> <p>Typically, small broadband routers for home use, such as Linksys routers, can be configured to connect to an ISP using a DSL or cable modem. In most cases, small home routers are set to acquire an IP address automatically from their ISPs. For example, the figure shows the default WAN setup page for a Linksys WRVS4400N router. Notice that the Internet connection type is set to Automatic Configuration - DHCP. This means that when the router is connected to a cable modem, for example, it is a DHCP client and requests an IP address from the ISP. </p> <p>Sometimes, Cisco routers in SOHO and branch sites have to be configured in a similar manner. The method used depends on the ISP. However, in its simplest configuration, the Ethernet interface is used to connect to a cable modem. To configure an Ethernet interface as a DHCP client, the <span class="cmd"><b>ip address dhcp</b></span> command must be configured.</p> <p> </p> <p><b>Click the DHCP Client button in the figure.</b></p> <p>In the figure, assume that an ISP has been configured to provide select customers with IP addresses from the 209.165.201.0 / 27 range. The ouput confirms the assigned address.</p></content-text>
</page>
</topic>
<topic type="" id="en1407010600">
<title><content-text>DHCP Relay</content-text></title>
<page type="OneColumn" id="en1407010601">
<content-media type="StaticGraphic" id="cm8673484145">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010600/en1407010601/cm8673484145.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010600/en1407010601/cm8673484145text.xml"/></content-media>
<content-text><p><b>What is DHCP Relay?</b></p> <p>In a complex hierarchical network, enterprise servers are usually contained in a server farm. These servers may provide DHCP, DNS, TFTP, and FTP services for the clients. The problem is that the network clients typically are not on the same subnet as those servers. Therefore, the clients must locate the servers to receive services and often these services are located using broadcast messages. </p> <p>In the figure, PC1 is attempting to acquire an IP address from the DHCP server located at 192.168.11.5. In this scenario router R1 is not configured as a DHCP server.</p> <p><b>Click the Host Problem button in the figure.</b></p> <p>In the figure, PC1 is attempting to renew its IP address. To do so, the <b>ipconfig /release</b> command is issued. Notice that the IP address is released and the current address is now 0.0.0.0. Next, the <b>ipconfig /renew</b> command is issued. This initiates the host to broadcast a DHCPDISCOVER message. However, PC1 is unable to locate the DHCP server. What happens when the server and the client are separated by a router and therefore are not on the same network segment? Remember, routers do not forward broadcasts.</p> <p><b>Note:</b> Certain Windows clients have a feature called Automatic Private IP Addressing (APIPA). With this feature, a Windows computer can automatically assign itself an IP address in the 169.254.x.x range in the event that a DHCP server is not available or does not exist on the network.</p> <p>To make matters worse, DHCP is not the only critical service that uses broadcasts. For example, Cisco routers and other devices may use broadcasts to locate TFTP servers or to locate an authentication server such as a TACACS server. </p> <p>As a solution to this problem, an administrator could add DHCP servers on all the subnets. However, running these services on several computers creates both cost and administrative overhead. </p> <p>A simpler solution is to configure the Cisco IOS <content-link target="{A39F7ADB-4FBE-4B32-ABF9-5AE33817E5DC}" type="glossary">helper address</content-link> feature on intervening routers and switches. This solution enables routers to forward DHCP broadcasts to the DHCP servers. When a router forwards address assignment/parameter requests, it is acting as a DHCP relay agent. </p> <p>For example, PC1 would broadcast a request to locate a DHCP server. If router R1 were configured as a DHCP relay agent, it would intercept this request and forward it to the DHCP server located on subnet 192.168.11.0.</p> <p>To configure router R1 as a DHCP relay agent, you need to configure the nearest interface to the client with the <span class="cmd"><b>ip helper-address</b></span> interface configuration command. This command relays broadcast requests for key services to a configured address. Configure the IP helper address on the interface receiving the broadcast. </p> <p><b>Click the Relay Config button in the figure.</b></p> <p>Router R1 is now configured as a DHCP relay agent. It accepts broadcast requests for the DHCP service and then forwards them as a unicast to the IP address 192.168.11.5. </p> <p><b>Click the Host Renew button in the figure.</b></p> <p>As you can see, PC1 is now able to acquire an IP address from the DHCP server.</p> <p>DHCP is not the only service that the router can be configured to relay. By default, the <span class="cmd"><b>ip helper-address</b></span> command forwards the following eight UDP services:</p> <p><ul><li>Port 37: Time </li><li>Port 49: TACACS</li><li>Port 53: DNS</li><li>Port 67: DHCP/BOOTP client</li><li>Port 68: DHCP/BOOTP server</li><li>Port 69: TFTP</li><li>Port 137: NetBIOS name service</li><li>Port 138: NetBIOS datagram service</li></ul></p> <p>To specify additional ports, use the <span class="cmd"><b>ip forward-protocol</b></span> command to specify exactly which types of broadcast packets to forward.</p></content-text>
</page>
</topic>
<topic type="" id="en1407010700">
<title><content-text>Configuring a DHCP Server Using SDM</content-text></title>
<page type="OneColumn" id="en1407010701">
<content-media type="StaticGraphic" id="cm8714511774">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010700/en1407010701/cm8714511774.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010700/en1407010701/cm8714511774text.xml"/></content-media>
<content-text><p><b>Configuring a DHCP Server Using SDM</b></p> <p>Cisco routers can also be configured as a DHCP server using SDM. In this example, router R1 will be configured as the DHCP server on the Fa0/0 and Fa0/1interfaces. </p> <p><b>Click the DHCP Tasks button in the figure.</b></p> <p>The DHCP server function is enabled under Additional Tasks in the Configure tab. From the list of tasks, click on the DHCP folder and then select <b>DHCP Pools</b> to add a new pool. Click <b>Add</b> to create the new DHCP pool.</p> <p><b>Click the Add Pool buton in the figure.</b></p> <p>The Add DHCP Pool window contains the options you need to configure the DHCP IP address pool. The IP addresses that the DHCP server assigns are drawn from a common pool. To configure the pool, specify the starting and ending IP addresses of the range. </p> <p>Cisco SDM configures the router to automatically exclude the LAN interface IP address in the pool. You must not use the network or subnetwork IP address or broadcast address on the network in the range of addresses that you specify. </p> <p>If you need to exclude other IP addresses in the range, you can do so by adjusting the starting and ending IP addresses. For instance, if you needed to exclude IP addresses 192.168.10.1 through 192.168.10.9, you would set the Starting IP address to 192.168.10.10. This allows the router to begin address assignment with 192.168.10.10. </p> <p>The other options that are available are:</p> <p><ul><li><b>DNS Server1 and DNS Server2</b> - The DNS server is typically a server that maps a known device name with its IP address. If you have a DNS server configured for your network, enter the IP address for the server here. If there is an additional DNS server on the network, you can enter the IP address for that server in this field. </li><li><b>WINS Server1 and WINS Server2</b> - Recall that WINS configuration is typically in environments that support pre-Windows 2000 clients. </li><li><b>Import All DHCP Options into the DHCP Server Database</b> - Allows the DHCP options to be imported from a higher level server, and is typically used in conjunction with an Internet DHCP server. This option allows you to pull higher level information without having to configure it in for this pool. </li></ul></p> <p><b>Click the DHCP Pools button in the figure.</b></p> <p>This screen provides you with a summary of the pools configured on your router. In this example, there have been two pools configured, one for each of the Fast Ethernet interfaces on the R1 router.</p></content-text>
</page>
</topic>
<topic type="" id="en1407010800">
<title><content-text>Troubleshooting DHCP</content-text></title>
<page type="OneColumn" id="en1407010801">
<content-media type="InteractiveGraphicHotspots" id="cm3378856475">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010800/en1407010801/cm3378856475.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010800/en1407010801/cm3378856475text.xml"/></content-media>
<content-text><p><b>Troubleshooting DHCP Configuration </b></p> <p>DHCP problems can arise for a multitude of reasons, such as software defects in operating systems, NIC drivers, or DHCP/BOOTP relay agents, but the most common are configuration issues. Because of the number of potentially problematic areas, a systematic approach to troubleshooting is required.</p> <p><b>Troubleshooting Task 1: Resolve IP Address Conflicts</b></p> <p>An IP address lease can expire on a client still connected to a network. If the client does not renew the lease, the DHCP server can reassign that IP address to another client. When the client reboots, it requests an IP address. If the DHCP server does not respond quickly, the client uses the last IP address. The situation then arises that two clients are using the same IP address, creating a conflict.</p> <p>The <span class="cmd"><b>show ip dhcp</b></span> conflict command displays all address conflicts recorded by the DHCP server. The server uses the <span class="cmd"><b>ping</b></span> command to detect conflicts. The client uses Address Resolution Protocol (ARP) to detect clients. If an address conflict is detected, the address is removed from the pool and not assigned until an administrator resolves the conflict. </p> <p>This example displays the detection method and detection time for all IP addresses that the DHCP server has offered that have conflicts with other devices.</p> <p><span class="cmd">R2# <b>show ip dhcp conflict</b></span></p> <p><span class="cmd">IP address Detection Method Detection time</span></p> <p><span class="cmd">192.168.1.32 Ping Feb 16 2007 12:28 PM</span></p> <p><span class="cmd">192.168.1.64 Gratuitous ARP Feb 23 2007 08:12 AM</span></p> <p><b>Troubleshooting Task 2: Verify Physical Connectivity</b></p> <p>First, use the <span class="cmd"><b>show interface</b> <i>interface</i></span> command to confirm that the router interface acting as the default gateway for the client is operational. If the state of the interface is anything other than up, the port does not pass traffic, including DHCP client requests. </p> <p><b>Troubleshooting Task 3: Test Network Connectivity by Configuring a Client Workstation with a Static IP Address</b></p> <p>When troubleshooting any DHCP issue, verify network connectivity by configuring a static IP address on a client workstation. If the workstation is unable to reach network resources with a statically configured IP address, the root cause of the problem is not DHCP. At this point, network connectivity troubleshooting is required.</p> <p><b>Troubleshooting Task 4: Verify Switch Port Configuration (STP Portfast and Other Commands)</b></p> <p>If the DHCP client is unable to obtain an IP address from the DHCP server on startup, attempt to obtain an IP address from the DHCP server by manually forcing the client to send a DHCP request. </p> <p>If there is a switch between the client and the DHCP server, verify that the port has STP PortFast enabled and trunking/channeling disabled. The default configuration is PortFast disabled and trunking/channeling auto, if applicable. These configuration changes resolve the most common DHCP client issues that occur with an initial installation of a Catalyst switch. A review of CCNA Exploration: LAN Switching and Wireless assists in solving this issue.</p> <p><b>Troubleshooting Task 5: Distinguishing Whether DHCP Clients Obtain IP Address on the Same Subnet or VLAN as DHCP Server</b></p> <p>It is important to distinguish whether DHCP is functioning correctly when the client is on the same subnet or VLAN as the DHCP server. If the DHCP is working correctly, the problem may be the DHCP/BOOTP relay agent. If the problem persists even with testing DHCP on the same subnet or VLAN as the DHCP server, the problem may actually be with the DHCP server.</p></content-text>
</page>
<page type="OneColumn" id="en1407010802">
<content-media type="StaticGraphic" id="cm8098039303">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010800/en1407010802/cm8098039303.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010800/en1407010802/cm8098039303text.xml"/></content-media>
<content-text><p><b>Verify Router DHCP/BOOTP Relay Configuration </b></p> <p>When the DHCP server is located on a separate LAN from the client, the router interface facing the client must be configured to relay DHCP requests. This is accomplished by configuring the IP helper address. If the IP helper address is not configured properly, client DHCP requests are not forwarded to the DHCP server.</p> <p>Follow these steps to verify the router configuration:</p> <p><b>Step 1.</b> Verify that the <span class="cmd"><b>ip helper-address</b></span> command is configured on the correct interface. It must be present on the inbound interface of the LAN containing the DHCP client workstations and must be directed to the correct DHCP server. In the figure, the output of the <span class="cmd"><b>show running-config</b></span> command verifies that the DHCP relay IP address is referencing the DHCP server address at 192.168.11.5.</p> <p><b>Step 2.</b> Verify that the global configuration command <span class="cmd"><b>no service dhcp</b></span> has not been configured. This command disables all DHCP server and relay functionality on the router. The command <span class="cmd"><b>service dhcp</b></span> does not appear in the configuration, because it is the default configuration.</p></content-text>
</page>
<page type="OneColumn" id="en1407010803">
<content-media type="StaticGraphic" id="cm5087573142">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010800/en1407010803/cm5087573142.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407010000/en1407010800/en1407010803/cm5087573142text.xml"/></content-media>
<content-text><p><b>Verify that the Router Is Receiving DHCP Requests Using </b><span class="cmd"><b>debug</b></span><b> Commands.</b></p> <p>On routers configured as DHCP servers, the DHCP process fails if the router is not receiving requests from the client. As a troubleshooting task, verify that the router is receiving the DHCP request from the client. This troubleshooting step involves configuring an access control list for debugging output. The debug access control list is not intrusive to the router.</p> <p>In global configuration mode, create the following access control list:</p> <p><span class="cmd"><b>access-list 100 permit ip host 0.0.0.0 host 255.255.255.255</b></span></p> <p>Start debugging by using ACL 100 as the defining parameter. In exec mode, enter the following <span class="cmd"><b>debug</b></span> command: </p> <p><span class="cmd"><b>debug ip packet detail 100</b></span></p> <p>The output in the figure shows that the router is receiving the DHCP requests from the client. The source IP address is 0.0.0.0 because the client does not yet have an IP address. The destination is 255.255.255.255 because the DHCP discovery message from the client is a broadcast. The UDP source and destination ports, 68 and 67, are the typical ports used for DHCP.</p> <p>This output only shows a summary of the packet and not the packet itself. Therefore, it is not possible to determine if the packet is correct. Nevertheless, the router did receive a broadcast packet with the source and destination IP and UDP ports that are correct for DHCP.</p> <p><b>Verify that the Router Is Receiving and Forwarding DHCP Request Using </b><span class="cmd"><b>debug ip dhcp server packet</b></span><b> Command</b></p> <p>A useful command for troubleshooting DHCP operation is the <span class="cmd"><b>debug ip dhcp server events</b></span> command. This command reports server events, like address assignments and database updates. It is also used for decoding DHCP receptions and transmissions. </p></content-text>
</page>
<page type="OneColumn" id="en1407010804">
<content-media type="ActivityPKA" id="cm5818285126">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407010000/en1407010800/en1407010804/cm5818285126/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407010000/en1407010800/en1407010804/cm5818285126/icontext.xml"/></content-media>
<content-text><p>DHCP assigns IP addresses and other important network configuration information dynamically. Cisco routers can use the Cisco IOS feature set, Easy IP, as an optional, full-featured DHCP server. Easy IP leases configurations for 24 hours by default. In this activity, you will configure DHCP services on two routers and test your configuration.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E4_PTAct_7_1_8.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en1407020000">
<title><content-text>Scaling Networks with NAT</content-text></title>
<topic type="" id="en1407020100">
<title><content-text>Private and Public IP Addressing</content-text></title>
<page type="OneColumn" id="en1407020101">
<content-media type="StaticGraphic" id="cm7216035341">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020100/en1407020101/cm7216035341.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020100/en1407020101/cm7216035341text.xml"/></content-media>
<content-text><p>All public <content-link target="{3B85FACD-786F-44AC-B83F-E42F90D4CF23}" type="glossary">Internet addresses</content-link> must be registered with a Regional Internet Regiestry (RIR). Organizations can lease public addresses from an ISP. Only the registered holder of a public Internet address can assign that address to a network device.</p> <p>You may have noticed that all the examples in this course use a somewhat restricted number of IP addresses. You may also have noticed the similarity between these numbers and numbers you have used in a small network to view the setup web pages of many brands of printers, DSL and cable routers, and other peripherals. These are reserved private Internet addresses drawn from the three blocks shown in the figure. These addresses are for private, internal network use only. Packets containing these addresses are not routed over the Internet, and are referred to as non-routable addresses. RFC 1918 provides details.</p> <p>Unlike public IP addresses, private IP addresses are a reserved block of numbers that can be used by anyone. That means two networks, or two million networks, can each use the same private addresses. To prevent addressing conflicts, routers must never route private IP addresses. To protect the public Internet address structure, ISPs typically configure the border routers to prevent privately addressed traffic from being forwarded over the Internet.</p> <p>By providing more address space than most organizations could obtain through a RIR, private addressing gives enterprises considerable flexibility in network design. This enables operationally and administratively convenient addressing schemes as well as easier growth.</p> <p>However, because you cannot route private addresses over the Internet, and there are not enough public addresses to allow organizations to provide one to every one of their hosts, networks need a mechanism to translate private addresses to public addresses at the edge of their network that works in both directions. Without a translation system, private hosts behind a router in the network of one organization cannot connect with private hosts behind a router in other organizations over the Internet. </p> <p>Network Address Translation (NAT) provides this mechanism. Before NAT, a host with a private address could not access the Internet. Using NAT, individual companies can address some or all of their hosts with private addresses and use NAT to provide access to the Internet.</p> <p>For a more in-depth look at the development of the RIR system, see the Cisco Internet Protocol Journal article at <content-link target="http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_4-4/regional_internet_registries.html" type="external">http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_4-4/regional_internet_registries.html</content-link>. </p></content-text>
</page>
</topic>
<topic type="" id="en1407020200">
<title><content-text>What is NAT?</content-text></title>
<page type="OneColumn" id="en1407020201">
<content-media type="StaticGraphic" id="cm1136421622">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020200/en1407020201/cm1136421622.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020200/en1407020201/cm1136421622text.xml"/></content-media>
<content-text><p><b>What is NAT?</b></p> <p>NAT is like the receptionist in a large office. Assume you have left instructions with the receptionist not to forward any calls to you unless you request it. Later on, you call a potential client and leave a message for them to call you back. You tell the receptionist that you are expecting a call from this client, and you ask the receptionist to put them through to your telephone.</p> <p>The client calls the main number to your office, which is the only number the client knows. When the client tells the receptionist who they are looking for, the receptionist checks a lookup table that matches your name to your extension. The receptionist knows that you requested this call; therefore, the receptionist forwards the caller to your extension. </p> <p>So while the DHCP server assigns IP dynamic addresses to devices inside the network, NAT-enabled routers retain one or many valid Internet IP addresses outside of the network. When the client sends packets out of the network, NAT translates the internal IP address of the client to an external address. To outside users, all traffic coming to and going from the network has the same IP address or is from the same pool of addresses. </p> <p>NAT has many uses, but its key use is to save IP addresses by allowing networks to use private IP addresses. NAT translates non-routable, private, internal addresses into routable, public addresses. NAT has an added benefit of adding a degree of privacy and security to a network because it hides internal IP addresses from outside networks.</p> <p>A NAT-enabled device typically operates at the border of a <content-link target="{599C668A-E409-45CA-9965-73197F160850}" type="glossary">stub network</content-link>. In our example, R2 is the border router. A stub network is a network that has a single connection to its neighbor network. As seen from the ISP, R2 forms a stub network.</p> <p>When a host inside the stub network, say PC1, PC2, or PC 3, wants to transmit to a host on the outside, the packet is forwarded to R2, the <content-link target="{6914E21E-5AC5-4115-BB72-C467B5B39C3D}" type="glossary">border gateway</content-link> router. R2 performs the NAT process, translating the internal private address of the host to a public, outside, routable address. </p> <p>In NAT terminology, the inside network is the set of networks that are subject to translation. The outside network refers to all other addresses. IP addresses have different designations based on whether they are on the private network or on the public network (Internet) and whether the traffic is incoming or outgoing. </p> <p><b>Click the NAT Terminology Button in the figure.</b></p> <p>The figure shows how to refer to the interfaces when configuring NAT. Assume that router R2 has been configured to provide NAT features. It has a pool of publicly available addresses to lend to inside hosts. This section uses the following terms when discussing NAT:</p> <p><ul><li><b>Inside local address</b> - Usually not an IP address assigned by a RIR or service provider and is most likely an RFC 1918 private address. In the figure, the IP address 192.168.10.10 is assigned to the host PC1 on the inside network. </li><li><b>Inside global address</b> - Valid public address that the inside host is given when it exits the NAT router. When traffic from PC1 is destined for the web server at 209.165.201.1, router R2 must translate the address. In this case, IP address 209.165.200.226 is used as the inside global address for PC1.</li><li><b>Outside global address</b> - Reachable IP address assigned to a host on the Internet. For example, the web server is reachable at IP address 209.165.201.1. </li><li><b>Outside local address</b> - The local IP address assigned to a host on the outside network. In most situations, this address will be identical to the outside global address of that outside device. </li></ul></p> <p><b>Note:</b> In this course, we will be referencing the inside local address, inside global address, and the outside global address. The use of the outside local address is outside the scope of this course. </p> <p>The "inside" of a NAT configuration is not synonymous with private addresses as defined by RFC 1918. What we call "non-routable" addresses are not always unroutable. An administrator can configure any router to pass traffic over private subnets. However, if they try to pass a packet to the ISP for any private address, the ISP drops it. Non-routable means not routable on the Internet.</p></content-text>
</page>
<page type="OneColumn" id="en1407020202">
<content-media type="AnimationPartialScreen" id="cm8593325160">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020200/en1407020202/cm8593325160.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020200/en1407020202/cm8593325160text.xml"/></content-media>
<content-text><p><b>How Does NAT Work?</b></p> <p>In this example, an inside host (192.168.10.10) wants to communicate with an outside web server (209.165.200.1). It sends a packet to R2, the NAT-configured border gateway for the network.</p> <p><b>Use the controls on the figure to start the animation.</b></p> <p>R2 reads the destination IP address of the packet and checks if the packet matches the criteria specified for translation. R2 has an ACL that identifies the inside network as valid hosts for translation. Therefore, it translates an inside local IP address to an inside global IP address, which in this case is 209.165.200.226. It stores this mapping of the local to global address in the NAT table.</p> <p>The router then sends the packet to its destination. When the web server responds, the packet comes back to the global address of R2 (209.165.200.226).</p> <p>R2 refers to its NAT table and sees that this was a previously translated IP address. Therefore, it translates the inside global address to the inside local address, and the packet is forwarded to PC1 at IP address 192.168.10.10. If it does not find a mapping, the packet is dropped.</p> <p><b>Dynamic Mapping and Static Mapping</b> </p> <p>There are two types of NAT translation: dynamic and static. </p> <p>Dynamic NAT uses a pool of public addresses and assigns them on a first-come, first-served basis. When a host with a private IP address requests access to the Internet, dynamic NAT chooses an IP address from the pool that is not already in use by another host. This is the mapping described so far.</p> <p>Static NAT uses a one-to-one mapping of local and global addresses, and these mappings remain constant. Static NAT is particularly useful for web servers or hosts that must have a consistent address that is accessible from the Internet. These internal hosts may be enterprise servers or networking devices. </p> <p>Both static and dynamic NAT require that enough public addresses are available to satisfy the total number of simultaneous user sessions.</p> <p>For another look at how dynamic NAT works, go to <content-link target="http://www.cisco.com/warp/public/556/nat.swf" type="external">http://www.cisco.com/warp/public/556/nat.swf</content-link>.</p></content-text>
</page>
<page type="OneColumn" id="en1407020203">
<content-media type="AnimationPartialScreen" id="cm5460638819">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020200/en1407020203/cm5460638819.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020200/en1407020203/cm5460638819text.xml"/></content-media>
<content-text><p><b>NAT Overload</b></p> <p>NAT overloading (sometimes called Port Address Translation or PAT) maps multiple private IP addresses to a single public IP address or a few addresses. This is what most home routers do. Your ISP assigns one address to your router, yet several members of your family can simultaneously surf the Internet.</p> <p>With NAT overloading, multiple addresses can be mapped to one or to a few addresses because each private address is also tracked by a port number. When a client opens a TCP/IP session, the NAT router assigns a port number to its source address. NAT overload ensures that clients use a different TCP port number for each client session with a server on the Internet. When a response comes back from the server, the source port number, which becomes the destination port number on the return trip, determines to which client the router routes the packets. It also validates that the incoming packets were requested, thus adding a degree of security to the session. </p> <p><b>Click the controls to start and pause the animation.</b></p> <p>The animation illustrates the process. NAT overload uses unique source port numbers on the inside global IP address to distinguish between translations. As NAT processes each packet, it uses a port number (1331 and 1555 in this example) to identify the client from which the packet originated. The source address (SA) is the inside local IP address with the TCP/IP assigned port number attached. The destination address (DA) is the outside local IP address with the service port number attached, in this case port 80: HTTP.</p> <p>At the border gateway router (R2), NAT overload changes the SA to the inside global IP address of the client, again with the port number attached. The DA is the same address, but is now referred to as the outside global IP address. When the web server replies, the same path is followed but in reverse.</p> <p>Port numbers are encoded in 16 bits. The total number of internal addresses that can be translated to one external address could theoretically be as high as 65,536 per IP address. However, realistically, the number of internal addresses that can be assigned a single IP address is around 4,000. </p> <p><b>Click the Next Available Port button in the figure.</b></p> <p>In the previous example, the client port numbers in the two SAs, 1331 and 1555, do not change at the border gateway. This is not a very likely scenario because there is a good chance that these numbers may have already been attached to other ongoing sessions. </p> <p>NAT overload attempts to preserve the original source port. However, if this source port is already used, NAT overload assigns the first available port number starting from the beginning of the appropriate port group 0-511, 512-1023, or 1024-65535. When there are no more ports available and there is more than one external IP address configured, NAT overload moves to the next IP address to try to allocate the original source port again. This process continues until it runs out of available ports and external IP addresses. </p> <p>In the figure, both hosts have somehow chosen the same port number 1444. This is acceptable for the inside address, because they both have unique private IP addresses. However, at the border gateway, the port numbers need to be changed-otherwise, two packets from two hosts would leave R2 with the same source address. NAT overload has given the second address the first available port number, which in this case happens to be 1445.</p> <p><b>Differences Between NAT and NAT Overload</b></p> <p>Summarizing the differences between NAT and NAT overload will help your understanding. NAT generally only translates IP addresses on a 1:1 correspondence between publicly exposed IP addresses and privately held IP addresses. NAT overload modifies both the private IP address and port number of the sender. NAT overload chooses the port numbers seen by hosts on the public network.</p> <p>NAT routes incoming packets to their inside destination by referring to the incoming source IP address given by the host on the public network. With NAT overload, there is generally only one or a very few publicly exposed IP addresses. Incoming packets from the public network are routed to their destinations on the private network by referring to a table in the NAT overload device that tracks public and private port pairs. This is called connection tracking.</p></content-text>
</page>
</topic>
<topic type="" id="en1407020300">
<title><content-text>Benefits and Drawbacks of Using NAT</content-text></title>
<page type="OneColumn" id="en1407020301">
<content-media type="StaticGraphic" id="cm1263669050">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020300/en1407020301/cm1263669050.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020300/en1407020301/cm1263669050text.xml"/></content-media>
<content-text><p><b>Benefits and Drawbacks of Using NAT</b></p> <p>NAT provides many benefits and advantages. However, there are some drawbacks to using NAT, including the lack of support for some types of traffic. </p> <p>The benefits of using NAT include the following:</p> <p><ul><li>NAT conserves the legally registered addressing scheme by allowing the privatization of intranets. NAT conserves addresses through application port-level multiplexing. With NAT overload, internal hosts can share a single public IP address for all external communications. In this type of configuration, very few external addresses are required to support many internal hosts.</li><li>NAT increases the flexibility of connections to the public network. Multiple pools, backup pools, and load-balancing pools can be implemented to ensure reliable public network connections. </li><li>NAT provides consistency for internal network addressing schemes. On a network without private IP addresses and NAT, changing public IP addresses requires the renumbering of all hosts on the existing network. The costs of renumbering hosts can be significant. NAT allows the existing scheme to remain while supporting a new public addressing scheme. This means an organization could change ISPs and not need to change any of its inside clients. </li><li>NAT provides network security. Because private networks do not advertise their addresses or internal topology, they remain reasonably secure when used in conjunction with NAT to gain controlled external access. However, NAT does not replace firewalls.</li></ul></p> <p>However, NAT does have some drawbacks. The fact that hosts on the Internet appear to communicate directly with the NAT device, rather than with the actual host inside the private network, creates a number of issues. In theory, a single globally unique IP address can represent many privately addressed hosts. This has advantages from a privacy and security point of view, but in practice, there are drawbacks. </p> <p>The first disadvantage affects performance. NAT increases switching delays because the translation of each IP address within the packet headers takes time. The first packet is process-switched, meaning it always goes through the slower path. The router must look at every packet to decide whether it needs translation. The router needs to alter the IP header, and possibly alter the TCP or UDP header. Remaining packets go through the fast-switched path if a cache entry exists; otherwise, they too are delayed.</p> <p>Many Internet protocols and applications depend on end-to-end functionality, with unmodified packets forwarded from the source to the destination. By changing end-to-end addresses, NAT prevents some applications that use IP addressing. For example, some security applications, such as digital signatures, fail because the source IP address changes. Applications that use physical addresses instead of a qualified domain name do not reach destinations that are translated across the NAT router. Sometimes, this problem can be avoided by implementing static NAT mappings.</p> <p>End-to-end IP traceability is also lost. It becomes much more difficult to trace packets that undergo numerous packet address changes over multiple NAT hops, making troubleshooting challenging. On the other hand, hackers who want to determine the source of a packet find it difficult to trace or obtain the original source or destination address.</p>  <p>Using NAT also complicates tunneling protocols, such as IPsec, because NAT modifies values in the headers that interfere with the integrity checks done by IPsec and other tunneling protocols.</p> <p>Services that require the initiation of TCP connections from the outside network, or stateless protocols such as those using UDP, can be disrupted. Unless the NAT router makes a specific effort to support such protocols, incoming packets cannot reach their destination. Some protocols can accommodate one instance of NAT between participating hosts (passive mode FTP, for example), but fail when both systems are separated from the Internet by NAT. </p></content-text>
</page>
</topic>
<topic type="" id="en1407020400">
<title><content-text>Configuring Static NAT</content-text></title>
<page type="OneColumn" id="en1407020401">
<content-media type="StaticGraphic" id="cm6012058594">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020400/en1407020401/cm6012058594.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020400/en1407020401/cm6012058594text.xml"/></content-media>
<content-text><p><b>Static NAT</b></p> <p>Remember that static NAT is a one-to-one mapping between an inside address and an outside address. Static NAT allows connections initiated by external devices to inside devices. For instance, you may want to map an inside global address to a specific inside local address that is assigned to your web server.</p> <p>Configuring static NAT translations is a simple task. You need to define the addresses to translate and then configure NAT on the appropriate interfaces.Packets arriving on an inside interface from the identified IP address are subject to translation. Packets arriving on an outside interface addressed to the identified IP address are subject to translation.</p> <p>The figure explains the commands for the steps. You enter static translations directly into the configuration. Unlike dynamic translations, these translations are always in the NAT table.</p> <p><b>Click the Example button in the figure.</b></p> <p>The figure is a simple static NAT configuration applied to both interfaces. The router always translates packets from the host inside the network with the private address of 192.168.10.254 into an outside address of 209.165.200.254. The host on the Internet directs web requests to the public IP address 209.165.200.254, and router R2 always forwards that traffic to the server at 192.168.10.254.</p></content-text>
</page>
</topic>
<topic type="" id="en1407020500">
<title><content-text>Configuring Dynamic NAT</content-text></title>
<page type="OneColumn" id="en1407020501">
<content-media type="StaticGraphic" id="cm3410388548">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020500/en1407020501/cm3410388548.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020500/en1407020501/cm3410388548text.xml"/></content-media>
<content-text><p><b>Configuring Dynamic NAT</b></p> <p>While static NAT provides a permanent mapping between an internal address and a specific public address, dynamic NAT maps private IP addresses to public addresses. These public IP addresses come from a NAT pool. Dynamic NAT configuration differs from static NAT, but it also has some similarities. Like static NAT, it requires the configuration to identify each interface as an inside or outside interface. However, rather than creating a static map to a single IP address, a pool of inside global addresses is used.</p> <p><b>Click the Commands button in the figure</b> for the steps to configure dynamic NAT.</p> <p>To configure dynamic NAT, you need an ACL to permit only those addresses that are to be translated. When developing your ACL, remember there is an implicit "deny all" at the end of each ACL. An ACL that is too permissive can lead to unpredictable results. Cisco advises against configuring access contol lists referenced by NAT commands with the <span class="cmd"><b>permit any</b></span> command. Using <span class="cmd"><b>permit any</b></span> can result in NAT consuming too many router resources, which can cause network problems.</p> <p><b>Click the Example button in the figure.</b></p> <p>This configuration allows translation for all hosts on the 192.168.10.0 and 192.168.11.0 networks when they generate traffic that enters S0/0/0 and exits S0/1/0. These hosts are translated to an available address in the 209.165.200.226 - 209.165.200.240 range.</p></content-text>
</page>
</topic>
<topic type="" id="en1407020600">
<title><content-text>Configuring NAT Overload</content-text></title>
<page type="OneColumn" id="en1407020601">
<content-media type="StaticGraphic" id="cm2876755097">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020600/en1407020601/cm2876755097.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020600/en1407020601/cm2876755097text.xml"/></content-media>
<content-text><p><b>Configuring NAT Overload for a Single Public IP Address</b></p> <p>There are two possible ways to configure overloading, depending on how the ISP allocates public IP addresses. In the first instance, the ISP allocates one public IP address to the organization, and in the other, it allocates more than one public IP address.</p> <p>The figure shows the steps to follow to configure NAT overload with a single IP address. With only one public IP address, the overload configuration typically assigns that public address to the outside interface that connects to the ISP. All inside addresses are translated to the single IP address when leaving the outside interface. </p> <p><b>Click the Commands button in the figure</b> for the steps to configure NAT overload.</p> <p>The configuration is similar to dynamic NAT, except that instead of a pool of addresses, the <span class="cmd"><b>interface</b></span> keyword is used to identify the outside IP address. Therefore, no NAT pool is defined. The <span class="cmd"><b>overload</b></span> keyword enables the addition of the port number to the translation.</p> <p><b>Click the Example button in the figure.</b></p> <p>This example shows how NAT overload is configured. In the example, all hosts from network 192.168.0.0 /16 (matching ACL 1) sending traffic through router R2 to the Internet are translated to IP address 209.165.200.225 (interface S0/1/0 IP address). The traffic flows are identified by port numbers, because the <span class="cmd"><b>overload</b></span> keyword was used.</p></content-text>
</page>
<page type="OneColumn" id="en1407020602">
<content-media type="StaticGraphic" id="cm3955055025">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020600/en1407020602/cm3955055025.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020600/en1407020602/cm3955055025text.xml"/></content-media>
<content-text><p><b>Configuring NAT Overload for a Pool of Public IP Addresses</b></p> <p>In the scenario where the ISP has provided more than one public IP address, NAT overload is configured to use a pool. The primary difference between this configuration and the configuration for dynamic, one-to-one NAT is that the <span class="cmd"><b>overload</b></span> keyword is used. Remember that the <span class="cmd"><b>overload</b></span> keyword enables port address translation.</p> <p><b>Click the Commands button in the figure</b> for the stpes to configure NAT overload using a pool of addresses. </p> <p><b>Click the Example button in the figure.</b></p> <p>In this example, the configuration establishes overload translation for NAT pool NAT-POOL2. The NAT pool contains addresses 209.165.200.226 - 209.165.200.240 and is translated using PAT. Hosts in the 192.168.0.0 /16 network are subject to translation. Finally, the inside and outside interfaces are identified.</p></content-text>
</page>
</topic>
<topic type="" id="en1407020700">
<title><content-text>Configuring Port Forwarding</content-text></title>
<page type="OneColumn" id="en1407020701">
<content-media type="StaticGraphic" id="cm4925881261">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020700/en1407020701/cm4925881261.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020700/en1407020701/cm4925881261text.xml"/></content-media>
<content-text><p><b>Port Forwarding </b></p> <p>Port forwarding (sometimes referred to as tunneling) is the act of forwarding a network port from one network node to another. This technique can allow an external user to reach a port on a private IP address (inside a LAN) from the outside through a NAT-enabled router. </p> <p>Typically, peer-to-peer file-sharing programs and key operations, such as web serving and outgoing FTP, require that router ports be forwarded or opened to allow these applications to work. Because NAT hides internal addresses, peer-to-peer only works from the inside out where NAT can map register outgoing requests against incoming replies. </p> <p>The problem is that NAT does not allow requests initiated from the outside. This situation can be resolved with manual intervention. Port forwarding allows you to identify specific ports that can be forwarded to inside hosts.</p> <p>Recall that Internet software applications interact with user ports that need to be open or available to those applications. Different applications use different ports. For example, Telnet uses port 23, FTP uses ports 20 and 21, HTTP port 80, and SMTP uses port 25. This makes it predictable for applications and routers to identify network services. For example, HTTP operates through the well-known port 80. When you enter the address http://cisco.com, the browser displays the Cisco Systems, Inc. website. Notice that we do not have to specify the HTTP port number for the page requests because the application assumes port 80. </p> <p><b>Configuring Port Forwarding </b></p> <p>Port forwarding allows users on the Internet to access internal servers by using the WAN port address and the matched external port number. When users send these types of requests to your WAN port IP address via the Internet, the router forwards those requests to the appropriate servers on your LAN. For security reasons, broadband routers do not by default permit any external network request to be forwarded to an inside host. </p> <p>For instance, the figure is displaying the Single Port Forwarding window of a Linksys WVRS4400N business-class SOHO router. Currently, port forwarding is not configured. </p> <p><b>Click the Port Forwarding Example button in the figure.</b></p> <p>You can enable port forwarding for applications and specify the inside local address to forward the request to. For example, in the figure, HTTP service requests coming into this Linksys is now forwarded to the web server with the inside local address of 192.168.1.254. If the external WAN IP address of the SOHO router is 209.165.200.158, the external user could enter http://209.165.202.158 and the Linksys router would redirect the HTTP request to the internal web server at IP address 192.168.1.254, using the default port number 80.</p> <p>We could specify a port different from the default port 80. However, the external user would have to know the specific port number to use. </p> <p>The approach you take to configure port forwarding depends on the brand and model of the broadband router in the network. However, there are some generic steps to follow. If the instructions supplied by your ISP or that came with the router do not provide adequate guidance, the website <content-link target="http://www.portforward.com/" type="external">www.portforward.com</content-link> provides guides for several broadband routers. You can follow the instructions to add or delete ports as required to meet the needs of any applications you want to allow or deny. </p></content-text>
</page>
</topic>
<topic type="" id="en1407020800">
<title><content-text>Verifying and Troubleshooting NAT Configurations</content-text></title>
<page type="OneColumn" id="en1407020801">
<content-media type="StaticGraphic" id="cm7432783830">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020800/en1407020801/cm7432783830.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020800/en1407020801/cm7432783830text.xml"/></content-media>
<content-text><p><b>Verifying NAT and NAT Overload</b></p> <p>It is important to verify NAT operation. There are several useful router commands to view and clear NAT translations. This topic explains how to verify NAT operation using tools available on Cisco routers.</p> <p>One of the most useful commands when verifying NAT operation is the <span class="cmd"><b>show ip nat translations</b></span> command. Before using the <span class="cmd"><b>show</b></span> commands to verify NAT, you must clear any dynamic translation entries that might still be present, because by default, dynamic address translations time out from the NAT translation table after a period of non-use. </p> <p>In the figure, router R2 has been configured to provide NAT overload to the 192.168.0.0 /16 clients. When the internal hosts exit router R2 to the Internet, they are translated to the IP address of the serial interface with a unique source port number. </p> <p>Assume that the two hosts in the internal network have been accessing web services from the Internet. </p> <p><b>Click on the NAT Translations button in the figure.</b></p> <p>Notice that the output of the <span class="cmd"><b>show ip nat translations</b></span> command displays the details of the two NAT assignments. Adding <span class="cmd"><b>verbose</b></span> to the command displays additional information about each translation, including how long ago the entry was created and used.</p> <p>The command displays all static translations that have been configured as well as any dynamic translations that have been created by traffic. Each translation is identified by protocol as well as inside and outside local and global addresses.</p> <p> </p> <p><b>Click on the NAT Statistics button in the figure.</b></p> <p>The <span class="cmd"><b>show ip nat statistics</b></span> command displays information about the total number of active translations, NAT configuration parameters, how many addresses are in the pool, and how many have been allocated.</p> <p>In the figure, the hosts have initiated web traffic as well as ICMP traffic. </p> <p>Alternatively, use the <span class="cmd"><b>show run</b></span> command and look for NAT, access command list, interface, or pool commands with the required values. Examine these carefully and correct any errors you discover.</p> <p>By default, translation entries time out after 24 hours, unless the timers have been reconfigured with the <span class="cmd"><b>ip nat translation timeout</b> <i>timeout_ seconds</i></span> command in global configuration mode. </p> <p> </p> <p><b>Click the Cleared NAT button in the figure.</b></p> <p>It is sometimes useful to clear the dynamic entries sooner than the default. This is especially true when testing the NAT configuration. To clear dynamic entries before the timeout has expired, use the <span class="cmd"><b>clear ip nat translation</b></span> global command. </p> <p>The table in the figure is displaying the various ways to clear the NAT translations. You can be very specific about which translation to clear, or you can clear all translations from the table using the <span class="cmd"><b>clear ip nat translation *</b></span> global command, as shown in the example. </p> <p>Only the dynamic translations are cleared from the table. Static translations cannot be cleared from the translation table.</p></content-text>
</page>
<page type="OneColumn" id="en1407020802">
<content-media type="StaticGraphic" id="cm8529346800">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020800/en1407020802/cm8529346800.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407020000/en1407020800/en1407020802/cm8529346800text.xml"/></content-media>
<content-text><p><b>Troubleshooting NAT and NAT Overload Configuration</b></p> <p>When you have IP connectivity problems in a NAT environment, it is often difficult to determine the cause of the problem. The first step in solving your problem is to rule out NAT as the cause. Follow these steps to verify that NAT is operating as expected:</p> <p><b>Step 1.</b> Based on the configuration, clearly define what NAT is supposed to achieve. This may reveal a problem with the configuration.</p> <p><b>Step 2.</b> Verify that correct translations exist in the translation table using the <span class="cmd"><b>show ip nat translations</b></span> command.</p> <p><b>Step 3.</b> Use the <span class="cmd"><b>clear</b></span> and <span class="cmd"><b>debug</b></span> commands to verify that NAT is operating as expected. Check to see if dynamic entries are recreated after they are cleared.</p> <p><b>Step 4.</b> Review in detail what is happening to the packet, and verify that routers have the correct routing information to move the packet.</p> <p>Use the <span class="cmd"><b>debug ip nat</b></span> command to verify the operation of the NAT feature by displaying information about every packet that is translated by the router. The <span class="cmd"><b>debug ip nat detailed</b></span> command generates a description of each packet considered for translation. This command also outputs information about certain errors or exception conditions, such as the failure to allocate a global address.</p> <p>The figure shows a sample <span class="cmd"><b>debug ip nat</b></span> output. In the output you can see that inside host 192.168.10.10 initiated traffic to outside host 209.165.200.254 and has been translated to address 209.165.200.225. </p> <p>When decoding the debug output, note what the following symbols and values indicate: </p> <p><ul><li><b>*</b> - The asterisk next to NAT indicates that the translation is occurring in the fast-switched path. The first packet in a conversation is always process-switched, which is slower. The remaining packets go through the fast-switched path if a cache entry exists. </li><li><b>s=</b> - Refers to the source IP address. </li><li><b>a.b.c.d--->w.x.y.z</b> - Indicates that source address a.b.c.d is translated to w.x.y.z. </li><li><b>d=</b> - Refers to the destination IP address. </li><li><b>[xxxx]</b> - The value in brackets is the IP identification number. This information may be useful for debugging in that it enables correlation with other packet traces from protocol analyzers. </li></ul></p> <p>You can view the following demonstrations about verifying and troubleshooting NAT at these sites:</p> <p>Flash Animation Case Study: Can Ping Host, but Cannot Telnet: This is a seven-minute Flash animation on why a device can ping the host, but cannot telnet: <content-link target="http://www.cisco.com/warp/public/556/index.swf" type="external">http://www.cisco.com/warp/public/556/index.swf</content-link>. </p> <p>Flash Animation Case Study: Cannot Ping Beyond NAT: This is a ten-minute Flash animation on why a device cannot ping beyond NAT: <content-link target="http://www.cisco.com/warp/public/556/TS_NATcase2/index.swf" type="external">http://www.cisco.com/warp/public/556/TS_NATcase2/index.swf</content-link>.</p></content-text>
</page>
<page type="OneColumn" id="en1407020803">
<content-media type="ActivityPKA" id="cm7730771414">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407020000/en1407020800/en1407020803/cm7730771414/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407020000/en1407020800/en1407020803/cm7730771414/icontext.xml"/></content-media>
<content-text><p>NAT translates non-routable private, internal addresses into routable, public addresses. NAT has an added benefit of providing a degree of privacy and security to a network because it hides internal IP addresses from outside networks. In this activity, you will configure dynamic and static NAT.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E4_PTAct_7_2_8.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="en1407030000">
<title><content-text>IPv6</content-text></title>
<topic type="" id="en1407030100">
<title><content-text>Reasons for Using IPv6</content-text></title>
<page type="OneColumn" id="en1407030101">
<content-media type="InteractiveGraphicHotspots" id="cm5084072158">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030100/en1407030101/cm5084072158.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030100/en1407030101/cm5084072158text.xml"/></content-media>
<content-text><p><b>Why We Need More Address Space</b></p> <p>To comprehend the IP addressing issues facing network administrators today, consider that the IPv4 address space provides approximately 4,294,967,296 unique addresses. Of these, only 3.7 billion addresses are assignable because the IPv4 addressing system separates the addresses into classes and reserves addresses for multicasting, testing, and other specific uses.</p> <p>Based on figures as recent as January 2007, about 2.4 billion of the available IPv4 addresses are already assigned to end users or ISPs. That leaves roughly 1.3 billion addresses still available from the IPv4 address space. Despite this seemingly large number, IPv4 address space is running out. </p> <p><b>Click the play button in the figure</b> to see just how fast this has happened over the past 14 years.</p> <p>Over the past decade, the Internet community has analyzed IPv4 address exhaustion and published mountains of reports. Some reports predict IPv4 address exhaustion by 2010, and others say it will not happen until 2013. </p> <p><b>Click the Shrinking button in the figure </b>to see how the available address space is shrinking.</p> <p>The growth of the Internet, matched by increasing computing power, has extended the reach of IP-based applications. </p> <p><b>Click the Why IPv6 button in the figure </b>and consider what is forcing a change to IPv6. </p> <p>The pool of numbers is shrinking for the following reasons:</p> <p><ul><li><b>Population growth</b> - The Internet population is growing. In November 2005, Cisco estimated that there were approximately 973 million users. This number has doubled since then. In addition, users stay on longer, reserving IP addresses for longer periods and are contacting more and more peers daily.</li><li><b>Mobile users</b> - Industry has delivered more than one billion mobile phones. More than 20 million IP-enabled mobile devices, including <content-link target="{BC13802E-F3CA-41B0-AFD7-30D8C2EDF019}" type="glossary">personal digital assistants</content-link> (<content-link target="{CF04F531-2FED-4CAF-9318-56BECA3BF996}" type="glossary">PDAs</content-link>), pen tablets, notepads, and barcode readers, have been delivered. More and more IP-enabled mobile devices are coming online every day. Old mobile phones did not need IP addresses, but new ones do.</li><li><b>Transportation</b> - There will be more than one billion automobiles by 2008. Newer models are IP-enabled to allow remote monitoring to provide timely maintenance and support. Lufthansa already provides Internet connectivity on their flights. More carriers, including ships at sea, will provide similar services.</li><li><b>Consumer electronics</b> - The newest home appliances allow remote monitoring using IP technology. Digital Video Recorders (DVRs) that download and update program guides from the Internet are an example. Home networking can connect these appliances. </li></ul></p></content-text>
</page>
<page type="OneColumn" id="en1407030102">
<content-media type="InteractiveGraphicHotspots" id="cm7560691137">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030100/en1407030102/cm7560691137.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030100/en1407030102/cm7560691137text.xml"/></content-media>
<content-text><p><b>Reasons for Using IPv6</b></p> <p>Movement to change from IPv4 to IPv6 has already begun, particularly in Europe, Japan, and the Asia-Pacific region. These areas are exhausting their allotted IPv4 addresses, which makes IPv6 all the more attractive and necessary. Japan officially started the move in 2000 when the Japanese government mandated the incorporation of IPv6 and set a deadline of 2005 to upgrade existing systems in every business and public sector. Korea, China, and Malaysia have launched similar initiatives. </p> <p>In 2002, the European Community IPv6 Task Force forged a strategic alliance to foster IPv6 adoption worldwide. The North American IPv6 Task Force has set out to engage the North American markets to adopt IPv6. The first significant North American advances are coming from the U.S. <content-link target="{62CEF1AB-ED20-4C1C-9628-51589EF1CE1F}" type="glossary">Department of Defense</content-link> (<content-link target="{AE4224F3-7DB9-4E61-BFBF-C195E1251D86}" type="glossary">DoD</content-link>). Looking into the future and knowing the advantages of IP-enabled devices, DoD mandated, as early as 2003, that all new equipment purchased not only be IP-enabled, but also be IPv6-capable. In fact, all U.S. government agencies must start using IPv6 across their core networks by 2008, and the agencies are working to meet that deadline. </p> <p>The ability to scale networks for future demands requires a limitless supply of IP addresses and improved mobility that DHCP and NAT alone cannot meet. IPv6 satisfies the increasingly complex requirements of hierarchical addressing that IPv4 does not provide. </p> <p>Given the huge installed base of IPv4 in the world, it is not difficult to appreciate that transitioning to IPv6 from IPv4 deployments is a challenge. There are, however, a variety of techniques, including an auto-configuration option, to make the transition easier. The transition mechanism you use depends on the needs of your network.</p> <p>The figure compares the binary and alphanumeric representations of IPv4 and IPv6 addresses. An IPv6 address is a 128-bit binary value, which can be displayed as 32 hexadecimal digits. IPv6 should provide sufficient addresses for future Internet growth needs for many years to come. There are enough IPv6 addresses to allocate more than the entire IPv4 Internet address space to everyone on the planet.</p> <p><b>Click the Perspective buton in the figure.</b></p> <p>So what happened to IPv5? IPv5 was used to define an experimental real-time streaming protocol. To avoid any confusion, it was decided to not use IPv5 and name the new IP protocol IPv6.</p></content-text>
</page>
<page type="OneColumn" id="en1407030103">
<content-media type="InteractiveGraphicHotspots" id="cm9648652735">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030100/en1407030103/cm9648652735.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030100/en1407030103/cm9648652735text.xml"/></content-media>
<content-text><p>IPv6 would not exist were it not for the recognized depletion of available IPv4 addresses. However, beyond the increased IP address space, the development of IPv6 has presented opportunities to apply lessons learned from the limitations of IPv4 to create a protocol with new and improved features. </p> <p>A simplified header architecture and protocol operation translates into reduced operational expenses. Built-in security features mean easier security practices that are sorely lacking in many current networks. However, perhaps the most significant improvement offered by IPv6 is the address autoconfiguration features it has. </p> <p>The Internet is rapidly evolving from a collection of stationary devices to a fluid network of mobile devices. IPv6 allows mobile devices to quickly acquire and transition between addresses as they move among foreign networks, with no need for a foreign agent. (A foreign agent is a router that can function as the point of attachment for a mobile device when it roams from its home network to a foreign network.) </p> <p>Address autoconfiguration also means more robust plug-and-play network connectivity. Autoconfiguration supports consumers who can have any combination of computers, printers, digital cameras, digital radios, IP phones, Internet-enabled household appliances, and robotic toys connected to their home networks. Many manufacturers already integrate IPv6 into their products.</p> <p>Many of the enhancements that IPv6 offers are explained in this section, including:</p> <p><ul><li>Enhanced IP addressing</li><li>Simplified header</li><li>Mobility and security </li><li>Transition richness</li></ul></p> <p><b>Enhanced IP Addressing</b></p> <p>A larger address space offers several enhancements, including: </p> <p><ul><li>Improved global reachability and flexibility.</li><li>Better aggregation of IP prefixes announced in routing tables.</li><li><content-link target="{96D0E7A6-DD4B-43FD-9C6A-060803CD1AD7}" type="glossary">Multihomed hosts</content-link>. <content-link target="{0BC056D0-4854-4C7F-8F78-5712244B6673}" type="glossary">Multihoming</content-link> is a technique to increase the reliability of the Internet connection of an IP network. With IPv6, a host can have multiple IP addresses over one physical upstream link. For example, a host can connect to several ISPs.</li><li>Autoconfiguration that can include Data Link layer addresses in the address space.</li><li>More plug-and-play options for more devices.</li><li>Public-to-private, end-to-end readdressing without address translation. This makes peer-to-peer (P2P) networking more functional and easier to deploy.</li><li>Simplified mechanisms for address renumbering and modification.</li></ul></p> <p><b>Click the Simple Header button in the figure.</b></p> <p>The figure compares the simplified IPv6 header structure to the IPv4 header. The IPv4 header has 20 octets and 12 basic header fields, followed by an options field and a data portion (usually the <content-link target="{3813DE36-B20A-4CED-834A-BAF0BBBA1474}" type="glossary">Transport layer</content-link> segment). The IPv6 header has 40 octets, three IPv4 basic header fields, and five additional header fields. </p> <p>The IPv6 simplified header offers several advantages over IPv4: </p> <p><ul><li>Better routing efficiency for performance and forwarding-rate scalability</li><li>No broadcasts and thus no potential threat of broadcast storms</li><li>No requirement for processing checksums</li><li>Simplified and more efficient extension header mechanisms</li><li>Flow labels for per-flow processing with no need to open the transport inner packet to identify the various traffic flows</li></ul></p> <p><b>Enhanced Mobility and Security</b></p> <p>Mobility and security help ensure compliance with <content-link target="{01D9F02E-61C1-4D40-9704-C1D6CFC0B8D4}" type="glossary">mobile IP</content-link> and IP Security (IPsec) standards functionality. Mobility enables people with mobile network devices-many with wireless connectivity-to move around in networks.</p> <p><ul><li>The IETF Mobile IP standard is available for both IPv4 and IPv6. The standard enables mobile devices to move without breaks in established network connections. Mobile devices use a home address and a care-of address to achieve this mobility. With IPv4, these addresses are manually configured. With IPv6, the configurations are dynamic, giving Ipv6-enabled devices built-in mobility.</li><li>IPsec is available for both IPv4 and IPv6. Although the functionalities are essentially identical in both environments, IPsec is mandatory in IPv6, making the IPv6 Internet more secure. </li></ul></p> <p><b>Transition Richness</b></p> <p>IPv4 will not disappear overnight. Rather, it will coexist with and then gradually be replaced by IPv6. For this reason, IPv6 was delivered with migration techniques to cover every conceivable IPv4 upgrade case. However, many were ultimately rejected by the technology community. </p> <p>Currently, there are three main approaches:</p> <p><ul><li><content-link target="{5A031F62-DB2B-48CE-B80C-76DCB2E7D508}" type="glossary">Dual stack</content-link> </li><li><content-link target="{B1567C90-CA76-41D5-B8C9-9C429E35C2E3}" type="glossary">6to4</content-link> tunneling </li><li>NAT-PT, <content-link target="{69BFF587-F4F9-46D6-B107-2206D93FDF74}" type="glossary">ISATAP</content-link> tunneling, and <content-link target="{7C12AA82-1FCF-4BF4-8866-726DB4A139F0}" type="glossary">Teredo</content-link> tunneling (last resort methods)</li></ul></p> <p>Some of these approaches are discussed in more detail later in the chapter. </p> <p>The current advice for transitioning to IPv6 is "Dual stack where you can, tunnel where you must!"</p></content-text>
</page>
</topic>
<topic type="" id="en1407030200">
<title><content-text>IPv6 Addressing</content-text></title>
<page type="OneColumn" id="en1407030201">
<content-media type="StaticGraphic" id="cm9707697458">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030200/en1407030201/cm9707697458.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030200/en1407030201/cm9707697458text.xml"/></content-media>
<content-text><p><b>IPv6 Address Representation</b></p> <p>You know the 32-bit IPv4 address as a series of four 8-bit fields, separated by dots. However, larger 128-bit IPv6 addresses need a different representation because of their size. IPv6 addresses use colons to separate entries in a series of 16-bit hexadecimal. </p> <p><b>Click the Representation button in the figure. </b></p> <p>The figure shows the address <b>2031:0000:130F:0000:0000:09C0:876A:130B</b>. IPv6 does not require explicit address string notation. The figure shows how to shorten the address by applying the following guidelines:</p> <p><ul><li>Leading zeros in a field are optional. For example, the field 09C0 equals 9C0, and the field 0000 equals 0. So 2031:<b>0000</b>:130F:0000:0000:<b>09C0</b>:876A:130B can be written as 2031:<b>0</b>:130F:0000:0000:<b>9C0</b>:876A:130B.</li><li>Successive fields of zeros can be represented as two colons "::". However, this shorthand method can only be used once in an address. For example 2031:0:130F:<b>0000</b>:<b>0000</b>:9C0:876A:130B can be written as 2031:0:130F::9C0:876A:130B.</li><li>An unspecified address is written as "::" because it contains only zeros.</li></ul></p> <p>Using the "::" notation greatly reduces the size of most addresses as shown. An address parser identifies the number of missing zeros by separating any two parts of an address and entering 0s until the 128 bits are complete.</p> <p><b>Click the Examples button in the figure</b> for some additional examples.</p></content-text>
</page>
<page type="OneColumn" id="en1407030202">
<content-media type="InteractiveGraphicHotspots" id="cm7203451769">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030200/en1407030202/cm7203451769.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030200/en1407030202/cm7203451769text.xml"/></content-media>
<content-text><p><b>IPv6 Global Unicast Address</b></p> <p>IPv6 has an address format that enables aggregation upward eventually to the ISP. <content-link target="{49C1C003-C9B7-4CB4-AA14-3048046FCBBE}" type="glossary">Global unicast addresses</content-link> typically consists of a 48-bit global routing prefix and a 16-bit subnet ID. Individual organizations can use a 16-bit subnet field to create their own local addressing hierarchy. This field allows an organization to use up to 65,535 individual subnets.</p> <p>At the top of the figure, it can be seen how additional hierarchy is added to the 48-bit global routing prefix with the registry prefix, ISP Prefix, and site prefix. </p> <p>The current global unicast address that is assigned by the <content-link target="{38055F33-7CF2-40FC-808E-01A24C982FBE}" type="glossary">IANA</content-link> uses the range of addresses that start with binary value 001 (2000::/3), which is 1/8 of the total IPv6 address space and is the largest block of assigned addresses. The IANA is allocating the IPv6 address space in the ranges of 2001::/16 to the five RIR registries (ARIN, RIPE, APNIC, LACNIC, and AfriNIC). </p> <p>For more information, refer to RFC 3587, IPv6 Global Unicast Address Format, which replaces RFC 2374.</p> <p><b>Reserved Addresses</b></p> <p>The IETF reserves a portion of the IPv6 address space for various uses, both present and future. Reserved addresses represent 1/256th of the total IPv6 address space. Some of the other types of IPv6 addresses come from this block.</p> <p><b>Private Addresses</b></p> <p>A block of IPv6 addresses is set aside for private addresses, just as is done in IPv4. These private addresses are local only to a particular link or site, and are therefore never routed outside of a particular company network. Private addresses have a first octet value of "FE" in hexadecimal notation, with the next hexadecimal digit being a value from 8 to F. </p> <p>These addresses are further divided into two types, based upon their scope.</p> <p><ul><li><b>Site-local addresses</b>, are addresses similar to the RFC 1918 Address Allocation for Private Internets in IPv4 today. The scope of these addresses is an entire site or organization. However, the use of site-local addresses is problematic and is being deprecated as of 2003 by RFC 3879. In hexadecimal, site-local addresses begin with "FE" and then "C" to "F" for the third hexadecimal digit. So, these addresses begin with "FEC", "FED", "FEE", or "FEF".</li><li><b><content-link target="{6377B8ED-80CC-4001-9545-3A313F4F76CC}" type="glossary">Link-local addresses</content-link></b>, are new to the concept of addressing with IP in the Network layer. These addresses have a smaller scope than site-local addresses; they refer only to a particular physical link (physical network). Routers do not forward datagrams using link-local addresses at all, not even within the organization; they are only for local communication on a particular physical network segment. They are used for link communications such as automatic address configuration, neighbor discovery, and router discovery. Many IPv6 routing protocols also use link-local addresses. Link-local addresses begin with "FE" and then have a value from "8" to "B" for the third hexadecimal digit. So, these addresses start with "FE8", "FE9", "FEA", or "FEB".</li></ul></p> <p><b>Loopback Address </b></p> <p>Just as in IPv4, a provision has been made for a special loopback IPv6 address for testing; datagrams sent to this address "loop back" to the sending device. However, in IPv6 there is just one address, not a whole block, for this function. The loopback address is 0:0:0:0:0:0:0:1, which is normally expressed using zero compression as "::1".</p> <p><b>Unspecified Address </b></p> <p>In IPv4, an IP address of all zeroes has a special meaning; it refers to the host itself, and is used when a device does not know its own address. In IPv6, this concept has been formalized, and the all-zeroes address (0:0:0:0:0:0:0:0) is named the "unspecified" address. It is typically used in the source field of a datagram that is sent by a device that seeks to have its IP address configured. You can apply address compression to this address; because the address is all zeroes, the address becomes just "::".</p></content-text>
</page>
<page type="OneColumn" id="en1407030203">
<content-media type="StaticGraphic" id="cm5400670251">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030200/en1407030203/cm5400670251.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030200/en1407030203/cm5400670251text.xml"/></content-media>
<content-text><p><b>IPv6 Address Management </b></p> <p>IPv6 addresses use interface identifiers to identify interfaces on a link. Think of them as the host portion of an IPv6 address. Interface identifiers are required to be unique on a specific link. Interface identifiers are always 64 bits and can be dynamically derived from a Layer 2 address (MAC). </p> <p>You can assign an IPv6 address ID statically or dynamically:</p> <p><ul><li>Static assignment using a manual interface ID </li><li>Static assignment using an EUI-64 interface ID </li><li><content-link target="{040D2316-5F29-4499-8C5D-3A27CABE2D2A}" type="glossary">Stateless autoconfiguration</content-link></li><li>DHCP for IPv6 (DHCPv6)</li></ul></p> <p><b>Manual Interface ID Assignment</b></p> <p>One way to statically assign an IPv6 address to a device is to manually assign both the prefix (network) and interface ID (host) portion of the IPv6 address. To configure an IPv6 address on a Cisco router interface, use the <span class="cmd"><b>ipv6 address</b><i> ipv6-address/prefix-length</i></span> command in interface configuration mode. The following example shows the assignment of an IPv6 address to the interface of a Cisco router:</p> <p><span class="cmd">RouterX(config-if)#<b>ipv6 address 2001:DB8:2222:7272::72/64</b></span></p> <p><b>EUI-64 Interface ID Assignment</b></p> <p>Another way to assign an IPv6 address is to configure the prefix (network) portion of the IPv6 address and derive the interface ID (host) portion from the Layer 2 MAC address of the device, which is known as the <content-link target="{C8E4563F-02F5-4500-AE1B-97518D13514D}" type="glossary">EUI-64</content-link> interface ID. </p> <p><b>Click the EUI-64 button in the figure. </b></p> <p>The EUI-64 standard explains how to stretch IEEE 802 MAC addresses from 48 to 64 bits by inserting the 16-bit 0xFFFE in the middle at the 24th bit of the MAC address to create a 64-bit, unique interface identifier.</p> <p>To configure an IPv6 address on a Cisco router interface and enable IPv6 processing using EUI-64 on that interface, use the <span class="cmd"><b>ipv6 address</b> <i>ipv6-prefix/prefix-length</i> <b>eui-64</b></span> command in interface configuration mode. The following example shows the assignment of an EUI-64 address to the interface of a Cisco router: </p> <p><span class="cmd">RouterX(config-if)#<b>ipv6 address 2001:DB8:2222:7272::/64 eui-64</b></span></p> <p><b>Stateless Autoconfiguration </b></p> <p>Autoconfiguration automatically configures the IPv6 address. In IPv6, it is assumed that non-PC devices, as well as computer terminals, will be connected to the network. The autoconfiguration mechanism was introduced to enable plug-and-play networking of these devices to help reduce administration overhead. </p> <p><b>DHCPv6 (Stateful)</b> </p> <p>DHCPv6 enables DHCP servers to pass configuration parameters, such as IPv6 network addresses, to IPv6 nodes. It offers the capability of automatic allocation of reusable network addresses and additional configuration flexibility. This protocol is a stateful counterpart to IPv6 stateless address autoconfiguration (RFC 2462), and can be used separately or concurrently with IPv6 stateless address autoconfiguration to obtain configuration parameters.</p> <p>For more information on IPv6 address assignment visit the following: <content-link target="http://www.netbsd.org/docs/network/ipv6/" type="external">http://www.netbsd.org/docs/network/ipv6/</content-link>. </p></content-text>
</page>
</topic>
<topic type="" id="en1407030300">
<title><content-text>IPv6 Transition Strategies</content-text></title>
<page type="OneColumn" id="en1407030301">
<content-media type="StaticGraphic" id="cm1536308169">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030300/en1407030301/cm1536308169.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030300/en1407030301/cm1536308169text.xml"/></content-media>
<content-text><p><b>IPv6 Transition Strategies</b></p> <p>The transition from IPv4 does not require upgrades on all nodes at the same time. Many transition mechanisms enable smooth integration of IPv4 and IPv6. Other mechanisms that allow IPv4 nodes to communicate with IPv6 nodes are available. Different situations demand different strategies. The figure illustrates the richness of available transition strategies.</p> <p>Recall the advice: "Dual stack where you can, tunnel where you must." These two methods are the most common techniques to transition from IPv4 to IPv6. </p> <p><b>Dual Stacking</b></p> <p>Dual stacking is an integration method in which a node has implementation and connectivity to both an IPv4 and IPv6 network. This is the recommended option and involves running IPv4 and IPv6 at the same time. Router and switches are configured to support both protocols, with IPv6 being the preferred protocol.</p> <p><b>Tunneling</b></p> <p>The second major transition technique is tunneling. There are several tunneling techniques available, including:</p> <p><ul><li>Manual IPv6-over-IPv4 tunneling - An IPv6 packet is encapsulated within the IPv4 protocol. This method requires dual-stack routers.</li><li>Dynamic 6to4 tunneling - Automatically establishes the connection of IPv6 islands through an IPv4 network, typically the Internet. It dynamically applies a valid, unique IPv6 prefix to each IPv6 island, which enables the fast deployment of IPv6 in a corporate network without address retrieval from the ISPs or registries.</li></ul></p> <p>Other less popular tunneling techniques that are beyond the scope of this course include:</p> <p><ul><li>Intra-Site Automatic Tunnel Addressing Protocol (ISATAP) tunneling - Automatic overlay tunneling mechanism that uses the underlying IPv4 network as a link layer for IPv6. ISATAP tunnels allow individual IPv4 or IPv6 dual-stack hosts within a site to communicate with other such hosts on a virtual link, creating an IPv6 network using the IPv4 infrastructure. </li><li>Teredo tunneling - An IPv6 transition technology that provides host-to-host automatic tunneling instead of gateway tunneling. This approach passes unicast IPv6 traffic when dual-stacked hosts (hosts that are running both IPv6 and IPv4) are located behind one or multiple IPv4 NATs.</li></ul></p> <p><b>NAT-Protocol Translation (NAT-PT)</b></p> <p>Cisco IOS Release 12.3(2)T and later (with the appropriate feature set) also include NAT-PT between IPv6 and IPv4. This translation allows direct communication between hosts that use different versions of the IP protocol. These translations are more complex than IPv4 NAT. At this time, this translation technique is the least favorable option and should be used as a last resort.</p></content-text>
</page>
</topic>
<topic type="" id="en1407030400">
<title><content-text>Cisco IOS Dual Stack</content-text></title>
<page type="OneColumn" id="en1407030401">
<content-media type="StaticGraphic" id="cm4224964936">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030400/en1407030401/cm4224964936.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030400/en1407030401/cm4224964936text.xml"/></content-media>
<content-text><p><b>Cisco IOS Dual Stack</b></p> <p>Dual stacking is an integration method that allows a node to have connectivity to an IPv4 and IPv6 network simultaneously. Each node has two protocol stacks with the configuration on the same interface or on multiple interfaces. </p> <p>The dual-stack approach to IPv6 integration, in which nodes have both IPv4 and IPv6 stacks, will be one of the most commonly used integration methods. A dual-stack node chooses which stack to use based on the destination address of the packet. A dual-stack node should prefer IPv6 when it is available. Old IPv4-only applications continue to work as before. New and modified applications take advantage of both IP layers.</p> <p>A new <content-link target="{2771197D-7900-44AC-81BA-7C9395C71105}" type="glossary">application programming interface</content-link> (<content-link target="{14979236-EFA0-4318-9A62-AE00FAED7118}" type="glossary">API</content-link>) has been defined to support IPv4 and IPv6 addresses and DNS requests. An API facilitates the exchange of messages or data between two or more different software applications. An example of an API is the virtual interface between two software functions, such as a word processor and a spreadsheet. The API is built into software applications to translate IPv4 into IPv6, and vice versa using the IP conversion mechanism. New applications can use both IPv4 and IPv6. </p> <p>Experience in porting IPv4 applications to IPv6 suggests that for most applications, there is a minimal change in some localized places inside the source code. This technique is well known and has been applied in the past for other protocol transitions. It enables gradual application upgrades, one by one, to IPv6.</p> <p><b>Click the Configuring IPv6 Interface button in the figure.</b></p> <p>Cisco IOS Release 12.2(2)T and later (with the appropriate feature set) are IPv6-ready. As soon as you configure basic IPv4 and IPv6 on the interface, the interface is dual-stacked and forwards IPv4 and IPv6 traffic on that interface. Note that an IPv4 and an IPv6 address have been configured.</p> <p>Using IPv6 on a Cisco IOS router requires that you use the global configuration command <span class="cmd"><b>ipv6 unicast-routing</b></span>. This command enables the forwarding of IPv6 datagrams.</p> <p>You must configure all interfaces that forward IPv6 traffic with an IPv6 address using the <span class="cmd"><b>ipv6 address</b> <i>IPv6-address</i> [/<i>prefix length</i>]</span> interface command.</p></content-text>
</page>
</topic>
<topic type="" id="en1407030500">
<title><content-text>IPv6 Tunneling</content-text></title>
<page type="OneColumn" id="en1407030501">
<content-media type="StaticGraphic" id="cm2393730549">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030500/en1407030501/cm2393730549.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030500/en1407030501/cm2393730549text.xml"/></content-media>
<content-text><p><b>IPv6 Tunneling</b></p> <p>Tunneling is an integration method where an IPv6 packet is encapsulated within another protocol, such as IPv4. This method enables the connection of IPv6 islands without needing to convert the intermediary networks to IPv6. When IPv4 is used to encapsulate the IPv6 packet, a protocol type of 41 is specified in the IPv4 header, and the packet includes a 20-byte IPv4 header with no options and an IPv6 header and payload. It also requires dual-stack routers. </p> <p>Tunneling presents these two issues. The <content-link target="{86BF9E5E-D82A-4B4D-98BD-A06D19BA69F3}" type="glossary">maximum transmission unit</content-link> (<content-link target="{8E084A16-DBE2-402F-89CA-127F980A1F3A}" type="glossary">MTU</content-link>) is effectively decreased by 20 octets if the IPv4 header does not contain any optional fields. In addition, a tunneled network is often difficult to troubleshoot.</p> <p>Tunneling is an intermediate integration and transition technique and should not be considered as a final solution. A native IPv6 architecture should be the ultimate goal.</p></content-text>
</page>
<page type="OneColumn" id="en1407030502">
<content-media type="StaticGraphic" id="cm5883982319">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030500/en1407030502/cm5883982319.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030500/en1407030502/cm5883982319text.xml"/></content-media>
<content-text><p><b>Manually Configured IPv6 Tunnel</b></p> <p>A manually configured tunnel is equivalent to a permanent link between two IPv6 domains over an IPv4 backbone. The primary use is for stable connections that require regular secure communication between two edge routers or between an end system and an edge router, or for connection to remote IPv6 networks. The end routers must be dual stacked, and the configuration cannot change dynamically as network and routing needs change.</p> <p>Administrators manually configure a static IPv6 address on a tunnel interface, and assign manually configured static IPv4 addresses to the tunnel source and the tunnel destination. The host or router at each end of a configured tunnel must support both the IPv4 and IPv6 protocol stacks. Manually configured tunnels can be configured between border routers or between a border router and a host.</p></content-text>
</page>
</topic>
<topic type="" id="en1407030600">
<title><content-text>Routing Considerations with IPv6</content-text></title>
<page type="OneColumn" id="en1407030601">
<content-media type="StaticGraphic" id="cm6689742715">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030600/en1407030601/cm6689742715.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030600/en1407030601/cm6689742715text.xml"/></content-media>
<content-text><p><b>Routing Configurations with IPv6</b></p> <p>Like IPv4 <content-link target="{FCDE8357-DF39-419B-A9F4-D088CDDD21E6}" type="glossary">classless interdomain routing</content-link> (<content-link target="{BD788C82-F372-4866-A50A-3F374EA9A92F}" type="glossary">CIDR</content-link>), IPv6 uses longest prefix match routing. IPv6 uses modified versions of most of the common routing protocols to handle longer IPv6 addresses and different header structures.</p> <p>Larger address spaces make room for large address allocations to ISPs and organizations. An ISP aggregates all of the prefixes of its customers into a single prefix and announces the single prefix to the IPv6 Internet. The increased address space is sufficient to allow organizations to define a single prefix for their entire network.</p> <p>But how does this affect router performance? A brief review of how a router functions in a network helps illustrate how IPv6 affects routing. Conceptually, a router has three functional areas:</p> <p><ul><li>The control plane handles the interaction of the router with the other network elements, providing the information needed to make decisions and control the overall router operation. This plane runs processes such as routing protocols and network management. These functions are generally complex. </li><li>The data plane handles packet forwarding from one physical or logical interface to another. It involves different switching mechanisms such as process switching and Cisco Express Forwarding (CEF) on Cisco IOS software routers. </li><li>Enhanced services include advanced features applied when forwarding data, such as packet filtering, quality of service (QoS), encryption, translation, and accounting. </li></ul></p> <p>IPv6 presents each of these functions with specific new challenges. </p> <p><b>IPv6 Control Plane</b></p> <p>Enabling IPv6 on a router starts its control plane operating processes specifically for IPv6. Protocol characteristics shape the performance of these processes and the amount of resources necessary to operate them: </p> <p><ul><li><b>IPv6 address size</b> - Address size affects the information-processing functions of a router. Systems using a 64-bit CPU, bus, or memory structure can pass both the IPv4 source and destination address in a single processing cycle. For IPv6, the source and destination addresses require two cycles each-four cycles to process source and destination address information. As a result, routers relying exclusively on software processing are likely to perform slower than when in an IPv4 environment. </li><li><b>Multiple IPv6 node addresses</b> - Because IPv6 nodes can use several IPv6 unicast addresses, memory consumption of the Neighbor Discovery cache may be affected. </li><li><b>IPv6 routing protocols</b> - IPv6 routing protocols are similar to their IPv4 counterparts, but since an IPv6 prefix is four times larger than an IPv4 prefix, routing updates have to carry more information. </li><li><b>Routing table Size</b> -Increased IPv6 address space leads to larger networks and a much larger Internet. This implies larger routing tables and higher memory requirements to support them. </li></ul></p> <p><b>IPv6 Data Plane</b></p> <p>The data plane forwards IP packets based on the decisions made by the control plane. The forwarding engine parses the relevant IP packet information and does a lookup to match the parsed information against the forwarding policies defined by the control plane. IPv6 affects the performance of parsing and lookup functions: </p> <p><ul><li><b>Parsing IPv6 extension headers</b> - Applications, including mobile IPv6, often use IPv6 address information in extension headers, thus increasing their size. These additional fields require additional processing. For example, a router using ACLs to filter Layer 4 information needs to apply the ACLs to packets with extension headers as well as those without. If the length of the extension header exceeds the fixed length of the hardware register of the router, hardware switching fails, and packets may be punted to software switching or dropped. This severely affects the forwarding performance of the router.</li><li><b>IPv6 address lookup</b> - IPv6 performs a lookup on packets entering the router to find the correct output interface. In IPv4, the forwarding decision process parses a 32-bit destination address. In IPv6, the forwarding decision could conceivably require parsing a 128-bit address. Most routers today perform lookups using an application-specific integrated circuit (ASIC) with a fixed configuration that performs the functions for which it was originally designed - IPv4. Again, this could result in punting packets into slower software processing, or dropping them all together.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="en1407030602">
<content-media type="StaticGraphic" id="cm9788136090">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030600/en1407030602/cm9788136090.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030600/en1407030602/cm9788136090text.xml"/></content-media>
<content-text><p><b>RIPNg Routing Protocol</b></p> <p>IPv6 routes use the same protocols and techniques as IPv4. Although the addresses are longer, the protocols used in routing IPv6 are simply logical extensions of the protocols used in IPv4. </p> <p>RFC 2080 defines Routing Information Protocol next generation (<content-link target="{6701051E-5D1C-4E48-BEA4-CEA3B1FDD38A}" type="glossary">RIPng</content-link>) as a simple routing protocol based on RIP. RIPng is no more or less powerful than RIP, however, it provides a simple way to bring up an IPv6 network without having to build a new routing protocol. </p> <p>RIPng is a distance vector routing protocol with a limit of 15 hops that uses split horizon and <content-link target="{FA51E5B4-5747-4E97-BDC0-91ACEF0FD13E}" type="glossary">poison reverse updates</content-link> to prevent routing loops. Its simplicity comes from the fact that it does not require any global knowledge of the network. Only <content-link target="{F18C3194-F090-4C48-98AF-DCE48338D1F9}" type="glossary">neighboring routers</content-link> exchange local messages.</p> <p>RIPng includes the following features:</p> <p><ul><li>Based on IPv4 RIP version 2 (RIPv2) and is similar to RIPv2</li><li>Uses IPv6 for transport</li><li>Includes the IPv6 prefix and next-hop IPv6 address</li><li>Uses the <content-link target="{911B0C25-02FF-4A99-8506-EC16E30CA08F}" type="glossary">multicast group</content-link><content-link target="{08F907A1-240A-4B98-8B5F-EECFD0E9F5B5}" type="glossary">FF02::9</content-link> as the destination address for RIP updates (this is similar to the broadcast function performed by RIP in IPv4)</li><li>Sends updates on UDP port 521</li><li>Is supported by Cisco IOS Release 12.2(2)T and later</li></ul></p> <p>In dual-stacked deployments, both RIP and RIPng are required.</p></content-text>
</page>
</topic>
<topic type="" id="en1407030700">
<title><content-text>Configuring IPv6 Addresses</content-text></title>
<page type="OneColumn" id="en1407030701">
<content-media type="StaticGraphic" id="cm2303979149">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030700/en1407030701/cm2303979149.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030700/en1407030701/cm2303979149text.xml"/></content-media>
<content-text><p><b>Enabling IPv6 on Cisco Routers</b></p> <p>There are two basic steps to activate IPv6 on a router. First, you must activate IPv6 traffic-forwarding on the router, and then you must configure each interface that requires IPv6. </p> <p>By default, IPv6 traffic-forwarding is disabled on a Cisco router. To activate it between interfaces, you must configure the global command <span class="cmd"><b>ipv6 unicast-routing</b></span>. </p> <p>The <span class="cmd"><b>ipv6 address</b></span> command can configure a global IPv6 address. The link-local address is automatically configured when an address is assigned to the interface. You must specify the entire 128-bit IPv6 address or specify to use the 64-bit prefix by using the <span class="cmd"><b>eui-64</b></span> option.</p></content-text>
</page>
<page type="OneColumn" id="en1407030702">
<content-media type="StaticGraphic" id="cm3099516220">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030700/en1407030702/cm3099516220.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030700/en1407030702/cm3099516220text.xml"/></content-media>
<content-text><p><b>IPv6 Address Configuration Example</b></p> <p>You can completely specify the IPv6 address or compute the host identifier (rightmost 64 bits) from the EUI-64 identifier of the interface. In the example, the IPv6 address of the interface is configured using the EUI-64 format.</p> <p>Alternatively, you can completely specify the entire IPv6 address to assign a router interface an address using the <span class="cmd"><b>ipv6 address</b> <i>ipv6-address/prefix-length</i></span> command in interface configuration mode.</p> <p>Configuring an IPv6 address on an interface automatically configures the link-local address for that interface. </p></content-text>
</page>
<page type="OneColumn" id="en1407030703">
<content-media type="StaticGraphic" id="cm9959481463">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030700/en1407030703/cm9959481463.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030700/en1407030703/cm9959481463text.xml"/></content-media>
<content-text><p><b>Cisco IOS IPv6 Name Resolution </b></p> <p>There are two ways to perform name resolution from the Cisco IOS software process:</p> <p><ul><li>Define a static name for an IPv6 address using the <span class="cmd"><b>ipv6 host name</b> [<i>port</i>] <i>ipv6-address1</i> [<i>ipv6-address2...ipv6-address4</i>]</span> command. You can define up to four IPv6 addresses for one hostname. The port option refers to the Telnet port to be used for the associated host.</li><li>Specify the DNS server used by the router with the <span class="cmd"><b>ip name-server</b> <i>address</i></span> command. The address can be an IPv4 or IPv6 address. You can specify up to six DNS servers with this command.</li></ul></p></content-text>
</page>
</topic>
<topic type="" id="en1407030800">
<title><content-text>Configuring RIPng with IPv6</content-text></title>
<page type="OneColumn" id="en1407030801">
<content-media type="StaticGraphic" id="cm3387824408">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030800/en1407030801/cm3387824408.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030800/en1407030801/cm3387824408text.xml"/></content-media>
<content-text><p><b>Configure RIPng with IPv6</b></p> <p>When configuring supported routing protocols in IPv6, you must create the routing process, enable the routing process on interfaces, and customize the routing protocol for your particular network.</p> <p>Before configuring the router to run IPv6 RIP, globally enable IPv6 using the <span class="cmd"><b>ipv6 unicast-routing</b></span> global configuration command, and enable IPv6 on any interfaces on which IPv6 RIP is to be enabled.</p> <p>To enable RIPng routing on the router, use the <span class="cmd"><b>ipv6 router rip</b> <i>name</i></span> global configuration command. The <span class="cmd"><i>name</i></span> parameter identifies the RIP process. This process name is used later when configuring RIPng on participating interfaces.</p> <p>For RIPng, instead of using the <span class="cmd"><b>network</b></span> command to identify which interfaces should run RIPng, you use the command <span class="cmd"><b>ipv6 rip</b> <i>name</i> <b>enable</b></span> in interface configuration mode to enable RIPng on an interface. The <span class="cmd"><i>name</i></span> parameter must match the name parameter in the <span class="cmd"><b>ipv6 router rip</b></span> command.</p> <p>Enabling RIP on an interface dynamically creates a "router rip" process if necessary.</p></content-text>
</page>
<page type="OneColumn" id="en1407030802">
<content-media type="StaticGraphic" id="cm9465482678">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030800/en1407030802/cm9465482678.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030800/en1407030802/cm9465482678text.xml"/></content-media>
<content-text><p><b>Example: RIPng for IPv6 Configuration</b></p> <p>The example shows a network of two routers. Router R1 is connected to the default network. On both router R2 and router R1, the name RT0 identifies the RIPng process. RIPng is enabled on the first Ethernet interface of router R1 using the <span class="cmd"><b>ipv6 rip RT0 enable</b></span> command. Router R2 shows that RIPng is enabled on both Ethernet interfaces using the <span class="cmd"><b>ipv6 rip RT0 enable</b></span> command.</p> <p>This configuration allows Ethernet 1 on router R2 and the Ethernet 0 interfaces of both routers to exchange RIPng routing information.</p></content-text>
</page>
</topic>
<topic type="" id="en1407030900">
<title><content-text>Verifying and Troubleshooting RIPng</content-text></title>
<page type="OneColumn" id="en1407030901">
<content-media type="StaticGraphic" id="cm6738828042">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030900/en1407030901/cm6738828042.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407030000/en1407030900/en1407030901/cm6738828042text.xml"/></content-media>
<content-text><p><b>Verifying and Troubleshooting RIPng for IPv6</b></p> <p>After configuring RIPng, verification is required. The figure lists the various show commands you can use.</p> <p><b>Click the Troubleshooting button in the figure.</b></p> <p>If you discover during verification that RIPng is not working properly, you need to troubleshoot.</p> <p>The figure lists the commands used to troubleshoot RIPng problems.</p></content-text>
</page>
<page type="FullScreen" id="en1407030902">
<content-media type="ActivityPopup" id="cm1804566569">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407030000/en1407030900/en1407030902/cm1804566569/" mime="shockwave/flash" scale="true" type="directory" width="800" height="450" external="en1407000000/en1407030000/en1407030900/en1407030902/cm1804566569/icontext.xml"/></content-media>
<content-text><p>Flash Activity</p></content-text>
</page>
</topic>
</section>
<section type="" id="en1407040000">
<title><content-text>Chapter Labs</content-text></title>
<topic type="" id="en1407040100">
<title><content-text>Basic DHCP and NAT Configuration</content-text></title>
<page type="OneColumn" id="en1407040101">
<content-media type="ActivityLab" id="cm4964607610">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407040000/en1407040100/en1407040101/cm4964607610/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407040000/en1407040100/en1407040101/cm4964607610/icontext.xml"/></content-media>
<content-text><p>In this lab, you will configure the DHCP and NAT IP services. One router is the DHCP server. The other router forwards DHCP requests to the server. You will also configure both static and dynamic NAT configurations, including NAT overload. When you have completed the configurations, verify the connectivity between the inside and outside addresses.</p></content-text>
</page>
<page type="OneColumn" id="en1407040102">
<content-media type="ActivityPKA" id="cm8735836513">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407040000/en1407040100/en1407040102/cm8735836513/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407040000/en1407040100/en1407040102/cm8735836513/icontext.xml"/></content-media>
<content-text><p>This activity is a variation of Lab 7.4.1. Packet Tracer may not support all the tasks specified in the hands-on lab. This activity should not be considered equivalent to completing the hands-on lab. Packet Tracer is not a substitute for a hands-on lab experience with real equipment.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E4_PTAct_7_4_1.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1407040200">
<title><content-text>Challenge DHCP and NAT Configuration</content-text></title>
<page type="OneColumn" id="en1407040201">
<content-media type="ActivityLab" id="cm8894517315">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407040000/en1407040200/en1407040201/cm8894517315/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407040000/en1407040200/en1407040201/cm8894517315/icontext.xml"/></content-media>
<content-text><p>In this lab, configure the IP address services using the network shown in the topology diagram. If you need assistance, refer back to the basic DHCP and NAT configuration lab. However, try to do as much on your own as possible.</p></content-text>
</page>
<page type="OneColumn" id="en1407040202">
<content-media type="ActivityPKA" id="cm3656238578">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407040000/en1407040200/en1407040202/cm3656238578/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407040000/en1407040200/en1407040202/cm3656238578/icontext.xml"/></content-media>
<content-text><p>This activity is a variation of Lab 7.4.2. Packet Tracer may not support all the tasks specified in the hands-on lab. This activity should not be considered equivalent to completing the hands-on lab. Packet Tracer is not a substitute for a hands-on lab experience with real equipment.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E4_PTAct_7_4_2.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
<topic type="" id="en1407040300">
<title><content-text>Troubleshooting DHCP and NAT</content-text></title>
<page type="OneColumn" id="en1407040301">
<content-media type="ActivityLab" id="cm8434137066">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407040000/en1407040300/en1407040301/cm8434137066/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407040000/en1407040300/en1407040301/cm8434137066/icontext.xml"/></content-media>
<content-text><p>The routers at your company were configured by an inexperienced network engineer. Several errors in the configuration have resulted in connectivity issues. Your boss has asked you to troubleshoot and correct the configuration errors and document your work. Using your knowledge of DHCP, NAT, and standard testing methods, find and correct the errors. Make sure all clients have full connectivity. </p></content-text>
</page>
<page type="OneColumn" id="en1407040302">
<content-media type="ActivityPKA" id="cm7633888453">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407040000/en1407040300/en1407040302/cm7633888453/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407040000/en1407040300/en1407040302/cm7633888453/icontext.xml"/></content-media>
<content-text><p>This activity is a variation of Lab 7.4.3. Packet Tracer may not support all the tasks specified in the hands-on lab. This activity should not be considered equivalent to completing the hands-on lab. Packet Tracer is not a substitute for a hands-on lab experience with real equipment.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E4_PTAct_7_4_3.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b> </p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="en1407050000">
<title><content-text>Chapter Summary</content-text></title>
<topic type="" id="en1407050100">
<title><content-text>Summary</content-text></title>
<page type="OneColumn" id="en1407050101">
<content-media type="InteractiveGraphicHotspots" id="cm1915434518">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407050000/en1407050100/en1407050101/cm1915434518.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407050000/en1407050100/en1407050101/cm1915434518text.xml"/></content-media>
<content-text><p>This chapter has dealt with the key solutions to the problem of diminishing Internet address space. You have learned how to use DHCP to assign private IP addresses inside your network. This conserves public address space and saves considerable administrative overhead in managing adds, moves and changes. You learned how to implement NAT and NAT overload to conserve public address space and build private secure intranets without affecting your ISP connection. However, NAT has drawbacks in terms of its negative affects on device performance, security, mobility and end-to-end connectivity.</p> <p>Overall, the ability to scale networks for future demands requires a limitless supply of IP addresses and improved mobility that DHCP and NAT alone cannot meet. IPv6 satisfies the increasingly complex requirements of hierarchical addressing that IPv4 does not provide. The emergence of IPv6 not only deals with the depletion of IPv4 addresses and shortcomings of NAT, it provides new and improved features. In the brief introduction to IPv6 in this lesson, you learned how IPv6 addresses are structured, how they will enhance network security and mobility, and how the IPv4 world will transition to IPv6.</p></content-text>
</page>
<page type="FullScreen" id="en1407050102">
<content-media type="StaticGraphic" id="cm7087997872">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407050000/en1407050100/en1407050102/cm7087997872.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="en1407000000/en1407050000/en1407050100/en1407050102/cm7087997872text.xml"/></content-media>
<content-text><p>Check Your Understanding</p></content-text>
</page>
<page type="OneColumn" id="en1407050103">
<content-media type="ActivityPKA" id="cm8704662622">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407050000/en1407050100/en1407050103/cm8704662622/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="en1407000000/en1407050000/en1407050100/en1407050103/cm8704662622/icontext.xml"/></content-media>
<content-text><p>In this culminating activity, you will configure PPP, OSPF, DHCP, NAT and default routing to ISP. You will then verify your configuration.</p> <p>Detailed instructions are provided within the activity as well as in the PDF link below.</p> <p><content-link target="E4_PTAct_7_5_1.pdf" type="internalfile">Activity Instructions (PDF)</content-link></p> <p><b>Click the Packet Tracer icon for more details.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="en1407060000">
<title><content-text>Chapter Quiz</content-text></title>
<topic type="" id="en1407060100">
<title><content-text>Chapter Quiz</content-text></title>
<page type="FullScreen" id="en1407060101">
<content-media type="ChapterQuiz" id="cm6921524731">	<title><content-text></content-text></title>	<media ref="en1407000000/en1407060000/en1407060100/en1407060101/cm6921524731/" mime="" scale="true" type="directory" width="100%" height="100%" external="en1407000000/en1407060000/en1407060100/en1407060101/cm6921524731/icontext.xml"/></content-media>
<content-text></content-text>
</page>
</topic>
</section>
</chapter>
