<chapter type="" id="tl1407000000">
<title><content-text>Services d’adressage IP</content-text></title>
<section type="ChapterIntroduction" id="tl1407000000">
<title><content-text>Présentation du chapitre</content-text></title>
<topic type="" id="tl1407000100">
<title><content-text>Présentation</content-text></title>
<page type="OneColumn" id="tl1407000101">
<content-media type="ChapterIntroduction" id="cm9929790282">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407000000/tl1407000100/tl1407000101/cm9929790282.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407000000/tl1407000100/tl1407000101/cm9929790282text.xml"/></content-media> <content-text><p>Internet et les technologies liées au protocole IP ont connu une croissance rapide. L’une des raisons expliquant cette croissance est la souplesse du concept d’origine. Ce concept n’avait cependant pas anticipé la popularité que connaît Internet et la demande d’adresses IP qui en résulte. Par exemple, chaque hôte et périphérique connecté à Internet nécessite une adresse IP version 4 (<content-link target="{A2FC74BA-9345-4EEF-9664-0AD95F5A5C92}" type="glossary">IPv4</content-link>) unique. En raison de cette croissance spectaculaire, les adresses IP disponibles commencent à manquer. </p> <p>Pour faire face à la diminution du nombre d’adresses IP disponibles, plusieurs solutions à court terme ont été trouvées. Les adresses privées et la traduction d’adresses de réseau (NAT) sont deux de ces solutions à court terme. </p> <p>En règle générale, un hôte interne reçoit son adresse IP, son masque de sous-réseau, son adresse IP de passerelle par défaut, son adresse IP de serveur de noms de domaine (DNS) ainsi que d’autres informations d’un serveur DHCP (Dynamic Host Configuration Protocol). Plutôt que fournir aux hôtes internes des adresses IP Internet valides, le serveur DHCP fournit généralement des adresses IP issues d’un pool d’adresses privé. Cependant, ces hôtes peuvent toujours avoir besoin d’adresses IP valides pour accéder aux ressources Internet. La fonction NAT rentre alors en jeu.</p>  <p>La fonction NAT permet aux hôtes du réseau interne d’emprunter une adresse IP Internet légitime pendant qu’ils accèdent aux ressources Internet. Lorsque le trafic demandé revient, l’adresse IP légitime est redéfinie et disponible pour la requête Internet suivante effectuée par un hôte interne. Avec la fonction NAT, les administrateurs réseau n’ont besoin que d’une ou de quelques adresses IP que le routeur fournit aux hôtes, plutôt qu’une adresse IP unique pour chaque client se connectant au réseau. Même s’il n’y paraît pas, ce système est très efficace car le trafic hôte se produit très rapidement.</p> <p>Bien que les adresses privées avec DHCP et NAT aient permis de réduire le besoin en adresses IP, les prévisions indiquent qu’il n’y aura plus d’adresses IPv4 uniques d’ici 2010. C’est pour cela qu’au milieu des années 90, le groupe de travail IETF a lancé un appel pour des propositions relatives à un nouveau schéma d’adressage IP. Le groupe de travail (<content-link target="{BBC0327C-A3E3-428A-A9BF-187065EB517D}" type="glossary">IPng</content-link>) (IP nouvelle génération) a répondu à cet appel. En 1996, le groupe de travail IETF a commencé à publier un certain nombre de documents RFC définissant le protocole <content-link target="{D0CBF8A2-CE70-4F3D-8662-0FB584419C75}" type="glossary">IPv6</content-link>. </p> <p>La principale caractéristique du protocole IPv6 qui pousse à son adoption est son plus grand espace d’adressage : les adresses utilisées par l’IPv6 ont une longueur de 128 bits contre 32 bits avec l’IPv4.</p> <p>Le présent chapitre explique comment mettre en œuvre DHCP, NAT et IPv6 sur des réseaux d’entreprise.</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl1407010000">
<title><content-text>Protocole DHCP</content-text></title>
<topic type="" id="tl1407010100">
<title><content-text>Présentation du protocole DHCP</content-text></title>
<page type="OneColumn" id="tl1407010101">
<content-media type="AnimationPartialScreen" id="cm9402876046">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010100/tl1407010101/cm9402876046.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010100/tl1407010101/cm9402876046text.xml"/></content-media> <content-text><p><b>Qu’est-ce que le protocole DHCP ?</b></p> <p>Tous les périphériques qui se connectent à un réseau ont besoin d’une adresse IP. Les administrateurs réseau attribuent des adresses IP statiques aux routeurs, serveurs et aux autres périphériques réseau dont les emplacements (physique et logique) ne changeront sans doute pas. Les administrateurs entrent manuellement les adresses IP statiques lorsqu’ils configurent l’accès des périphériques au réseau. Les adresses statiques permettent également aux administrateurs de gérer ces périphériques à distance.</p> <p>Cependant, dans une entreprise, les ordinateurs changent souvent d’emplacement, physiquement et logiquement. Il est impossible pour les administrateurs d’attribuer de nouvelles adresses IP chaque fois qu’un employé change de bureau ou de place. Les ordinateurs de bureau clients n’ont pas besoin d’une adresse statique ; une station de travail peut utiliser n’importe quelle adresse au sein d’une plage d’adresses. Cette plage appartient généralement à un sous-réseau IP. Une station de travail appartenant à un sous-réseau spécifique peut se voir attribuer n’importe quelle adresse d’une plage spécifiée. D’autres éléments tels que le masque de sous-réseau, la passerelle par défaut et le serveur de noms de domaine (DNS) se voient attribuer une valeur qui est commune à ce sous-réseau ou à l’ensemble du réseau administré. Par exemple, tous les hôtes d’un même sous-réseau reçoivent différentes adresses IP hôte, mais reçoivent le même masque de sous-réseau et la même adresse IP de passerelle par défaut. </p> <p>Rappelez-vous que dans CCNA Exploration : Notions de base sur les réseaux, vous avez appris que le protocole DHCP rend le processus d’attribution de nouvelles adresses IP quasiment transparent. Le protocole DHCP attribue les adresses IP et d’autres informations importantes sur la configuration réseau de façon dynamique. Comme les ordinateurs de bureau clients constituent la majorité des nœuds du réseau, le protocole DHCP offre un gain de temps extrêmement précieux aux administrateurs réseau. Le document RFC 2131 décrit le protocole DHCP.</p> <p>En règle générale, les administrateurs préfèrent qu’un serveur réseau fournisse les services DHCP car ces solutions sont évolutives et relativement faciles à gérer. Cependant, dans le cas d’une petite filiale, d’un petit bureau ou d’un bureau à domicile, un routeur Cisco peut être configuré pour fournir les services DHCP, évitant ainsi l’achat d’un serveur dédié. Un jeu de fonctions Cisco IOS appelé Easy IP offre en option un serveur DHCP complet. </p></content-text>
</page>
</topic>
<topic type="" id="tl1407010200">
<title><content-text>Fonctionnement du protocole DHCP</content-text></title>
<page type="OneColumn" id="tl1407010201">
<content-media type="InteractiveGraphicHotspots" id="cm3631719746">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010200/tl1407010201/cm3631719746.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010200/tl1407010201/cm3631719746text.xml"/></content-media> <content-text><p><b>Fonctionnement du protocole DHCP</b></p> <p>La principale fonction d’un serveur DHCP est d’offrir aux clients des adresses IP. Le protocole DHCP comprend trois mécanismes d’allocation d’adresses, offrant ainsi de la souplesse lors de l’attribution d’adresses IP : </p> <p><ul><li><b>Allocation manuelle :</b> l’administrateur attribue une adresse IP préallouée au client et le protocole DHCP communique uniquement l’adresse IP au périphérique. </li><li><b>Allocation automatique :</b> le protocole DHCP attribue de façon automatique et permanente une adresse IP statique à un périphérique en sélectionnant cette adresse dans un pool d’adresses disponibles. Il n’y a pas de bail et l’adresse est attribuée de façon permanente au périphérique. </li><li><b>Allocation dynamique :</b> le protocole DHCP attribue, ou loue, de façon automatique et dynamique une adresse IP à partir d’un pool d’adresses pour une durée limitée définie par le serveur ou jusqu’à ce que le client indique au serveur DHCP qu’il n’a plus besoin de cette adresse. </li></ul></p> <p>Cette section traite de l’allocation dynamique.</p> <p>Le protocole DHCP utilise le mode client/serveur ; il fonctionne comme toute autre relation client/serveur. Lorsqu’un ordinateur se connecte à un serveur DHCP, le serveur attribue ou loue une adresse IP à cet ordinateur. L’ordinateur se connecte au réseau avec cette adresse IP louée jusqu’à l’expiration du bail. L’hôte doit régulièrement contacter le serveur DHCP pour renouveler le bail. Ce système de bail permet de s’assurer que les hôtes qui bougent ou qui sont hors connexion ne conservent pas des adresses dont ils n’ont plus besoin. Le serveur DHCP renvoie ces adresses au pool d’adresses et les réattribue selon les besoins.</p> <p><b>Cliquez sur le bouton Détection dans la figure.</b></p> <p>Lorsque le client démarre ou lorsqu’il souhaite se connecter à un réseau, il doit suivre quatre étapes pour obtenir un bail. Au cours de la première étape, le client diffuse un message DHCPDISCOVER. Le message DHCPDISCOVER détecte les serveurs DHCP sur le réseau. L’hôte n’ayant pas d’informations IP valides au démarrage, il utilise les adresses de diffusion L2 et L3 pour communiquer avec le serveur. </p> <p><b>Cliquez sur le bouton Offre dans la figure.</b></p> <p>Lorsque le serveur DHCP reçoit un message DHCPDISCOVER, il trouve une adresse IP disponible à louer, crée une entrée ARP comprenant l’adresse MAC de l’hôte demandeur et l’adresse IP louée, puis transmet une offre de liaison via un message DHCPOFFER. Le message DHCPOFFER est envoyé en monodiffusion, utilisant l’adresse MAC L2 du serveur comme adresse source et l’adresse L2 du client comme destination.</p> <p><b>Remarque :</b> dans certains cas, les messages DHCP échangés depuis le serveur peuvent être diffusés en mode standard et non en monodiffusion.</p> <p><b>Cliquez sur le bouton Requête dans la figure.</b></p> <p>Lorsque le client reçoit le message DHCPOFFER du serveur, il renvoie un message DHCPREQUEST. La fonction de ce message est double : émettre le bail ainsi que le renouveler et le vérifier. Lorsqu’il est utilisé pour émettre le bail, le message DHCPREQUEST du client demande que les informations sur l’IP soient vérifiées juste après son attribution. Le message permet de rechercher les éventuelles erreurs afin de s’assurer que l’attribution est toujours valide. Le message DHCPREQUEST sert également d’acceptation de la liaison auprès du serveur sélectionné et de refus implicite auprès des autres serveurs ayant offert une liaison à l’hôte. </p> <p>De nombreux réseaux d’entreprise utilisent plusieurs serveurs DHCP. Le message DHCPREQUEST est envoyé sous forme de diffusion afin de prévenir ce serveur DHCP et tous les autres serveurs DHCP de l’offre acceptée.</p> <p><b>Cliquez sur le bouton Reçu dans la figure.</b></p> <p>Après réception du message DHCPREQUEST, le serveur vérifie les informations sur le bail, crée une entrée ARP pour le bail du client, puis répond par un message DHCPACK en monodiffusion. Le message DHCPACK est une copie du message DHCPOFFER ; la seule différence se situe au niveau du champ du type de message. Lorsque le client reçoit le message DHCPACK, il consigne les informations de configuration et lance une recherche ARP sur l’adresse attribuée. S’il ne reçoit pas de réponse, il comprend que l’adresse IP est valide et commence à l’utiliser. </p> <p>Les clients louent les informations auprès du serveur pour la période définie par l’administrateur. Les administrateurs configurent les serveurs DHCP pour que les baux dépassent le délai d’attente à différents intervalles. La plupart des FAI et des réseaux de grande taille utilisent des durées de bail par défaut allant jusqu’à trois jours. À l’expiration du bail, le client doit demander une autre adresse, même si l’adresse courante est généralement reconduite.</p> <p>Le message DHCPREQUEST gère également le processus DHCP dynamique. Il est possible que les informations sur l’IP envoyées dans le message DHCPOFFER aient été proposées à un autre client au cours de l’allocation dynamique. Chaque serveur DHCP crée des pools d’adresses IP et leurs paramètres associés. Les pools sont dédiés à des sous-réseaux IP logiques individuels. Les pools permettent à plusieurs serveurs DHCP de répondre et aux clients IP d’être mobiles. Si plusieurs serveurs répondent, un client ne peut choisir qu’une seule des offres.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407010300">
<title><content-text>Protocoles BOOTP et DHCP</content-text></title>
<page type="OneColumn" id="tl1407010301">
<content-media type="StaticGraphic" id="cm5563077473">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010300/tl1407010301/cm5563077473.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010300/tl1407010301/cm5563077473text.xml"/></content-media> <content-text><p><b>Protocoles BOOTP et DHCP</b></p> <p>Le <content-link target="{204BC05A-D48A-4006-822D-91247379C9BC}" type="glossary">protocole Bootstrap</content-link> (BOOTP), défini dans le document RFC 951, est le prédécesseur du protocole DHCP et partage avec lui certaines caractéristiques de fonctionnement. Le protocole BOOTP permet de télécharger des configurations d’adresse et d’amorçage pour les stations de travail sans disque. Une station de travail sans disque ne dispose pas de disque dur ni de système d’exploitation. De nombreux systèmes de caisses enregistreuses automatisées que vous pouvez trouver dans votre supermarché sont des exemples de stations de travail sans disque. Les protocoles DHCP et BOOTP sont tous deux de type client/serveur et utilisent les ports UDP 67 et 68. Ces ports continuent à s’appeler les ports BOOTP. </p> <p>Comme l’illustre la figure, les protocoles DHCP et BOOTP comptent deux composants. Le serveur est un hôte avec une adresse IP statique qui attribue, distribue et gère des affectations d’IP et de données de configuration. Chaque allocation (IP et données de configuration) est conservée sur le serveur dans un ensemble de données appelé liaison. Le client peut être n’importe quel périphérique utilisant DHCP comme méthode d’obtention d’une adresse IP ou de prise en charge des informations de configuration. </p> <p>Pour comprendre les différences de fonctionnement entre les protocoles BOOTP et DHCP, pensez aux quatre paramètres IP de base nécessaires pour accéder à un réseau : </p> <p><ul><li>l’adresse IP ; </li><li>l’adresse de passerelle ; </li><li>le masque de sous-réseau ; </li><li>l’adresse du serveur de noms de domaine (DNS).</li></ul></p> <p>Il existe trois différences majeures entre les protocoles DHCP et BOOTP : </p> <p><ul><li>La principale différence réside dans le fait que le protocole BOOTP a été conçu pour la préconfiguration manuelle des informations de l’hôte dans une base de données de serveur tandis que le protocole DHCP permet l’allocation dynamique des configurations et des adresses réseau aux hôtes nouvellement attachés. Lorsqu’un client BOOTP demande une adresse IP, le serveur BOOTP recherche dans une table prédéfinie l’entrée qui correspond à l’adresse MAC du client. S’il existe une entrée, l’adresse IP correspondante est renvoyée au client. Cela signifie que la liaison entre l’adresse MAC et l’adresse IP doit déjà avoir été configurée dans le serveur BOOTP.</li><li>Le protocole DHCP permet de récupérer et de réattribuer les adresses réseau via un mécanisme de bail. Le protocole DHCP définit des mécanismes permettant aux clients de se voir attribuer une adresse IP pendant une période d’utilisation déterminée. Cette période permet de réattribuer ultérieurement l’adresse IP à un autre client ou permet au client d’en obtenir une nouvelle s’il passe sur un autre sous-réseau. Les clients peuvent également renouveler les baux et conserver la même adresse IP. Le protocole BOOTP n’utilise pas les baux. Ses clients ont une adresse IP réservée qui ne peut être attribuée à aucun autre hôte. </li><li>Le protocole BOOTP offre à un hôte une quantité d’informations limitée. Le protocole DHCP offre des paramètres de configuration IP supplémentaires, tels que WINS et le nom de domaine. </li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl1407010302">
<content-media type="StaticGraphic" id="cm4887772734">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010300/tl1407010302/cm4887772734.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010300/tl1407010302/cm4887772734text.xml"/></content-media> <content-text><p><b>Format du message DHCP</b></p> <p>Les développeurs du protocole DHCP devaient conserver la compatibilité avec le protocole BOOTP ; ils ont donc utilisé le même format de message que BOOTP. Cependant, le protocole DHCP comptant plus de fonctionnalités que le protocole BOOTP, le champ des options DHCP a été ajouté. Dans le cas d’une communication avec d’anciens clients BOOTP, le champ des options DHCP est ignoré.</p> <p>La figure illustre le format d’un message DHCP. Les champs sont les suivants :</p> <p><ul><li><b>Code d’opération</b><b> (OP)</b> : spécifie le type général du message. Si la valeur est 1, il s’agit d’un message de requête ; si la valeur est 2, il s’agit d’un message de réponse.</li><li><b>Type de matériel</b> : identifie le type de matériel utilisé sur le réseau. Par exemple, 1 correspond à Ethernet, 15 à un relais de trames et 20 à une ligne série. Il s’agit des mêmes codes utilisés dans les messages ARP.</li><li><b>Longueur de l’<content-link target="{5E19C782-5C80-4A00-B827-4624A1D4A74E}" type="glossary">adresse matérielle</content-link></b> : 8 bits permettant de spécifier la longueur de l’adresse.</li><li><b>Sauts</b> : mis à zéro par le client avant la transmission d’une requête et utilisé par les agents de relais pour contrôler la transmission des messages DHCP.</li><li><b>Identificateur de transaction</b> : identification à 32 bits générée par le client afin d’associer la requête aux réponses reçues sur les serveurs DHCP.</li><li><b>Secondes</b> : nombre de secondes qui se sont écoulées depuis le début de la tentative d’acquisition ou de renouvellement d’un bail par un client. Les serveurs DHCP occupés utilisent ce chiffre pour définir les priorités des réponses lorsque plusieurs requêtes du client sont en attente.</li><li><b>Indicateurs</b> : un seul des 16 bits est utilisé, l’indicateur de diffusion. Un client qui ne connaît pas son adresse IP lorsqu’il envoie une requête définit l’indicateur sur 1. Cette valeur indique au serveur DHCP ou à l’agent de relais recevant la requête qu’il doit renvoyer la réponse sous forme de diffusion. </li><li><b>Adresse IP du client</b> : le client entre son adresse IP dans ce champ uniquement s’il dispose d’une adresse IP valide alors qu’il est en état de liaison ; si ce n’est pas le cas, il définit le champ sur 0. Le client ne peut utiliser ce champ que si son adresse est valable et utilisable, et non pendant l’acquisition d’une adresse. </li><li><b>Votre adresse IP</b> : l’adresse IP que le serveur attribue au client.</li><li><b>Adresse IP du serveur</b> : adresse du serveur que le client doit utiliser au cours de l’étape suivante du processus de bootstrap, qui n’est pas obligatoirement le serveur ayant envoyé cette réponse. Le serveur émetteur inclut toujours son adresse IP dans un champ spécial appelé l’option Server Identifier DHCP. </li><li><b>Adresse IP de la passerelle</b> : achemine les messages DHCP lorsque les agents de relais DHCP sont impliqués. L’adresse de passerelle facilite les communications des requêtes DHCP et les réponses entre le client et un serveur situés sur différents réseaux ou sous-réseaux.</li><li><b>Adresse matérielle du client</b> : spécifie la couche physique du client.</li><li><b>Nom du serveur</b> : le serveur envoyant un message DHCPOFFER ou DHCPACK peut éventuellement entrer son nom dans ce champ. Il peut s’agir d’un simple surnom ou d’un nom de domaine DNS, tel que serveurdhcp.netacad.net.</li><li><b>Nom du fichier de démarrage</b> : peut être utilisé par un client pour demander un type particulier de fichier de démarrage dans un message DHCPDISCOVER. Utilisé par un serveur dans un message DHCPOFFER pour spécifier un répertoire et un nom de fichier de démarrage.</li><li><b>Options</b> : comprend les options DHCP, notamment plusieurs paramètres requis pour le fonctionnement de base de DHCP. La longueur de ce champ est variable. Le client et le serveur peuvent utiliser ce champ.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl1407010303">
<content-media type="AnimationPartialScreen" id="cm6471917777">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010300/tl1407010303/cm6471917777.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010300/tl1407010303/cm6471917777text.xml"/></content-media> <content-text><p><b>Méthodes de détection et d’offre DHCP</b></p> <p>Ces figures détaillent le contenu du paquet des messages de détection et d’offre DHCP. </p> <p>Lorsqu’un client souhaite se connecter au réseau, il demande des valeurs d’adressage auprès du serveur réseau DHCP. Si un client est configuré pour recevoir ses paramètres IP de façon dynamique, il transmet un message DHCPDISCOVER sur son sous-réseau physique local au démarrage ou lorsqu’il détecte une connexion réseau active. Le client ne pouvant pas savoir à quel sous-réseau il appartient, le message DHCPDISCOVER est une diffusion IP (l’adresse IP de destination est 255.255.255.255). Le client n’ayant pas d’adresse IP configurée, l’adresse IP source utilisée est 0.0.0.0. Comme vous pouvez le voir dans la figure, l’adresse IP du client (CIADDR), l’adresse de passerelle par défaut (GIADDR) et le masque de sous-réseau sont tous remplacés par un point d’interrogation.</p> <p><b>Cliquez sur le bouton Offre DHCP dans la figure.</b></p> <p>Le serveur DHCP gère l’allocation des adresses IP et répond aux requêtes de configuration des clients. </p> <p>Lorsque le serveur DHCP reçoit le message DHCPDISCOVER, il répond par un message DHCPOFFER. Ce message contient des informations sur la configuration initiale pour le client, notamment l’adresse MAC du client, suivies de l’adresse IP proposée par le serveur, du masque de sous-réseau, de la durée du bail et de l’adresse IP du serveur DHCP à l’origine de l’offre. Le masque de sous-réseau et la passerelle par défaut sont spécifiés dans le champ des options, le masque de sous-réseau et les options du routeur, respectivement. Le message DHCPOFFER peut être configuré pour inclure d’autres informations, telles que la durée de renouvellement du bail, le serveur de noms de domaine et <content-link target="{750B79DE-7275-411F-8249-A4E30CA96827}" type="glossary">NetBIOS</content-link> Name Service (Microsoft Windows Internet Name Service [Microsoft WINS]). </p> <p>Le serveur détermine la configuration en fonction de l’adresse matérielle du client spécifiée dans le champ CHADDR. </p> <p>Comme l’indique le schéma, le serveur DHCP a répondu au message DHCPDISCOVER en attribuant des valeurs à CIADDR et au masque de sous-réseau. </p> <p>Les administrateurs configurent les serveurs DHCP pour attribuer des adresses issues de pools prédéfinis. La plupart des serveurs DHCP permettent également à l’administrateur de définir spécifiquement les adresses MAC des clients qui peuvent être desservis et de leur attribuer la même adresse IP à chaque fois. </p> <p>Le protocole DHCP s’appuie sur le protocole de transport UDP (User Datagram Protocol). Le client envoie des messages au serveur sur le port 67. Le serveur envoie des messages au client sur le port 68.</p> <p>Le client et le serveur accusent réception des messages, ce qui conclut le processus. Le client définit le CIADDR uniquement lorsqu’un hôte est dans un état de liaison, c’est-à-dire lorsque le client a confirmé et qu’il utilise l’adresse IP. </p> <p>Pour plus d’informations sur le protocole DHCP, reportez-vous à « Cisco IOS DHCP Server » (en anglais) à l’adresse suivante : <content-link target="http://www.cisco.com/en/US/docs/ios/12_0t/12_0t1/feature/guide/Easyip2.html" type="external">http://www.cisco.com/en/US/docs/ios/12_0t/12_0t1/feature/guide/Easyip2.html</content-link>.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407010400">
<title><content-text>Configuration d’un serveur DHCP</content-text></title>
<page type="OneColumn" id="tl1407010401">
<content-media type="InteractiveGraphicHotspots" id="cm2951434100">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010400/tl1407010401/cm2951434100.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010400/tl1407010401/cm2951434100text.xml"/></content-media> <content-text><p><b>Configuration d’un serveur DHCP</b></p> <p>Les routeurs Cisco exécutant le logiciel Cisco IOS assurent la prise en charge intégrale d’un routeur agissant comme serveur DHCP. Le serveur DHCP Cisco IOS attribue et gère les adresses IP depuis les pools d’adresses spécifiés dans le routeur jusqu’aux clients DHCP. </p> <p>La configuration d’un routeur comme serveur DHCP comprend les étapes suivantes :</p> <p><b>Étape 1.</b> Définissez une plage d’adresses que le protocole DHCP ne doit pas allouer. Il s’agit généralement d’adresses statiques réservées à l’interface de routeur, à l’adresse IP de gestion de commutateur, aux serveurs et aux imprimantes réseau locales. </p> <p><b>Étape 2.</b> Créez le pool DHCP à l’aide de la commande <span class="cmd"><b>ip dhcp pool</b></span>.</p> <p><b>Étape 3.</b> Configurez le pool.</p> <p>Il est recommandé de configurer les adresses exclues en mode de configuration globale avant de créer le pool DHCP. Ainsi, le protocole DHCP n’attribue pas par mégarde des adresses réservées. </p> <p>Indiquez les adresses IP que le serveur DHCP ne doit pas attribuer aux clients. En règle générale, certaines adresses IP appartiennent à des périphériques réseau statiques, tels que des serveurs ou des imprimantes. Le protocole DHCP ne doit pas attribuer ces adresses IP à d’autres périphériques. Il est recommandé de configurer les adresses exclues en mode de configuration globale avant de créer le pool DHCP. Ainsi, le protocole DHCP n’attribue pas par mégarde des adresses réservées. Pour exclure certaines adresses, utilisez la commande <span class="cmd"><b>ip dhcp excluded-address</b></span>.</p> <p><b>Cliquez sur le bouton Pool DHCP dans la figure.</b></p> <p>Lorsque vous configurez un serveur DHCP, vous devez définir un pool d’adresses à attribuer. La commande <span class="cmd"><b>ip dhcp pool</b></span> permet de créer un pool dont vous spécifiez le nom et fait passer le routeur en mode de configuration DHCP, reconnaissable par l’invite <span class="cmd">Router(dhcp-config)#</span>. </p> <p><b>Cliquez sur le bouton Tâches DHCP dans la figure.</b></p> <p>Cette figure affiche la liste des tâches à effectuer pour configurer le pool DHCP. Certaines de ces tâches sont facultatives. </p> <p>Vous devez configurer les adresses disponibles et spécifier le numéro de sous-réseau et le masque du pool d’adresses DHCP. Utilisez l’instruction <span class="cmd"><b>network</b></span> pour définir la plage des adresses disponibles. </p> <p>Définissez également la passerelle ou le routeur par défaut que doivent utiliser les clients à l’aide de la commande <span class="cmd"><b>default-router</b></span>. La passerelle correspond généralement à l’interface de réseau local du routeur. Au moins une adresse est requise, mais vous pouvez en spécifier jusqu’à huit.</p> <p>Les commandes suivantes du pool DHCP sont facultatives. Par exemple, vous pouvez configurer l’adresse IP du serveur de noms de domaine (DNS) à la disposition d’un client DHCP à l’aide de la commande <span class="cmd"><b>dns-server</b></span>. Une fois la configuration terminée, au moins une adresse est requise, mais jusqu’à huit adresses peuvent apparaître.</p> <p>La configuration de la durée du bail DHCP constitue l’un des autres paramètres. Par défaut, le paramètre est défini sur un jour ; pour le modifier, utilisez la commande <span class="cmd"><b>lease</b></span>. Vous pouvez également configurer un serveur WINS NetBIOS à la disposition d’un client DHCP Microsoft. En règle générale, la configuration doit avoir lieu dans un environnement prenant en charge des clients antérieurs à Windows 2000. La majorité des installations comptant désormais des clients disposant de systèmes d’exploitation Windows plus récents, ce paramètre n’est généralement pas requis.</p> <p><b>Cliquez sur le bouton Exemple DHCP dans la figure.</b></p> <p>Cette figure illustre un exemple de configuration avec des paramètres DHCP de base configurés sur le routeur R1.</p> <p><b>Désactivation du protocole DHCP</b></p> <p>Le service DHCP est activé par défaut sur les versions du logiciel Cisco IOS qui le prennent en charge. Pour désactiver le service, utilisez la commande <span class="cmd"><b>no service dhcp</b></span>. Utilisez la commande de configuration globale <span class="cmd"><b>service dhcp</b></span> pour réactiver le processus du serveur DHCP. Activer le service n’a aucun effet si les paramètres ne sont pas configurés.</p></content-text>
</page>
<page type="OneColumn" id="tl1407010402">
<content-media type="StaticGraphic" id="cm7669371726">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010400/tl1407010402/cm7669371726.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010400/tl1407010402/cm7669371726text.xml"/></content-media> <content-text><p><b>Vérification de DHCP</b></p> <p>La figure illustre comment un routeur Cisco peut être configuré en vue de fournir des services DHCP. PC1 n’a pas été mis sous tension ; il n’a donc pas d’adresse IP. </p> <p>Le routeur R1 a été configuré avec les commandes suivantes :</p> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.10.1 192.168.10.9</b></p></span> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.10.254</b></p></span> <span class="cmd"><p><b>ip dhcp pool LAN-POOL-1</b></p></span> <span class="cmd"><p><b> network 192.168.10.0 255.255.255.0</b></p></span> <span class="cmd"><p><b> default-router 192.168.10.1</b></p></span> <span class="cmd"><p><b> domain-name span.com</b></p></span> <p>Pour vérifier le fonctionnement du protocole DHCP, utilisez la commande <span class="cmd"><b>show ip dhcp binding</b></span>. Cette commande permet d’afficher la liste de toutes les liaisons entre adresse IP et adresse MAC qui ont été fournies par le service DHCP. </p> <p>Pour vous assurer que les messages sont reçus ou envoyés par le routeur, utilisez la commande <span class="cmd"><b>show ip dhcp server statistics</b></span>. Cette commande permet d’afficher le nombre de messages DHCP envoyés et reçus.</p> <p><b>Cliquez sur le bouton DHCP-1 dans la figure.</b></p> <p>Comme vous pouvez le voir dans la figure, aucune liaison ou statistique n’est affichée pour le moment.</p> <p>Supposons maintenant que PC1 a été mis sous tension et que son démarrage est terminé.</p> <p><b>Cliquez sur le bouton DHCP-2 dans la figure.</b></p> <p>Remarquez que les informations de liaison indiquent désormais que l’adresse IP 192.168.10.10 a été liée à une adresse MAC. Les statistiques affichent également l’activité de DHCPDISCOVER, DHCPREQUEST, DHCPOFFER et DHCPACK.</p> <p><b>Cliquez sur le bouton Client DHCP dans la figure.</b></p> <p>La commande <span class="cmd"><b>ipconfig /all</b></span> permet d’afficher les paramètres TCP/IP configurés sur PC1. Comme PC1 était connecté au segment de réseau 192.168.10.0 /24, il a automatiquement reçu une adresse IP, un suffixe DNS et une passerelle par défaut issue de ce pool. Aucune configuration d’interface DHCP n’est requise. Si un ordinateur est connecté à un segment de réseau ayant un pool DHCP disponible, il peut obtenir automatiquement une adresse IP.</p> <p>Comment PC2 reçoit-il une adresse IP ? Le routeur R1 devra être configuré pour fournir un pool DHCP 192.168.11.0 /24, comme ceci :</p> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.11.1 192.168.11.9</b></p></span> <span class="cmd"><p><b>ip dhcp excluded-address 192.168.11.254</b></p></span> <span class="cmd"><p><b>ip dhcp pool LAN-POOL-2</b></p></span> <span class="cmd"><p><b> network 192.168.11.0 255.255.255.0</b></p></span> <span class="cmd"><p> <b>default-router 192.168.11.1</b></p></span> <span class="cmd"><p> <b>domain-name span.com</b></p></span> <p>Une fois que PC2 a terminé son démarrage, il reçoit une adresse IP pour le segment de réseau auquel il est connecté. </p> <p><b>Cliquez sur le bouton DHCP-3 dans la figure.</b></p> <p>Remarquez que les liaisons DHCP indiquent désormais que deux hôtes ont reçu une adresse IP. Les statistiques DHCP reflètent également l’échange de messages DHCP.</p> <p>La commande <span class="cmd"><b>show ip dhcp pool</b></span> est une autre commande utile qui permet d’afficher plusieurs pools. </p> <p><b>Cliquez sur le bouton Pools DHCP dans la figure.</b></p> <p>Cette commande résume les informations sur les pools DHCP.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407010500">
<title><content-text>Configuration d’un client DHCP</content-text></title>
<page type="OneColumn" id="tl1407010501">
<content-media type="StaticGraphic" id="cm9863707146">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010500/tl1407010501/cm9863707146.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010500/tl1407010501/cm9863707146text.xml"/></content-media> <content-text><p><b>Configuration d’un client DHCP</b></p> <p>En règle générale, les routeurs à bande passante faible destinés à une utilisation personnelle, tels que les routeurs Linksys, peuvent être configurés pour se connecter à un FAI par DSL ou modem câble. Dans la plupart des cas, les routeurs personnels acquièrent automatiquement une adresse IP auprès du FAI. Par exemple, la figure illustre la page de configuration par défaut d’un réseau étendu pour un routeur Linksys WRVS4400N. Remarquez que le type de connexion Internet est défini sur Automatic Configuration - DHCP (Configuration automatique - DHCP). Ainsi, lorsque le routeur est connecté à un modem câble, par exemple, il est considéré comme client DHCP et demande une adresse IP auprès du FAI. </p> <p>Les routeurs Cisco des filiales, des petits bureaux ou des bureaux à domicile doivent parfois être configurés de la même façon. La méthode suivie dépend du FAI. Cependant, dans le cas de la configuration la plus simple, l’interface Ethernet est utilisée pour établir la connexion à un modem câble. Pour configurer une interface Ethernet comme client DHCP, la commande <span class="cmd"><b>ip address dhcp</b></span> doit être configurée.</p> <p> </p> <p><b>Cliquez sur le bouton Client DHCP dans la figure.</b></p> <p>Dans la figure, supposons qu’un FAI a été configuré pour fournir à certains clients des adresses IP comprises dans la plage 209.165.201.0 / 27. Le résultat confirme l’adresse attribuée.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407010600">
<title><content-text>Relais DHCP</content-text></title>
<page type="OneColumn" id="tl1407010601">
<content-media type="StaticGraphic" id="cm8673484145">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010600/tl1407010601/cm8673484145.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010600/tl1407010601/cm8673484145text.xml"/></content-media> <content-text><p><b>Qu’est-ce que le relais DHCP ?</b></p> <p>Dans le cas d’un réseau hiérarchique complexe, les serveurs d’entreprise se trouvent généralement dans une batterie de serveurs. Ces serveurs peuvent fournir des services DHCP, DNS, TFTP et FTP aux clients. Le problème réside dans le fait que généralement, les clients réseau ne se trouvent pas sur le même sous-réseau que ces serveurs. Ainsi, les clients doivent rechercher les serveurs pour recevoir les services, alors que ces services sont souvent retrouvés à l’aide de messages de diffusion. </p> <p>Dans la figure, PC1 essaye d’acquérir une adresse IP auprès du serveur DHCP dont l’adresse est 192.168.11.5. Dans ce scénario, le routeur R1 n’est pas configuré comme serveur DHCP.</p> <p><b>Cliquez sur le bouton Problème d’hôte dans la figure.</b></p> <p>Dans la figure, PC1 essaye de renouveler son adresse IP. Pour ce faire, la commande <b>ipconfig /release</b> est exécutée. Remarquez que l’adresse IP est libérée et l’adresse actuelle est désormais 0.0.0.0. La commande <b>ipconfig /renew</b> est ensuite exécutée. Cette commande demande à l’hôte de diffuser un message DHCPDISCOVER. Cependant, PC1 ne trouve pas le serveur DHCP. Que se passe-t-il lorsque le serveur et le client sont séparés par un routeur et ne résident donc pas sur le même segment de réseau ? Souvenez-vous, les routeurs ne transfèrent pas les diffusions.</p> <p><b>Remarque :</b> certains clients Windows disposent d’une fonction appelée APIPA (Automatic Private IP Addressing). Cette fonction permet à un ordinateur Windows de s’attribuer automatiquement une adresse IP, comprise dans la plage 169.254.x.x, au cas où aucun serveur DHCP ne soit disponible ou s’il n’en existe pas sur le réseau.</p> <p>Pire encore, DHCP n’est pas le seul service critique à faire appel aux diffusions. Par exemple, les routeurs Cisco ainsi que d’autres périphériques peuvent utiliser les diffusions pour rechercher des serveurs TFTP ou un serveur d’authentification tel qu’un serveur TACACS. </p> <p>Pour résoudre ce problème, un administrateur peut ajouter des serveurs DHCP sur tous les sous-réseaux. Cependant, l’exécution de ces services sur plusieurs ordinateurs provoque des surcharges administratives et des coûts supplémentaires. </p> <p>Une solution plus simple consiste à configurer la fonction d’<content-link target="{A39F7ADB-4FBE-4B32-ABF9-5AE33817E5DC}" type="glossary">adresse de diffusion par défaut</content-link> de Cisco IOS sur les routeurs et les commutateurs concernés. Cette solution permet aux routeurs de transférer les diffusions DHCP aux serveurs DHCP. Lorsqu’un routeur transfère des requêtes de paramètre/attribution d’adresse, il agit comme agent de relais DHCP. </p> <p>Par exemple, PC1 diffuse une requête pour rechercher un serveur DHCP. Si le routeur R1 était configuré comme agent de relais DHCP, il intercepterait cette requête et la transfèrerait au serveur DHCP dont le sous-réseau est 192.168.11.0.</p> <p>Pour configurer le routeur R1 comme agent de relais DHCP, vous devez configurer l’interface la plus proche du client via la commande de configuration d’interface <span class="cmd"><b>ip helper-address</b></span>. Cette commande relaye les requêtes de diffusion pour les principaux services à une adresse configurée. Configurez l’adresse de diffusion IP par défaut sur l’interface recevant la diffusion. </p> <p><b>Cliquez sur le bouton Config. relais dans la figure.</b></p> <p>Le routeur R1 est désormais configuré comme agent de relais DHCP. Il accepte les requêtes de diffusion pour le service DHCP puis les transfère en monodiffusion à l’adresse IP 192.168.11.5. </p> <p><b>Cliquez sur le bouton Renouv. hôte dans la figure.</b></p> <p>Comme vous pouvez le voir, PC1 peut maintenant acquérir une adresse IP auprès du serveur DHCP.</p> <p>DHCP n’est pas le seul service que le routeur peut relayer suite à une configuration. Par défaut, la commande <span class="cmd"><b>ip helper-address</b></span> transfère les huit services UDP suivants :</p> <p><ul><li>Port 37 : durée </li><li>Port 49 : TACACS</li><li>Port 53 : DNS</li><li>Port 67 : client BOOTP/DHCP</li><li>Port 68 : serveur BOOTP/DHCP</li><li>Port 69 : TFTP</li><li>Port 137 : service de noms NetBIOS</li><li>Port 138 : service de datagramme NetBIOS</li></ul></p> <p>Pour spécifier d’autres ports, utilisez la commande <span class="cmd"><b>ip forward-protocol</b></span> afin d’indiquer exactement les types de paquet de diffusion à transférer.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407010700">
<title><content-text>Configuration d’un serveur DHCP à l’aide de SDM</content-text></title>
<page type="OneColumn" id="tl1407010701">
<content-media type="StaticGraphic" id="cm8714511774">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010700/tl1407010701/cm8714511774.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010700/tl1407010701/cm8714511774text.xml"/></content-media> <content-text><p><b>Configuration d’un serveur DHCP à l’aide de SDM</b></p> <p>Les routeurs Cisco peuvent également être configurés comme serveur DHCP à l’aide de SDM. Dans cet exemple, le routeur R1 sera configuré comme le serveur DHCP sur les interfaces Fa0/0 et Fa0/1. </p> <p><b>Cliquez sur le bouton Tâches DHCP dans la figure.</b></p> <p>La fonction du serveur DHCP est activée sous Additional Tasks dans l’onglet Configure. Dans la liste des tâches, cliquez sur le dossier DHCP et sélectionnez <b>DHCP Pools</b> pour ajouter un nouveau pool. Cliquez sur <b>Add</b> pour créer le pool DHCP.</p> <p><b>Cliquez sur le bouton Ajouter un pool dans la figure.</b></p> <p>La fenêtre Add DHCP Pool contient les options dont vous avez besoin pour configurer le pool d’adresses IP DHCP. Les adresses IP que le serveur DHCP attribue sont issues d’un pool commun. Pour configurer le pool, spécifiez les adresses IP de début et de fin de la plage. </p> <p>Cisco SDM configure le routeur pour exclure automatiquement l’adresse IP de l’interface de réseau local dans le pool. Vous ne devez pas utiliser sur le réseau l’adresse de diffusion ou l’adresse IP du réseau ou du sous-réseau pour la plage d’adresses que vous spécifiez. </p> <p>Si vous devez exclure d’autres adresses IP de la plage, vous devez modifier les adresses IP de début et de fin. Si vous souhaitez par exemple exclure les adresses IP comprises entre 192.168.10.1 et 192.168.10.9, vous devez définir l’adresse IP de début sur 192.168.10.10. Le routeur commencera ainsi l’attribution d’adresses à partir de 192.168.10.10. </p> <p>Les autres options disponibles sont les suivantes :</p> <p><ul><li><b>DNS Server1 et DNS Server2</b> : le serveur de noms de domaine (DNS) est généralement un serveur qui associe un nom de périphérique connu à son adresse IP. Si un serveur de noms de domaine est configuré pour votre réseau, entrez ici l’adresse IP du serveur. S’il existe un serveur de noms de domaine supplémentaire sur le réseau, vous pouvez entrer dans ce champ son adresse IP. </li><li><b>WINS Server1 et WINS Server2</b> : souvenez-vous que la configuration WINS a généralement lieu dans des environnements prenant en charge des clients antérieurs à Windows 2000. </li><li><b>Import All DHCP Options into the DHCP Server Database</b> : permet d’importer les options DHCP d’un serveur de niveau supérieur. Cette option est généralement utilisée avec un serveur DHCP Internet. Cette option vous permet de récupérer des informations de niveau supérieur sans avoir à les configurer pour ce pool. </li></ul></p> <p><b>Cliquez sur le bouton Pools DHCP dans la figure.</b></p> <p>Cet écran présente un résumé des pools configurés sur votre routeur. Dans cet exemple, deux pools sont configurés, un pour chacune des interfaces Fast Ethernet sur le routeur R1.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407010800">
<title><content-text>Dépannage du protocole DHCP</content-text></title>
<page type="OneColumn" id="tl1407010801">
<content-media type="InteractiveGraphicHotspots" id="cm3378856475">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010800/tl1407010801/cm3378856475.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010800/tl1407010801/cm3378856475text.xml"/></content-media> <content-text><p><b>Dépannage de la configuration DHCP</b></p> <p>Les problèmes de DHCP peuvent avoir diverses origines : défauts logiciels dans les systèmes d’exploitation, pilotes NIC ou agents de relais DHCP/BOOTP, notamment. La raison la plus courante reste cependant les problèmes de configuration. Étant donné le nombre de domaines pouvant poser problème, vous devez suivre une approche méthodique.</p> <p><b>Tâche 1 du dépannage : résolution des conflits d’adresses IP</b></p> <p>Un bail d’adresse IP peut expirer alors qu’un client est toujours connecté à un réseau. Si le client ne renouvelle pas le bail, le serveur DHCP peut réattribuer cette adresse IP à un autre client. Lorsque le client redémarre, il demande une adresse IP. Si le serveur DHCP ne répond pas rapidement, le client utilise la dernière adresse IP. Deux clients utilisent alors la même adresse IP, créant un conflit.</p> <p>La commande <span class="cmd"><b>show ip dhcp conflict</b></span> affiche tous les conflits d’adresses enregistrés par le serveur DHCP. Le serveur utilise la commande <span class="cmd"><b>ping</b></span> pour détecter les conflits. Le client utilise le protocole ARP pour détecter les clients. Si un conflit d’adresse est détecté, l’adresse est retirée du pool et n’est pas attribuée tant qu’un administrateur n’a pas résolu le conflit. </p> <p>Cet exemple indique la méthode et l’heure de détection pour toutes les adresses IP que le serveur DHCP a offert et qui sont en conflit avec d’autres périphériques.</p> <p><span class="cmd">R2# <b>show ip dhcp conflict</b></span></p> <p><span class="cmd">Adresse IP Méthode de détection Heure de détection</span></p> <p><span class="cmd">192.168.1.32 Ping Feb 16 2007 12:28 PM</span></p> <p><span class="cmd">192.168.1.64 Gratuitous ARP Feb 23 2007 08:12 AM</span></p> <p><b>Tâche 2 du dépannage : vérification de la connectivité physique</b></p> <p>Utilisez tout d’abord la commande <span class="cmd"><b>show interface </b> <i>interface</i></span> pour confirmer que l’interface de routeur agissant comme passerelle par défaut pour le client est opérationnelle. Si l’état de l’interface n’est pas actif, le port n’achemine pas le trafic, y compris les requêtes du client DHCP. </p> <p><b>Tâche 3 du dépannage : test de la connectivité du réseau en configurant une station de travail cliente avec une adresse IP statique</b></p> <p>Lorsque vous dépannez un problème de DHCP, vérifiez la connectivité du réseau en configurant une adresse IP statique sur une station de travail cliente. Si la station de travail ne peut pas atteindre les ressources réseau avec une adresse IP configurée de façon statique, la cause première du problème n’est pas le protocole DHCP. Il convient alors à ce moment-là de dépanner la connectivité du réseau.</p> <p><b>Tâche 4 du dépannage : vérification de la configuration du port du commutateur (STP Portfast et autres commandes)</b></p> <p>Si le client DHCP ne parvient pas à obtenir d’adresse IP auprès du serveur DHCP au démarrage, essayez d’obtenir une adresse IP auprès du serveur DHCP en obligeant manuellement le client à envoyer une requête DHCP. </p> <p>Si un commutateur se trouve entre le client et le serveur DHCP, assurez-vous que sur le port, STP PortFast est activé et que l’agrégation/le cheminement est désactivé. Par défaut, PortFast est désactivé et l’agrégation/le cheminement est automatique (si applicable). Changer ces configurations permet de résoudre les problèmes les plus courants de client DHCP qui se produisent avec une installation initiale d’un commutateur Catalyst. Vous pouvez consulter « CCNA Exploration : Commutation de réseau local et réseau local sans fil » pour vous aider à résoudre ce problème.</p> <p><b>Tâche 5 du dépannage : déterminer si les clients DHCP obtiennent l’adresse IP sur le même sous-réseau ou réseau local virtuel que le serveur DHCP</b></p> <p>Il est important de déterminer si le protocole DHCP fonctionne correctement lorsque le client se trouve sur le même sous-réseau ou réseau local virtuel que le serveur DHCP. Si le protocole DHCP fonctionne normalement, le problème peut venir de l’agent de relais DHCP/BOOTP. Si le problème existe toujours lorsque vous testez DHCP sur le même sous-réseau ou réseau local virtuel que le serveur DHCP, le problème peut en fait provenir du serveur DHCP.</p></content-text>
</page>
<page type="OneColumn" id="tl1407010802">
<content-media type="StaticGraphic" id="cm8098039303">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010800/tl1407010802/cm8098039303.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010800/tl1407010802/cm8098039303text.xml"/></content-media> <content-text><p><b>Vérification de la configuration du relais DHCP/BOOTP du routeur </b></p> <p>Lorsque le serveur DHCP est situé sur un autre réseau local que le client, l’interface de routeur faisant face au client doit être configurée pour relayer les requêtes DHCP. Pour ce faire, l’adresse de diffusion IP par défaut doit être configurée. Si l’adresse de diffusion IP par défaut n’est pas correctement configurée, les requêtes du client DHCP ne sont pas transférées au serveur DHCP.</p> <p>Suivez les étapes suivantes pour vérifier la configuration du routeur :</p> <p><b>Étape 1.</b> Vérifiez que la commande <span class="cmd"><b>ip helper-address</b></span> est configurée sur la bonne interface. Elle doit être présente sur l’interface entrante du réseau local comprenant les stations de travail DHCP clientes et doit être dirigée vers le bon serveur DHCP. Dans la figure, le résultat de la commande <span class="cmd"><b>show running-config</b></span> permet de vérifier que l’adresse IP du relais DHCP pointe vers le serveur DHCP à l’adresse 192.168.11.5.</p> <p><b>Étape 2.</b> Assurez-vous que la commande de configuration globale <span class="cmd"><b>no service dhcp</b></span> n’a pas été configurée. Cette commande désactive toutes les fonctionnalités de relais et de serveur DHCP sur le routeur. La commande <span class="cmd"><b>service dhcp</b></span> n’apparaît pas dans la configuration car il s’agit de la configuration par défaut.</p></content-text>
</page>
<page type="OneColumn" id="tl1407010803">
<content-media type="StaticGraphic" id="cm5087573142">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010800/tl1407010803/cm5087573142.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407010000/tl1407010800/tl1407010803/cm5087573142text.xml"/></content-media> <content-text><p><b>Vérification de la réception par le routeur des requêtes DHCP via les commandes </b><span class="cmd"><b>debug</b></span></p> <p>Sur les routeurs configurés comme serveurs DHCP, le processus DHCP échoue si le routeur ne reçoit pas les requêtes du client. Dans le cadre du dépannage, assurez-vous que le routeur reçoit la requête DHCP du client. Au cours de cette étape de dépannage, vous devez configurer une liste de contrôle d’accès pour le résultat du débogage. La liste de contrôle d’accès de débogage n’a pas d’impact sur le routeur.</p> <p>Lorsque vous êtes en mode de configuration globale, créez la liste de contrôle d’accès suivante :</p> <p><span class="cmd"><b>access-list 100 permit ip host 0.0.0.0 host 255.255.255.255</b></span></p> <p>Commencez le débogage en utilisant ACL 100 comme paramètre de définition. Lorsque vous êtes en mode d’exécution, entrez la commande <span class="cmd"><b>debug</b></span> suivante : </p> <p><span class="cmd"><b>debug ip packet detail 100</b></span></p> <p>Le résultat dans la figure indique que le routeur reçoit les requêtes DHCP du client. L’adresse IP source est 0.0.0.0 car le client n’a pas encore d’adresse IP. La destination est 255.255.255.255 car le message de détection DHCP du client est une diffusion. Les ports UDP source et de destination, 68 et 67, sont les ports généralement utilisés pour DHCP.</p> <p>Ce résultat ne montre qu’un résumé du paquet et non le paquet lui-même. Il n’est donc pas possible de déterminer si le paquet est correct. Néanmoins, le routeur a bien reçu un paquet de diffusion, et l’IP source et de destination et les ports UDP sont corrects pour DHCP.</p> <p><b>Vérification de la réception et du transfert par le routeur de la requête DHCP via la commande </b><span class="cmd"><b>debug ip dhcp server packet</b></span></p> <p>La commande <span class="cmd"><b>debug ip dhcp server events</b></span> est utile pour dépanner le protocole DHCP. Cette commande indique les événements de serveur tels que les attributions d’adresses et les mises à jour des bases de données. Elle permet également de décoder les réceptions et les transmissions DHCP. </p></content-text>
</page>
<page type="OneColumn" id="tl1407010804">
<content-media type="ActivityPKA" id="cm5818285126">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407010000/tl1407010800/tl1407010804/cm5818285126/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407010000/tl1407010800/tl1407010804/cm5818285126/icontext.xml"/></content-media> <content-text><p>Le protocole DHCP attribue les adresses IP et d’autres informations importantes sur la configuration réseau de façon dynamique. Les routeurs Cisco peuvent utiliser un jeu de fonctions Cisco IOS, appelé Easy IP, pour offrir en option un serveur DHCP complet. Par défaut, Easy IP concède des configurations pendant 24 heures. Au cours de cet exercice, vous allez configurer les services DHCP sur deux routeurs et tester votre configuration.</p> <p>Des instructions détaillées sont fournies tout au long de l’exercice, ainsi que dans le fichier PDF accessible par le lien suivant.</p> <p><content-link target="E4_PTAct_7_1_8.pdf" type="internalfile">Instructions pour l’exercice (PDF)</content-link></p> <p><b>Cliquez sur l’icône Packet Tracer pour plus d’informations.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl1407020000">
<title><content-text>Évolutivité des réseaux avec NAT</content-text></title>
<topic type="" id="tl1407020100">
<title><content-text>Adressage IP privé et public</content-text></title>
<page type="OneColumn" id="tl1407020101">
<content-media type="StaticGraphic" id="cm7216035341">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020100/tl1407020101/cm7216035341.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020100/tl1407020101/cm7216035341text.xml"/></content-media> <content-text><p>Toutes les <content-link target="{3B85FACD-786F-44AC-B83F-E42F90D4CF23}" type="glossary">adresses Internet</content-link> publiques doivent être enregistrées auprès d’un organisme d’enregistrement Internet local. Les organisations peuvent louer des adresses publiques auprès d’un FAI. Seul le propriétaire enregistré d’une adresse Internet publique peut attribuer cette adresse à un périphérique réseau.</p> <p>Vous avez peut-être remarqué que tous les exemples de ce cours utilisent un nombre assez limité d’adresses IP. Vous avez peut-être aussi remarqué la ressemblance entre ces nombres et les nombres que vous avez utilisés dans un réseau de petite taille pour afficher les pages Web de configuration de nombreuses marques d’imprimantes, de routeurs DSL et câble et d’autres périphériques. Ces adresses Internet privées réservées proviennent des trois blocs illustrés dans la figure. Ces adresses sont exclusivement destinées aux réseaux internes privés. Les paquets qui les contiennent ne sont pas acheminés sur Internet ; on les appelle des adresses non routables. Le document RFC 1918 fournit des détails sur le sujet.</p> <p>Contrairement aux adresses IP publiques, les adresses IP privées constituent un bloc réservé de nombres pouvant être utilisés par tous. Cela signifie que deux réseaux ou deux millions de réseaux peuvent utiliser les mêmes adresses privées. Pour empêcher les conflits d’adressage, les routeurs ne doivent jamais acheminer des adresses IP privées. Pour protéger la structure d’adressage Internet publique, les FAI configurent généralement les routeurs périphériques pour empêcher que le trafic dont l’adresse est privée ne soit transmis via Internet.</p> <p>En offrant plus d’espace d’adressage que ce que la majorité des organisations pourrait obtenir via un organisme d’enregistrement Internet local, l’adressage privé offre aux entreprises une souplesse considérable dans la conception de leur réseau. Des schémas d’adressage pratiques aux niveaux du fonctionnement et de l’administration peuvent ainsi être utilisés, et la croissance est plus simple à gérer.</p> <p>Cependant, puisque vous ne pouvez pas acheminer d’adresses privées sur Internet et qu’il n’existe pas suffisamment d’adresses publiques pour permettre aux organisations d’en fournir une à chacun de leurs hôtes, les réseaux ont besoin d’un mécanisme pour traduire les adresses privées en adresses publiques à la périphérie du réseau ; ce mécanisme doit pouvoir fonctionner dans les deux sens. Sans système de traduction, les hôtes privés derrière un routeur dans le réseau d’une organisation ne peuvent pas se connecter aux hôtes privés derrière un routeur dans d’autres organisations via Internet. </p> <p>La traduction d’adresses de réseau (NAT) propose ce mécanisme. Avant NAT, un hôte doté d’une adresse privée ne pouvait pas accéder à Internet. Avec NAT, les sociétés individuelles peuvent attribuer des adresses privées à certains ou tous leurs hôtes, et utiliser NAT pour leur procurer un accès à Internet.</p> <p>Pour une analyse plus détaillée du développement du système d’organismes d’enregistrement Internet locaux, reportez-vous à l’article du Cisco Internet Protocol Journal à l’adresse suivante <content-link target="http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_4-4/regional_internet_registries.html" type="external">http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_4-4/regional_internet_registries.html</content-link>. </p></content-text>
</page>
</topic>
<topic type="" id="tl1407020200">
<title><content-text>Qu’est-ce que la fonction NAT ?</content-text></title>
<page type="OneColumn" id="tl1407020201">
<content-media type="StaticGraphic" id="cm1136421622">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020200/tl1407020201/cm1136421622.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020200/tl1407020201/cm1136421622text.xml"/></content-media> <content-text><p><b>Qu’est-ce que la fonction NAT ?</b></p> <p>La fonction NAT agit comme la réceptionniste d’une grande société. Supposons que vous avez demandé à la réceptionniste de ne vous transférer aucun appel sauf contre-indication de votre part. Plus tard, vous appelez un client potentiel et vous lui laissez un message en lui demandant de vous rappeler. Vous dites à la réceptionniste que vous attendez un appel de ce client ; vous lui demandez de transférer l’appel à votre bureau.</p> <p>Le client appelle le standard de la société car il s’agit du seul numéro qu’il connaît. Lorsque le client indique à la réceptionniste le nom de la personne qu’il souhaite contacter, la réceptionniste consulte une table de recherche dans laquelle votre nom est associé à votre extension. La réceptionniste sait que vous attendez cet appel ; elle transfère donc l’appel à votre extension. </p> <p>Ainsi, pendant que le serveur DHCP attribue des adresses IP dynamiques aux périphériques du réseau, les routeurs compatibles NAT retiennent une ou plusieurs adresses IP Internet valides hors du réseau. Lorsque le client envoie des paquets en dehors du réseau, la fonction NAT traduit l’adresse IP interne du client en adresse externe. Pour les utilisateurs externes, l’ensemble du trafic depuis et vers le réseau a la même adresse IP ou provient du même pool d’adresses. </p> <p>La principale fonction de NAT est d’enregistrer les adresses IP en autorisant les réseaux à utiliser des adresses IP privées. NAT traduit les adresses non routables, privées et internes en adresses routables publiques. NAT permet également d’ajouter un niveau de confidentialité et de sécurité à un réseau car il empêche les réseaux externes de voir les adresses IP internes.</p> <p>Un périphérique compatible NAT fonctionne généralement à la périphérie d’un <content-link target="{599C668A-E409-45CA-9965-73197F160850}" type="glossary">réseau d’extrémité</content-link>. Dans notre exemple, R2 est le routeur périphérique. Un réseau d’extrémité est un réseau ayant une connexion unique vers son réseau voisin. Pour le FAI, R2 forme un réseau d’extrémité.</p> <p>Lorsqu’un hôte interne au réseau d’extrémité, par exemple PC1, PC2 ou PC 3, souhaite transmettre à un hôte externe, le paquet est transféré à R2, le routeur de <content-link target="{6914E21E-5AC5-4115-BB72-C467B5B39C3D}" type="glossary">passerelle frontière</content-link>. R2 effectue le processus NAT, c’est-à-dire qu’il traduit l’adresse privée interne de l’hôte en adresse publique externe routable. </p> <p>Dans la terminologie NAT, le réseau interne désigne l’ensemble des réseaux soumis à la traduction. Le réseau externe désigne toutes les autres adresses. Les désignations des adresses IP sont différentes si ces adresses sont sur réseau privé ou public (Internet) et si le trafic est entrant ou sortant. </p> <p><b>Cliquez sur le bouton Terminologie dans la figure.</b></p> <p>La figure montre comment désigner les interfaces lors de la configuration de NAT. Supposons que le routeur R2 a été configuré pour offrir des fonctionnalités NAT. Il dispose d’un pool d’adresses publiques disponibles à louer aux hôtes internes. Cette section utilise les termes suivants relatifs à la fonction NAT :</p> <p><ul><li><b>Adresse locale interne</b> : n’est généralement pas une adresse IP attribuée par un organisme d’enregistrement Internet local ou un fournisseur de services et est souvent une adresse privée RFC 1918. Dans la figure, l’adresse IP 192.168.10.10 est attribuée à l’hôte PC1 sur le réseau interne. </li><li><b>Adresse globale interne</b> : adresse publique valide attribuée à l’hôte interne lorsque ce dernier quitte le routeur NAT. Lorsque le trafic de PC1 est destiné au serveur Web à l’adresse 209.165.201.1, le routeur R2 doit traduire l’adresse. Dans ce cas, l’adresse IP 209.165.200.226 est utilisée comme adresse globale interne pour PC1.</li><li><b>Adresse globale externe</b> : adresse IP accessible attribuée à un hôte sur Internet. Par exemple, le serveur Web est accessible à l’adresse IP 209.165.201.1. </li><li><b>Adresse locale externe</b> : adresse IP locale attribuée à un hôte du réseau externe. Dans la plupart des cas, cette adresse sera identique à l’adresse globale externe de ce périphérique externe. </li></ul></p> <p><b>Remarque :</b> dans ce cours, nous parlerons d’adresse locale interne, d’adresse globale interne et d’adresse globale externe. L’utilisation de l’adresse locale externe n’est pas abordée dans ce cours. </p> <p>Le côté « interne » d’une configuration NAT n’est pas synonyme d’adresses privées, comme défini par le document RFC 1918. Les adresses que nous appelons « non routables » sont parfois acheminables. Un administrateur peut configurer n’importe quel routeur pour acheminer le trafic sur des sous-réseaux privés. Cependant, s’ils essayent d’acheminer un paquet au FAI pour une adresse privée, le FAI l’abandonne. « Non routable » veut dire non routable sur Internet.</p></content-text>
</page>
<page type="OneColumn" id="tl1407020202">
<content-media type="AnimationPartialScreen" id="cm8593325160">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020200/tl1407020202/cm8593325160.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020200/tl1407020202/cm8593325160text.xml"/></content-media> <content-text><p><b>Comment fonctionne NAT ?</b></p> <p>Dans cet exemple, un hôte interne (192.168.10.10) souhaite communiquer avec un serveur Web externe (209.165.200.1). Il envoie un paquet à R2, qui est la passerelle frontière configurée NAT pour le réseau.</p> <p><b>Utilisez les commandes de la figure pour lancer l’animation.</b></p> <p>R2 lit l’adresse IP de destination du paquet et vérifie si le paquet correspond aux critères spécifiés pour la traduction. R2 dispose d’une liste de contrôle d’accès qui identifie le réseau interne comme hôtes valides pour la traduction. Il traduit donc une adresse IP locale interne en adresse IP globale interne, à savoir 209.165.200.226. Il stocke ce mappage de l’adresse locale sur l’adresse globale dans la table NAT.</p> <p>Le routeur envoie ensuite le paquet vers sa destination. Lorsque le serveur Web répond, le paquet revient à l’adresse globale de R2 (209.165.200.226).</p> <p>R2 consulte sa table NAT et s’aperçoit que cette adresse IP a été précédemment traduite. Il traduit donc l’adresse globale interne en adresse locale interne ; le paquet est ensuite transféré à PC1 à l’adresse IP 192.168.10.10. Si aucun mappage n’est trouvé, le paquet est abandonné.</p> <p><b>Mappage dynamique et mappage statique</b> </p> <p>Il existe deux types de traduction NAT : dynamique et statique. </p> <p>La fonction NAT dynamique utilise un pool d’adresses publiques et les attribue selon la méthode du premier arrivé, premier servi. Lorsqu’un hôte ayant une adresse IP privée demande un accès à Internet, la fonction NAT dynamique choisit dans le pool une adresse IP qui n’est pas encore utilisée par un autre hôte. Cette description est celle du mappage.</p> <p>La fonction NAT statique utilise un mappage biunivoque des adresses locales et globales ; ces mappages restent constants. Cette fonction s’avère particulièrement utile pour les serveurs Web ou les hôtes qui doivent disposer d’une adresse permanente, accessible depuis Internet. Ces hôtes internes peuvent être des serveurs d’entreprise ou des périphériques réseau. </p> <p>Les fonctions NAT statique et dynamique nécessitent toutes deux qu’il existe suffisamment d’adresses publiques disponibles pour satisfaire le nombre total de sessions utilisateur simultanées.</p> <p>Pour plus d’informations sur le fonctionnement de la NAT dynamique, reportez-vous à <content-link target="http://www.cisco.com/warp/public/556/nat.swf" type="external">http://www.cisco.com/warp/public/556/nat.swf</content-link>.</p></content-text>
</page>
<page type="OneColumn" id="tl1407020203">
<content-media type="AnimationPartialScreen" id="cm5460638819">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020200/tl1407020203/cm5460638819.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020200/tl1407020203/cm5460638819text.xml"/></content-media> <content-text><p><b>Surcharge NAT</b></p> <p>La surcharge NAT (parfois appelée traduction d’adresses de port ou PAT) mappe plusieurs adresses IP privées à une seule adresse IP publique ou à quelques adresses. C’est ce que font la plupart des routeurs personnels. Votre FAI attribue une adresse à votre routeur et pourtant, plusieurs membres de votre famille peuvent surfer simultanément sur Internet.</p> <p>Grâce à la surcharge NAT, plusieurs adresses peuvent être mappées à une ou quelques adresses car chaque adresse privée est également suivie par un numéro de port. Lorsqu’un client ouvre une session TCP/IP, le routeur NAT attribue un numéro de port à son adresse source. La surcharge NAT s’assure que les clients utilisent un numéro de port TCP différent pour chaque session client avec un serveur sur Internet. Lorsqu’une réponse revient du serveur, le numéro de port source, qui devient le numéro de port de destination lors du retour, détermine le client auquel le routeur achemine les paquets. Il confirme également que les paquets entrants étaient demandés, ce qui ajoute un niveau de sécurité à la session. </p> <p><b>Cliquez sur les commandes pour lancer et mettre en pause l’animation.</b></p> <p>L’animation illustre ce processus. La surcharge NAT utilise des numéros de port source uniques sur l’adresse IP globale interne de façon à assurer une distinction entre les traductions. NAT traitant chaque paquet, il utilise un numéro de port (1331 et 1555 dans cet exemple) pour identifier le client d’où provient le paquet. L’adresse source correspond à l’adresse IP locale interne avec le numéro de port TCP/IP attribué lié. L’adresse de destination correspond à l’adresse IP locale externe avec le numéro de port de service lié, dans ce cas le port 80 : HTTP.</p> <p>Au niveau du routeur de passerelle frontière (R2), la surcharge NAT utilise comme adresse source l’adresse IP globale interne du client, toujours avec le numéro de port lié. L’adresse de destination reste la même, mais s’appelle désormais adresse IP globale externe. Lorsque le serveur Web répond, le même chemin est suivi, mais en sens inverse.</p> <p>Les numéros de port sont codés en 16 bits. Le nombre total d’adresses internes pouvant être traduites en une adresse externe peut théoriquement atteindre 65 536 par adresse IP. Cependant, pour être réaliste, le nombre d’adresses internes pouvant se voir attribuer une adresse IP unique se situe aux environs de 4 000. </p> <p><b>Cliquez sur le bouton Port disponible suivant dans la figure.</b></p> <p>Dans l’exemple précédent, les numéros de port client des deux adresses de destination, 1331 et 1555, ne changent pas au niveau de la passerelle frontière. Ce scénario est peu probable car il y a de fortes chances que ces numéros soient déjà liés à d’autres sessions sortantes. </p> <p>La surcharge NAT essaye de conserver le port source d’origine. Cependant, si ce port source est déjà utilisé, la surcharge NAT attribue le premier numéro de port disponible en commençant au début du groupe de ports approprié, à savoir 0-511, 512-1023 ou 1024-65535. Lorsqu’il n’y a plus de ports disponibles et que plusieurs adresses IP externes sont configurées, la surcharge NAT sélectionne l’adresse IP suivante pour essayer d’allouer de nouveau le port source initial. Ce processus se poursuit jusqu’à ce qu’il n’y ait plus de ports ni d’adresses IP externes disponibles. </p> <p>Dans la figure, les deux hôtes ont choisi le même numéro de port : 1444. Cette situation est acceptable pour l’adresse interne car ils disposent tous deux d’une adresse IP privée unique. Cependant, au niveau de la passerelle frontière, les numéros de port doivent changer car sinon, deux paquets provenant de deux hôtes laisseraient R2 avec la même adresse source. La surcharge NAT a attribué à la deuxième adresse le premier numéro de port disponible, à savoir dans ce cas 1445.</p> <p><b>Différences entre NAT et la surcharge NAT</b></p> <p>Résumer les différences entre NAT et la surcharge NAT va vous aider à mieux comprendre. NAT ne traduit en général que des adresses IP sur une base de 1 pour 1 entre des adresses IP publiques et des adresses IP privées. La surcharge NAT modifie à la fois l’adresse IP privée et le numéro de port de l’expéditeur. La surcharge NAT choisit les numéros de port vus par les hôtes sur le réseau public.</p> <p>NAT achemine les paquets entrants vers leur destination interne en faisant référence à l’adresse IP source entrante donnée par l’hôte sur le réseau public. Avec la surcharge NAT, il n’y a généralement qu’une ou que très peu d’adresses IP exposées au public. Les paquets entrants provenant du réseau public sont acheminés vers leur destination sur le réseau privé en faisant référence à une table dans le périphérique de surcharge NAT qui suit les associations entre ports publics et privés. On appelle cela le suivi de connexions.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407020300">
<title><content-text>Avantages et inconvénients de la fonction NAT</content-text></title>
<page type="OneColumn" id="tl1407020301">
<content-media type="StaticGraphic" id="cm1263669050">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020300/tl1407020301/cm1263669050.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020300/tl1407020301/cm1263669050text.xml"/></content-media> <content-text><p><b>Avantages et inconvénients de la fonction NAT</b></p> <p>La fonction NAT compte de nombreux avantages. Son utilisation présente malgré tout quelques inconvénients, notamment le manque de prise en charge pour certains types de trafic. </p> <p>Voici quelques-uns des avantages liés à l’utilisation de la fonction NAT :</p> <p><ul><li>La fonction NAT ménage le schéma d’adressage enregistré légalement en autorisant la privatisation des intranets. Elle économise les adresses au moyen d’un multiplexage au niveau du port de l’application. Avec la surcharge NAT, plusieurs hôtes internes peuvent partager une même adresse IP publique pour toutes leurs communications externes. Avec ce type de configuration, il suffit d’un très petit nombre d’adresses externes pour desservir un grand nombre d’hôtes internes.</li><li>La fonction NAT augmente la souplesse des connexions au réseau public. Il est possible de mettre en œuvre des pools multiples, des pools de sauvegarde et des pools d’équilibrage de la charge pour assurer des connexions plus fiables au réseau public. </li><li>La fonction NAT assure la cohérence des schémas d’adressage du réseau interne. Sur un réseau sans adresses IP privées et sans fonction NAT, le changement des adresses IP publiques oblige à renuméroter tous les hôtes du réseau. La renumérotation des hôtes peut représenter des coûts non négligeables. La fonction NAT permet de conserver le schéma existant, tout en prenant en charge un nouveau schéma d’adressage public. Ainsi, une organisation peut changer de FAI sans avoir à changer aucun de ses clients internes. </li><li>La fonction NAT assure la sécurité du réseau. Les réseaux privés ne divulguant pas leurs adresses ou leur topologie interne, ils restent raisonnablement sécurisés quand ils sont utilisés conjointement à la fonction NAT pour obtenir un accès externe. La fonction NAT ne remplace cependant pas les pare-feu.</li></ul></p> <p>La fonction NAT présente malgré tout quelques inconvénients. Le fait que les hôtes sur Internet semblent communiquer directement avec le périphérique NAT, plutôt qu’avec l’hôte interne du réseau privé, pose un certain nombre de problèmes. En théorie, une même adresse IP unique globale peut représenter de nombreux hôtes dont l’adresse est privée. Cela représente des avantages aux niveaux de la confidentialité et de la sécurité, mais dans la pratique, il y a des inconvénients. </p> <p>Le premier inconvénient concerne les performances. La fonction NAT augmente les délais de commutation car la traduction de chaque adresse IP des en-têtes de paquet prend du temps. Le premier paquet est commuté par le processus, ce qui veut dire qu’il emprunte toujours le chemin le plus lent. Le routeur examine chaque paquet pour déterminer s’il doit être ou non traduit. Il doit modifier l’en-tête IP, et éventuellement l’en-tête TCP ou UDP. Les paquets restants passent par le chemin à commutation rapide s’il existe une entrée de cache ; sinon, ils sont également retardés.</p> <p>De nombreuses applications et protocoles Internet dépendent des fonctionnalités de bout en bout, les paquets non modifiés étant transférés de la source vers la destination. En modifiant les adresses de bout en bout, la fonction NAT bloque certaines applications qui utilisent l’adressage IP. Par exemple, certaines applications de sécurité, telles que les signatures numériques, échouent car l’adresse IP source change. Les applications qui utilisent des adresses physiques au lieu d’un nom de domaine qualifié n’atteignent pas les destinations qui sont traduites sur le routeur NAT. Ce problème peut parfois être évité par l’utilisation de mappages NAT statiques.</p> <p>La traçabilité IP de bout en bout est également perdue. Il devient bien plus difficile de suivre les paquets qui subissent de nombreux changements d’adresse sur plusieurs sauts NAT, ce qui complique le dépannage. En revanche, pour les pirates qui cherchent à déterminer la source d’un paquet, il est difficile de retracer ou d’obtenir les adresses source et de destination initiales.</p>  <p>L’utilisation de la fonction NAT complique également les protocoles de transmission tunnel, tels que IPsec, car elle modifie les valeurs dans les en-têtes, ce qui entre en conflit avec les contrôles d’intégrité effectués par IPsec et par d’autres protocoles de transmission tunnel.</p> <p>Les services nécessitant l’établissement de connexions TCP depuis le réseau externe ou les protocoles statiques tels que ceux utilisant UDP peuvent être perturbés. Si le routeur NAT ne fait pas un effort spécifique pour prendre en charge de tels protocoles, les paquets entrants ne peuvent pas atteindre leur destination. Certains protocoles peuvent accepter une instance de NAT entre les hôtes participants (FTP en mode passif, par exemple), mais échouent lorsque les deux systèmes sont coupés d’Internet par NAT. </p></content-text>
</page>
</topic>
<topic type="" id="tl1407020400">
<title><content-text>Configuration de la NAT statique</content-text></title>
<page type="OneColumn" id="tl1407020401">
<content-media type="StaticGraphic" id="cm6012058594">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020400/tl1407020401/cm6012058594.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020400/tl1407020401/cm6012058594text.xml"/></content-media> <content-text><p><b>NAT statique</b></p> <p>Souvenez-vous que la fonction NAT statique est un mappage qui fait correspondre une adresse interne et une adresse externe. La fonction NAT statique permet d’établir les connexions initiées par des périphériques externes avec des périphériques internes. Vous pouvez par exemple mapper une adresse globale interne à une adresse locale interne spécifique attribuée à votre serveur Web.</p> <p>La configuration de traductions NAT statiques est simple. Vous devez définir les adresses à traduire, puis configurer la fonction NAT sur les interfaces appropriées. Les paquets arrivant sur une interface interne depuis l’adresse IP identifiée sont soumis à la traduction. Les paquets arrivant sur une interface externe dont l’adresse correspond à l’adresse IP identifiée sont soumis à la traduction.</p> <p>La figure explique les commandes correspondant aux étapes. Vous devez entrer les traductions statiques directement dans la configuration. Contrairement aux traductions dynamiques, ces traductions se trouvent toujours dans la table NAT.</p> <p><b>Cliquez sur le bouton Exemple dans la figure.</b></p> <p>La figure correspond à une simple configuration NAT statique appliquée aux deux interfaces. Le routeur traduit toujours les paquets depuis l’hôte interne du réseau dont l’adresse privée est 192.168.10.254 vers l’adresse externe 209.165.200.254. L’hôte sur Internet dirige les requêtes Web vers l’adresse IP publique 209.165.200.254, et le routeur R2 transfère toujours ce trafic vers le serveur à l’adresse 192.168.10.254.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407020500">
<title><content-text>Configuration de la NAT dynamique</content-text></title>
<page type="OneColumn" id="tl1407020501">
<content-media type="StaticGraphic" id="cm3410388548">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020500/tl1407020501/cm3410388548.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020500/tl1407020501/cm3410388548text.xml"/></content-media> <content-text><p><b>Configuration de la NAT dynamique</b></p> <p>Alors que la fonction NAT statique offre un mappage permanent entre une adresse interne et une adresse publique spécifique, la fonction NAT dynamique mappe les adresses IP privées aux adresses publiques. Ces adresses IP publiques sont issues d’un pool NAT. Les configurations NAT dynamique et statique sont différentes, mais elles ont également des points communs. Comme pour la fonction NAT statique, la configuration de la fonction NAT dynamique doit déterminer si chaque interface est interne ou externe. Cependant, plutôt que de créer un mappage statique avec une adresse IP unique, un pool d’adresses globales internes est utilisé.</p> <p><b>Cliquez sur le bouton Commandes dans la figure</b> pour afficher les étapes à suivre pour configurer la fonction NAT dynamique.</p> <p>Pour configurer la fonction NAT dynamique, une liste de contrôle d’accès ne doit autoriser que les adresses devant être traduites. Lorsque vous créez votre liste de contrôle d’accès, souvenez-vous qu’une commande implicite « deny all » se trouve à la fin de chaque liste de contrôle d’accès. Une liste de contrôle d’accès trop laxiste peut mener à des résultats imprévisibles. Cisco recommande de ne pas configurer les listes de contrôle d’accès référencées par des commandes NAT à l’aide de la commande <span class="cmd"><b>permit any</b></span>. En effet, si vous utilisez la commande <span class="cmd"><b>permit any</b></span>, la fonction NAT risque de consommer trop de ressources du routeur, ce qui peut occasionner des problèmes sur le réseau.</p> <p><b>Cliquez sur le bouton Exemple dans la figure.</b></p> <p>Cette configuration permet la traduction de tous les hôtes des réseaux 192.168.10.0 et 192.168.11.0 lorsqu’ils génèrent du trafic qui entre dans S0/0/0 et sort de S0/1/0. Ces hôtes sont traduits en une adresse disponible comprise entre 209.165.200.226 et 209.165.200.240.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407020600">
<title><content-text>Configuration de la surcharge NAT</content-text></title>
<page type="OneColumn" id="tl1407020601">
<content-media type="StaticGraphic" id="cm2876755097">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020600/tl1407020601/cm2876755097.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020600/tl1407020601/cm2876755097text.xml"/></content-media> <content-text><p><b>Configuration de la surcharge NAT pour une adresse IP publique unique</b></p> <p>Vous pouvez configurer la surcharge de deux façons différentes, en fonction du mode d’allocation des adresses IP publiques par le FAI. Dans le premier cas, le FAI alloue une seule adresse IP publique à l’organisation et dans le deuxième, il en alloue plusieurs.</p> <p>La figure illustre les étapes à suivre pour configurer la surcharge NAT avec une adresse IP unique. Avec une seule adresse IP publique, la configuration de la surcharge attribue généralement cette adresse publique à l’interface externe qui se connecte au FAI. Toutes les adresses internes sont traduites en une seule adresse IP lorsqu’elles quittent l’interface externe. </p> <p><b>Cliquez sur le bouton Commandes dans la figure</b> pour afficher les étapes à suivre pour configurer la surcharge NAT.</p> <p>La configuration est semblable à la fonction NAT dynamique, sauf que le mot clé <span class="cmd"><b>interface</b></span> est utilisé pour identifier l’adresse IP externe, et non un pool d’adresses. Aucun pool NAT n’est donc défini. Le mot clé <span class="cmd"><b>overload</b></span> permet d’ajouter le numéro de port à la traduction.</p> <p><b>Cliquez sur le bouton Exemple dans la figure.</b></p> <p>Cet exemple illustre comment la surcharge NAT est configurée. Dans cet exemple, tous les hôtes du réseau 192.168.0.0 /16 (correspondant à la liste de contrôle d’accès 1) envoyant du trafic via le routeur R2 vers Internet sont traduits en adresse IP 209.165.200.225 (adresse IP de l’interface S0/1/0). Les flux de trafic sont identifiés par les numéros de port car le mot clé <span class="cmd"><b>overload</b></span> a été utilisé.</p></content-text>
</page>
<page type="OneColumn" id="tl1407020602">
<content-media type="StaticGraphic" id="cm3955055025">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020600/tl1407020602/cm3955055025.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020600/tl1407020602/cm3955055025text.xml"/></content-media> <content-text><p><b>Configuration de la surcharge NAT pour un pool d’adresses IP publiques</b></p> <p>Dans le cas où le FAI a fourni plusieurs adresses IP publiques, la surcharge NAT est configurée pour utiliser un pool. La principale différence entre cette configuration et la configuration dynamique, une-à-une NAT est l’utilisation du mot clé <span class="cmd"><b>overload</b></span>. Souvenez-vous que le mot clé <span class="cmd"><b>overload</b></span> permet la traduction d’adresses de port.</p> <p><b>Cliquez sur le bouton Commandes dans la figure</b> pour afficher les étapes à suivre pour configurer la surcharge NAT à l’aide d’un pool d’adresses. </p> <p><b>Cliquez sur le bouton Exemple dans la figure.</b></p> <p>Dans cet exemple, la configuration établit la traduction de surcharge pour le pool NAT NAT-POOL2. Le pool NAT contient les adresses 209.165.200.226 à 209.165.200.240 et la traduction se fait via la fonction PAT. Les hôtes du réseau 192.168.0.0 / 16 sont soumis à la traduction. Enfin, l’interface interne et l’interface externe sont identifiées.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407020700">
<title><content-text>Configuration d’un transfert de port</content-text></title>
<page type="OneColumn" id="tl1407020701">
<content-media type="StaticGraphic" id="cm4925881261">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020700/tl1407020701/cm4925881261.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020700/tl1407020701/cm4925881261text.xml"/></content-media> <content-text><p><b>Transfert de port </b></p> <p>Le transfert de port (également appelé transmission tunnel) correspond au transfert du port réseau d’un nœud réseau à un autre. Cette technique peut permettre à un utilisateur externe d’atteindre un port sur une adresse IP privée (dans un réseau local) à partir de l’extérieur via un routeur compatible NAT. </p> <p>En règle générale, les programmes de partage de fichiers peer to peer et les opérations spécifiques, telles que les services Web et le FTP sortant, exigent que les ports du routeur soient transférés ou ouverts pour que ces applications puissent fonctionner. La fonction NAT masquant les adresses internes, l’opération peer to peer ne fonctionne que de l’intérieur vers l’extérieur où la fonction NAT peut mapper des requêtes sortantes enregistrées à des réponses entrantes. </p> <p>Le problème est que la fonction NAT n’autorise pas les requêtes provenant de l’extérieur. Ce problème peut être résolu par une intervention manuelle. Le transfert de port vous permet d’identifier des ports spécifiques qui peuvent être transférés à des hôtes internes.</p> <p>Rappelez-vous que les applications logicielles Internet interagissent avec des ports utilisateur qui doivent être ouverts ou à la disposition de ces applications. Les applications utilisent des ports différents. Par exemple, Telnet utilise le port 23, FTP les ports 20 et 21, HTTP le port 80 et SMTP le port 25. Les applications et les routeurs peuvent ainsi facilement identifier les services réseau. Par exemple, HTTP fonctionne sur le port réservé 80. Lorsque vous entrez l’adresse http://cisco.com, le navigateur affiche le site Web de Cisco Systems, Inc. Remarquez qu’il est inutile de spécifier le numéro de port HTTP pour les requêtes de page car l’application suppose qu’il s’agit du port 80. </p> <p><b>Configuration d’un transfert de port </b></p> <p>Le transfert de port permet aux utilisateurs d’Internet d’accéder à des serveurs internes en utilisant l’adresse de port de réseau étendu et le numéro de port externe correspondant. Lorsque les utilisateurs envoient ces types de requête à l’adresse IP du port de réseau étendu via Internet, le routeur transfère ces requêtes aux serveurs correspondants sur votre réseau local. Pour des raisons de sécurité, les routeurs à large bande n’autorisent pas par défaut le transfert d’une requête réseau externe vers un hôte interne. </p> <p>Par exemple, la figure illustre la fenêtre Single Port Forwarding d’un routeur Linksys pour petit bureau ou bureau à domicile WRVS4400N de classe affaires. Le transfert de port n’est pas encore configuré. </p> <p><b>Cliquez sur le bouton Exemple de transfert de port dans la figure.</b></p> <p>Vous pouvez activer le transfert de port pour les applications et spécifier l’adresse locale interne à laquelle sera transférée la requête. Par exemple, dans la figure, les requêtes de service HTTP arrivant sur ce routeur Linksys sont désormais transférées vers le serveur Web dont l’adresse locale interne est 192.168.1.254. Si l’adresse IP du réseau étendu externe du routeur pour petit bureau ou bureau à domicile est 209.165.200.158, l’utilisateur externe peut entrer http://209.165.202.158 ; le routeur Linksys redirige alors la requête HTTP vers le serveur Web interne à l’adresse IP 192.168.1.254, en utilisant le numéro de port par défaut 80.</p> <p>Il serait possible de spécifier un port autre que le port par défaut, à savoir 80. Cependant, l’utilisateur externe aurait besoin de connaître le numéro de port qu’il doit utiliser. </p> <p>La méthode à suivre pour configurer le transfert de port dépend de la marque et du modèle du routeur à large bande utilisé sur le réseau. Il existe cependant des étapes communes à effectuer. Si les instructions fournies par votre FAI ou incluses avec le routeur ne vous offrent pas l’aide recherchée, le site Web <content-link target="http://www.portforward.com/" type="external">www.portforward.com</content-link> (en anglais) propose des instructions pour divers routeurs à large bande. Vous pouvez suivre les instructions pour ajouter ou supprimer des ports afin de répondre aux besoins des applications que vous voulez autoriser ou refuser. </p></content-text>
</page>
</topic>
<topic type="" id="tl1407020800">
<title><content-text>Vérification et dépannage des configurations NAT</content-text></title>
<page type="OneColumn" id="tl1407020801">
<content-media type="StaticGraphic" id="cm7432783830">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020800/tl1407020801/cm7432783830.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020800/tl1407020801/cm7432783830text.xml"/></content-media> <content-text><p><b>Vérification de NAT et de la surcharge NAT</b></p> <p>Il est important de vérifier le fonctionnement de NAT. Plusieurs commandes de routeur permettent d’afficher et d’effacer les traductions NAT. Cette rubrique explique comment vérifier le fonctionnement de NAT à l’aide d’outils disponibles sur les routeurs Cisco.</p> <p>L’une des commandes les plus efficaces pour vérifier le fonctionnement de NAT est la commande <span class="cmd"><b>show ip nat translations</b></span>. Avant d’utiliser les commandes <span class="cmd"><b>show</b></span> pour vérifier la fonction NAT, vous devez effacer toute entrée de traduction dynamique qui pourrait être toujours présente. En effet, par défaut, les traductions d’adresses dynamiques deviennent inactives dans la table de traduction NAT au terme d’une période de non-utilisation. </p> <p>Dans la figure, le routeur R2 a été configuré pour fournir la surcharge NAT aux clients 192.168.0.0 /16. Lorsque les hôtes internes quittent le routeur R2 en direction d’Internet, ils sont traduits dans l’adresse IP de l’interface série avec un numéro de port source unique. </p> <p>Supposons que les deux hôtes du réseau interne accèdent aux services Web depuis Internet. </p> <p><b>Cliquez sur le bouton Traductions NAT dans la figure.</b></p> <p>Remarquez que la commande <span class="cmd"><b>show ip nat translations</b></span> permet d’afficher les détails des deux attributions NAT. Ajoutez l’instruction <span class="cmd"><b>verbose</b></span> à la commande pour afficher des informations supplémentaires sur chaque traduction, notamment la durée écoulée depuis la création de l’entrée et depuis son utilisation.</p> <p>La commande affiche toutes les traductions statiques qui ont été configurées ainsi que toutes les traductions dynamiques qui ont été créées par le trafic. Chaque traduction est identifiée par le protocole ainsi que par les adresses locales et globales, internes et externes.</p> <p> </p> <p><b>Cliquez sur le bouton Statistiques NAT dans la figure.</b></p> <p>La commande <span class="cmd"><b>show ip nat statistics</b></span> affiche les informations sur le nombre total de traductions actives, les paramètres de configuration NAT, le nombre d’adresses dans le pool et le nombre d’adresses attribuées.</p> <p>Dans la figure, les hôtes ont initié le trafic Web ainsi que le trafic ICMP. </p> <p>Vous pouvez également utiliser la commande <span class="cmd"><b>show run</b></span> et rechercher les commandes NAT, de liste de commande d’accès, d’interface ou de pool qui présentent les valeurs requises. Analysez bien ces commandes et corrigez les éventuelles erreurs.</p> <p>Par défaut, les entrées de traduction se désactivent au bout de 24 heures, sauf si les compteurs ont été reconfigurés par la commande <span class="cmd"><b>ip nat translation timeout</b> <i>délai_secondes</i></span> en mode de configuration globale. </p> <p> </p> <p><b>Cliquez sur le bouton NAT effacées dans la figure.</b></p> <p>Il est parfois utile d’effacer les entrées dynamiques avant que le paramètre par défaut ne s’en charge, notamment lorsque vous testez la configuration NAT. Pour effacer des entrées dynamiques avant expiration du délai d’attente, utilisez la commande globale <span class="cmd"><b>clear ip nat translation</b></span>. </p> <p>Le tableau de la figure indique les différentes méthodes permettant d’effacer les traductions NAT. Vous pouvez indiquer avec précision la traduction que vous souhaitez effacer ou effacer toutes les traductions de la table à l’aide de la commande globale <span class="cmd"><b>clear ip nat translation *</b></span>, comme le montre l’exemple. </p> <p>Seules les traductions dynamiques sont effacées de la table. Les traductions statiques ne peuvent pas être effacées de la table de traduction.</p></content-text>
</page>
<page type="OneColumn" id="tl1407020802">
<content-media type="StaticGraphic" id="cm8529346800">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020800/tl1407020802/cm8529346800.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407020000/tl1407020800/tl1407020802/cm8529346800text.xml"/></content-media> <content-text><p><b>Dépannage de la configuration NAT et de la surcharge NAT</b></p> <p>Lorsque vous connaissez des problèmes de connectivité IP dans un environnement NAT, il est souvent difficile de déterminer la cause du problème. Pour résoudre le problème, il faut d’abord s’assurer que la fonction NAT n’en est pas la cause. Suivez les étapes suivantes pour vous assurer que NAT fonctionne correctement :</p> <p><b>Étape 1.</b> En fonction de la configuration, définissez clairement ce que la fonction NAT est censée faire. Cela peut permettre d’identifier un problème de configuration.</p> <p><b>Étape 2.</b> Assurez-vous que les bonnes traductions existent dans la table de traduction à l’aide de la commande <span class="cmd"><b>show ip nat translations</b></span>.</p> <p><b>Étape 3.</b> Utilisez les commandes <span class="cmd"><b>clear</b></span> et <span class="cmd"><b>debug</b></span> pour vous assurer que NAT fonctionne correctement. Regardez si les entrées dynamiques sont recréées après avoir été effacées.</p> <p><b>Étape 4.</b> Analysez de façon détaillée ce qui arrive au paquet et assurez-vous que les routeurs disposent des informations de routage adéquates pour le déplacer.</p> <p>Utilisez la commande <span class="cmd"><b>debug ip nat</b></span> pour vérifier le fonctionnement de NAT en affichant des informations sur chacun des paquets traduits par le routeur. La commande <span class="cmd"><b>debug ip nat detailed</b></span> génère une description individuelle des paquets dont la traduction est envisagée. Cette commande renvoie également des informations sur certaines erreurs ou conditions d’exception, par exemple l’impossibilité d’allouer une adresse globale.</p> <p>La figure montre un exemple de résultat de la commande <span class="cmd"><b>debug ip nat</b></span>. Le résultat indique que l’hôte interne 192.168.10.10 est à l’origine du trafic vers l’hôte externe 209.165.200.254 et qu’il a été traduit par l’adresse 209.165.200.225. </p> <p>Lorsque vous décodez le résultat du débogage, notez la signification des valeurs et symboles suivants : </p> <p><ul><li><b>*</b> : l’astérisque en regard de NAT indique que la traduction s’effectue sur le chemin à commutation rapide. Le premier paquet d’une conversation est toujours commuté par le processus, ce qui est plus lent. Les paquets restants passent par le chemin à commutation rapide s’il existe une entrée de cache. </li><li><b>s=</b> : indique l’adresse IP source. </li><li><b>a.b.c.d---&gt;w.x.y.z</b> : indique que l’adresse source a.b.c.d est traduite par w.x.y.z. </li><li><b>d=</b> : indique l’adresse IP de destination. </li><li><b>[xxxx]</b> : la valeur entre crochets représente le numéro d’identification IP. Ces informations peuvent être utiles pour le débogage car elles permettent d’établir une corrélation avec d’autres traces de paquets provenant d’analyseurs de protocole. </li></ul></p> <p>Des démonstrations sur la vérification et le dépannage de la fonction NAT sont disponibles sur les sites suivants :</p> <p>Étude de cas par animation Flash : possibilité d’envoyer une requête ping à un hôte, mais pas une requête telnet. Cette animation Flash qui dure sept minutes montre pourquoi un périphérique peut envoyer une requête ping à l’hôte, mais pas une requête telnet : <content-link target="http://www.cisco.com/warp/public/556/index.swf" type="external">http://www.cisco.com/warp/public/556/index.swf</content-link>. </p> <p>Étude de cas par animation Flash : impossibilité d’envoyer une requête ping au-delà de NAT. Cette animation Flash qui dure dix minutes montre pourquoi un périphérique ne peut pas envoyer de requête ping au-delà de NAT : <content-link target="http://www.cisco.com/warp/public/556/TS_NATcase2/index.swf" type="external">http://www.cisco.com/warp/public/556/TS_NATcase2/index.swf</content-link>.</p></content-text>
</page>
<page type="OneColumn" id="tl1407020803">
<content-media type="ActivityPKA" id="cm7730771414">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407020000/tl1407020800/tl1407020803/cm7730771414/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407020000/tl1407020800/tl1407020803/cm7730771414/icontext.xml"/></content-media> <content-text><p>La fonction NAT traduit les adresses non routables, privées et internes en adresses routables publiques. La fonction NAT permet également d’ajouter un niveau de confidentialité et de sécurité à un réseau car il empêche les réseaux externes de voir les adresses IP internes. Au cours de cet exercice, vous allez configurer les fonctions NAT statique et dynamique.</p> <p>Des instructions détaillées sont fournies tout au long de l’exercice, ainsi que dans le fichier PDF accessible par le lien suivant.</p> <p><content-link target="E4_PTAct_7_2_8.pdf" type="internalfile">Instructions pour l’exercice (PDF)</content-link></p> <p><b>Cliquez sur l’icône Packet Tracer pour plus d’informations.</b></p></content-text>
</page>
</topic>
</section>
<section type="" id="tl1407030000">
<title><content-text>IPv6</content-text></title>
<topic type="" id="tl1407030100">
<title><content-text>Pourquoi utiliser IPv6</content-text></title>
<page type="OneColumn" id="tl1407030101">
<content-media type="InteractiveGraphicHotspots" id="cm5084072158">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030100/tl1407030101/cm5084072158.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030100/tl1407030101/cm5084072158text.xml"/></content-media> <content-text><p><b>Pourquoi avons-nous besoin de plus d’espace d’adressage</b></p> <p>Pour comprendre les problèmes d’adressage IP auxquels sont confrontés de nos jours les administrateurs réseau, sachez que l’espace d’adressage IPv4 offre environ 4 294 967 296 adresses uniques. Parmi ces adresses, seules 3,7 milliards peuvent être attribuées car le système d’adressage IPv4 sépare les adresses en classes et réserve des adresses pour la multidiffusion, les tests et d’autres usages spécifiques.</p> <p>Selon des chiffres parus en janvier 2007, environ 2,4 milliards d’adresses IPv4 ont déjà été attribuées aux utilisateurs finaux ou aux FAI. Ce qui fait qu’environ 1,3 milliards d’adresses sont toujours disponibles dans l’espace d’adressage IPv4. Ce chiffre peut paraître important et pourtant, les adresses IPv4 commencent à manquer. </p> <p><b>Cliquez sur le bouton Lire dans la figure</b> pour voir l’évolution sur les 14 dernières années.</p> <p>Au cours de la dernière décennie, la communauté Internet a analysé la pénurie d’adresses IPv4 et publié bon nombre de rapports. Selon certains rapports, les adresses IPv4 seront épuisées d’ici 2010 alors que d’autres estiment que cela n’aura pas lieu avant 2013. </p> <p><b>Cliquez sur le bouton Diminution dans la figure</b> pour voir la diminution de l’espace d’adressage disponible.</p> <p>La croissance d’Internet combinée à la montée en puissance de l’informatique ont augmenté la portée des applications basées sur l’adresse IP. </p> <p><b>Cliquez sur le bouton Pourquoi IPv6 dans la figure</b> pour comprendre les raisons du passage à IPv6. </p> <p>Le pool des nombres diminue pour les raisons suivantes :</p> <p><ul><li><b>Croissance de la population</b> : la communauté Internet ne cesse de grandir. En novembre 2005, Cisco estimait le nombre d’utilisateurs à environ 973 millions. Ce nombre a doublé depuis. De plus, les utilisateurs restent connectés plus longtemps, réservant des adresses IP pour des périodes plus longues et contactent chaque jour plus d’homologues.</li><li><b>Utilisateurs mobiles</b> : plus d’un milliard de téléphones portables sont en circulation. Il existe plus de 20 millions de périphériques mobiles utilisant une adresse IP, notamment les <content-link target="{BC13802E-F3CA-41B0-AFD7-30D8C2EDF019}" type="glossary">assistants numériques</content-link> personnels (<content-link target="{CF04F531-2FED-4CAF-9318-56BECA3BF996}" type="glossary">PDA</content-link>), les tablettes à stylet, les tablettes électroniques et les lecteurs de codes à barres. De plus en plus de périphériques mobiles utilisant une adresse IP voient le jour. Les nouveaux téléphones portables ont besoin d’une adresse IP, contrairement aux anciens.</li><li><b>Transport</b> : d’ici 2008, on comptera plus d’un milliard de voitures. Les nouveaux modèles utilisent une adresse IP pour permettre une surveillance à distance et offrir un service et une assistance rapides. Lufthansa propose déjà une connectivité Internet sur ses vols. D’autres transporteurs, notamment maritimes, proposeront bientôt des services semblables.</li><li><b>Électronique grand public</b> : les derniers appareils ménagers utilisent la technologie IP pour permettre une surveillance à distance. Les magnétoscopes numériques qui téléchargent et mettent à jour des guides des programmes depuis Internet en sont un bon exemple. La création d’un réseau domestique peut permettre de connecter ces appareils. </li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl1407030102">
<content-media type="InteractiveGraphicHotspots" id="cm7560691137">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030100/tl1407030102/cm7560691137.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030100/tl1407030102/cm7560691137text.xml"/></content-media> <content-text><p><b>Pourquoi utiliser IPv6</b></p> <p>La transition d’IPv4 à IPv6 a déjà commencé, particulièrement en Europe, au Japon et dans la région Asie-Pacifique. Dans ces régions, les adresses IPv4 disponibles deviennent rares, ce qui rend le protocole IPv6 encore plus attrayant et nécessaire. Le Japon a officiellement commencé la transition en l’an 2000 lorsque le gouvernement japonais a décrété la mise en œuvre du protocole IPv6 et a fixé comme objectif de mettre à niveau tous les systèmes de chaque entreprise et du secteur public d’ici 2005. La Corée, la Chine et la Malaisie ont lancé des initiatives du même genre. </p> <p>En 2002, l’IPv6 Task Force de la Communauté européenne a créé une alliance stratégique pour favoriser l’adoption de l’IPv6 dans le monde entier. L’IPv6 Task Force d’Amérique du nord s’est engagé à pousser les marchés nord-américains à adopter l’IPv6. Les premières avancées visibles sur le marché nord-américain viennent du <content-link target="{62CEF1AB-ED20-4C1C-9628-51589EF1CE1F}" type="glossary">Ministère américain de la Défense</content-link> (<content-link target="{AE4224F3-7DB9-4E61-BFBF-C195E1251D86}" type="glossary">DoD</content-link>). Tourné vers l’avenir et conscient des avantages des périphériques avec IP, le DoD a décrété dès 2003 que tout appareil acheté devait non seulement être compatible IP, mais qu’il devait être compatible avec IPv6. De fait, toutes les agences gouvernementales américaines doivent commencer à utiliser l’IPv6 dans leur réseau principal d’ici 2008 ; les agences s’engagent à respecter cette échéance. </p> <p>La capacité à faire évoluer les réseaux pour les demandes futures nécessite une source inépuisable d’adresses IP et une plus grande mobilité que DHCP et NAT ne peuvent pas offrir. L’IPv6 permet de répondre aux exigences de plus en plus complexes de l’adressage hiérarchique que l’IPv4 ne peut pas assurer. </p> <p>Étant donné l’énorme base installée d’IPv4 dans le monde, il est facile de comprendre pourquoi la transition de déploiements IPv4 vers IPv6 représente un réel défi. Cependant, diverses techniques, y compris une option de configuration automatique, facilitent cette transition. Le mécanisme de transition à utiliser dépend des besoins de votre réseau.</p> <p>La figure compare les représentations binaires et alphanumériques des adresses IPv4 et IPv6. Une adresse IPv6 est une valeur binaire longue de 128 bits, pouvant être affichée sous forme d’écriture hexadécimale à 32 chiffres. L’IPv6 devrait offrir suffisamment d’adresses pour pallier aux besoins de la croissance d’Internet pour de nombreuses années. Il existe suffisamment d’adresses IPv6 pour attribuer plus de l’ensemble de l’espace d’adressage Internet IPv4 à chaque être humain.</p> <p><b>Cliquez sur le bouton Perspectives dans la figure.</b></p> <p>Qu’est-il arrivé à IPv5 ? IPv5 a été utilisé pour définir un protocole RTSP (real-time streaming protocol) expérimental. Pour éviter toute confusion, il a été décidé de ne pas utiliser IPv5 et de nommer le nouveau protocole IP « IPv6 ».</p></content-text>
</page>
<page type="OneColumn" id="tl1407030103">
<content-media type="InteractiveGraphicHotspots" id="cm9648652735">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030100/tl1407030103/cm9648652735.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030100/tl1407030103/cm9648652735text.xml"/></content-media> <content-text><p>L’IPv6 n’existerait pas si la pénurie d’adresses IPv4 disponibles n’était pas connue de tous. Cependant, au-delà de l’augmentation de l’espace d’adressage IP, le développement d’IPv6 a permis d’appliquer les leçons tirées des limitations de l’IPv4 pour créer un protocole avec des fonctions nouvelles et améliorées. </p> <p>Une architecture à en-tête et un fonctionnement de protocole simplifiés permet de réduire les coûts d’exploitation. Grâce à des fonctions de sécurité intégrées, les pratiques de sécurité sont plus simples, ce qui fait défaut dans de nombreux réseaux actuels. L’une des améliorations les plus significatives qu’offre l’IPv6 est cependant les fonctions de configuration automatique des adresses. </p> <p>Internet est en train de passer d’une collection de périphériques fixes à un réseau fluide de périphériques mobiles. L’IPv6 permet aux périphériques mobiles d’acquérir rapidement des adresses et de passer de l’une à l’autre lorsqu’ils se trouvent sur des réseaux étrangers, sans avoir besoin d’un agent étranger. (Un agent étranger est un routeur pouvant agir comme point de connexion pour un périphérique mobile lorsqu’il utilise un réseau étranger en lieu et place de son propre réseau.) </p> <p>La configuration automatique des adresses est également synonyme d’une connectivité réseau plug-and-play plus robuste. La configuration automatique prend en charge les clients pouvant avoir des ordinateurs, imprimantes, appareils photo numériques, radios numériques, téléphones par IP, appareils ménagers utilisant Internet et gadgets robotisés connectés à leur réseau personnel. De nombreux fabricants intègrent déjà la technologie IPv6 dans leurs produits.</p> <p>Cette section décrit de nombreuses améliorations apportées par IPv6, notamment :</p> <p><ul><li>l’adressage IP avancé ;</li><li>l’en-tête simplifié ;</li><li>la mobilité et la sécurité ; </li><li>la richesse de la transition.</li></ul></p> <p><b>Adressage IP avancé</b></p> <p>Un plus grand espace d’adressage représente plusieurs améliorations, notamment : </p> <p><ul><li>Une accessibilité et une souplesse globales améliorées.</li><li>Une meilleure agrégation des préfixes IP annoncés dans les tables de routage.</li><li>Des <content-link target="{96D0E7A6-DD4B-43FD-9C6A-060803CD1AD7}" type="glossary">ordinateurs multiconnectés</content-link>. Le <content-link target="{0BC056D0-4854-4C7F-8F78-5712244B6673}" type="glossary">multihébergement</content-link> est une technique qui permet d’accroître la fiabilité de la connexion Internet sur un réseau IP. Avec IPv6, un hôte peut avoir plusieurs adresses IP sur une seule liaison ascendante physique. Un hôte peut par exemple se connecter à plusieurs FAI.</li><li>La configuration automatique pouvant inclure des adresses de couche liaison de données dans l’espace d’adressage.</li><li>Plus d’options plug-and-play pour plus de périphériques.</li><li>Réadressage public-privé de bout en bout sans traduction d’adresses. Les réseaux peer to peer sont ainsi plus fonctionnels et plus faciles à déployer.</li><li>Des mécanismes simplifiés pour la renumérotation et la modification des adresses.</li></ul></p> <p><b>Cliquez sur le bouton En-tête simple dans la figure.</b></p> <p>La figure compare la structure d’en-tête simplifiée d’IPv6 à l’en-tête d’IPv4. L’en-tête d’IPv4 compte 20 octets et 12 champs d’en-tête de base, suivis d’un champ d’options et d’une partie données (généralement le segment de <content-link target="{3813DE36-B20A-4CED-834A-BAF0BBBA1474}" type="glossary">couche transport</content-link>). L’en-tête d’IPv6 compte 40 octets, trois champs d’en-tête de base IPv4 et cinq champs d’en-tête supplémentaires. </p> <p>L’en-tête simplifié d’IPv6 offre plusieurs avantages par rapport à IPv4 : </p> <p><ul><li>Une plus grande efficacité du routage pour des performances et évolutivité du débit de transmission.</li><li>Aucune diffusion et donc aucun risque de tempêtes de diffusion.</li><li>Aucune exigence pour le traitement des sommes de contrôle.</li><li>Systèmes d’en-têtes d’extension simplifiés et plus efficaces.</li><li>Étiquetage de flux pour le traitement par flux sans besoin d’ouvrir le paquet interne de transport pour identifier les différents flux de trafic.</li></ul></p> <p><b>Mobilité et sécurité améliorées</b></p> <p>La mobilité et la sécurité aident à garantir la conformité aux normes de fonctionnalité <content-link target="{01D9F02E-61C1-4D40-9704-C1D6CFC0B8D4}" type="glossary">Mobile IP</content-link> et IP Security (IPsec). La mobilité permet aux utilisateurs de périphériques réseau mobiles (dont la plupart disposent d’une connectivité sans fil) de passer d’un réseau à un autre.</p> <p><ul><li>La norme IETF Mobile IP est disponible pour IPv4 et pour IPv6. Cette norme permet aux périphériques mobiles de se déplacer sans interruptions dans des connexions réseau établies. Les périphériques mobiles utilisent une adresse permanente (Home Address) et une adresse temporaire (Care-of Address) pour bénéficier de cette mobilité. Avec IPv4, ces adresses sont configurées manuellement. Avec IPv6, les configurations sont dynamiques, ce qui offre de la mobilité aux périphériques IPv6.</li><li>IPsec est disponible pour IPv4 et pour IPv6. Bien que les fonctionnalités soient quasiment identiques dans les deux environnements, IPsec est obligatoire dans IPv6, ce qui rend Internet par IPv6 plus sécurisé. </li></ul></p> <p><b>Richesse de la transition</b></p> <p>Le protocole IPv4 ne va pas disparaître du jour au lendemain. Il va coexister avec le protocole IPv6 avant de disparaître petit à petit. C’est pour cela que l’IPv6 a été livré avec des techniques de migration afin de traiter tous les scénarios de mise à niveau d’IPv4 possibles. Cependant, bon nombre de ces techniques ont finalement été rejetées par la communauté technologique. </p> <p>Il existe actuellement trois approches principales :</p> <p><ul><li><content-link target="{5A031F62-DB2B-48CE-B80C-76DCB2E7D508}" type="glossary">Double pile</content-link> </li><li>Transmission tunnel <content-link target="{B1567C90-CA76-41D5-B8C9-9C429E35C2E3}" type="glossary">6to4</content-link> </li><li>NAT-PT, transmission tunnel <content-link target="{69BFF587-F4F9-46D6-B107-2206D93FDF74}" type="glossary">ISATAP</content-link> et transmission tunnel <content-link target="{7C12AA82-1FCF-4BF4-8866-726DB4A139F0}" type="glossary">Teredo</content-link> (en dernier recours)</li></ul></p> <p>Certaines de ces approches sont expliquées plus en détail plus loin dans ce chapitre. </p> <p>Il est actuellement conseillé de suivre la règle suivante lors de la transition à IPv6 : « Utilisez la double pile quand vous pouvez, le tunnel quand vous devez ! ».</p></content-text>
</page>
</topic>
<topic type="" id="tl1407030200">
<title><content-text>Adressage IPv6</content-text></title>
<page type="OneColumn" id="tl1407030201">
<content-media type="StaticGraphic" id="cm9707697458">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030200/tl1407030201/cm9707697458.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030200/tl1407030201/cm9707697458text.xml"/></content-media> <content-text><p><b>Représentation d’une adresse IPv6</b></p> <p>Vous savez qu’une adresse IPv4 sur 32 bits est représentée par une série de quatre champs de 8 bits, séparés par des points. Étant donné leur taille, les adresses IPv6 sur 128 bits doivent être représentées différemment. Les adresses IPv6 utilisent des signes deux-points (:) pour séparer les entrées d’une série hexadécimale de 16 bits. </p> <p><b>Cliquez sur le bouton Représentation dans la figure. </b></p> <p>La figure illustre l’adresse <b>2031:0000:130F:0000:0000:09C0:876A:130B</b>. La notation explicite en chaîne d’adresses n’est pas requise avec IPv6. La figure montre comment raccourcir l’adresse en respectant les règles suivantes :</p> <p><ul><li>Dans un champ, les zéros de tête sont facultatifs. Par exemple, le champ 09C0 est équivalent à 9C0 et le champ 0000 est équivalent à 0. Ainsi, 2031:<b>0000</b>:130F:0000:0000:<b>09C0</b>:876A:130B peut être écrit comme ceci : 2031:<b>0</b>:130F:0000:0000:<b>9C0</b>:876A:130B.</li><li>Des champs successifs de zéros peuvent être représentés comme deux signes deux-points (::). Vous ne pouvez cependant utiliser cette abréviation qu’une seule fois dans une même adresse. Par exemple 2031:0:130F:<b>0000</b>:<b>0000</b>:9C0:876A:130B peut être écrit comme ceci : 2031:0:130F::9C0:876A:130B.</li><li>Une adresse indéterminée est écrite comme ceci : « :: ». En effet, elle ne contient que des zéros.</li></ul></p> <p>La notation « :: » permet de réduire de façon conséquente la taille de la plupart des adresses. Un analyseur d’adresses identifie le nombre de zéros manquants en séparant deux sections d’une adresse et en entrant des zéros jusqu’à ce que l’adresse soit complète.</p> <p><b>Cliquez sur le bouton Exemples dans la figure</b> pour afficher d’autres exemples.</p></content-text>
</page>
<page type="OneColumn" id="tl1407030202">
<content-media type="InteractiveGraphicHotspots" id="cm7203451769">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030200/tl1407030202/cm7203451769.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030200/tl1407030202/cm7203451769text.xml"/></content-media> <content-text><p><b>Adresse de monodiffusion globale IPv6</b></p> <p>Le format d’adresse IPv6 permet l’agrégation de manière ascendante jusqu’au FAI. Les <content-link target="{49C1C003-C9B7-4CB4-AA14-3048046FCBBE}" type="glossary">adresses de monodiffusion globales</content-link> comprennent généralement un préfixe de routage global de 48 bits et un ID de sous-réseau de 16 bits. Les organisations individuelles peuvent utiliser un champ de sous-réseau de 16 bits pour créer leur propre hiérarchie d’adressage local. Ce champ permet à une organisation d’utiliser jusqu’à 65 535 sous-réseaux individuels.</p> <p>La partie supérieure de la figure illustre comment une hiérarchie supplémentaire est ajoutée au préfixe de routage global de 48 bits grâce au préfixe de registre, préfixe de FAI et préfixe de site. </p> <p>L’adresse de monodiffusion globale actuelle qui est attribuée par l’<content-link target="{38055F33-7CF2-40FC-808E-01A24C982FBE}" type="glossary">IANA</content-link> utilise la plage d’adresses qui commence par la valeur binaire 001 (2000::/3), qui correspond à 1/8ème de l’espace d’adressage IPv6 total. Il s’agit du bloc d’adresses attribuées le plus important. L’IANA alloue l’espace d’adressage IPv6 dans les plages de 2001::/16 aux cinq organismes d’enregistrement Internet locaux (ARIN, RIPE, APNIC, LACNIC et AfriNIC). </p> <p>Pour plus d’informations, consultez le document RFC 3587, IPv6 Global Unicast Address Format (Format d’adresse de monodiffusion globale IPv6), qui remplace le document RFC 2374.</p> <p><b>Adresses réservées</b></p> <p>L’IETF se réserve une partie de l’espace d’adressage IPv6 pour divers usages, présents et futurs. Les adresses réservées représentent 1/256ème de l’ensemble de l’espace d’adressage IPv6. Certains des autres types d’adresses IPv6 proviennent de ce bloc.</p> <p><b>Adresses privées</b></p> <p>Un bloc d’adresses IPv6 est mis de côté pour les adresses privées, comme c’est le cas avec IPv4. Ces adresses privées ne sont destinées qu’à un lien ou un site précis ; elles ne sont jamais acheminées en dehors d’un réseau donné d’une entreprise. La notation hexadécimale des adresses privées commence par une première valeur d’octet de « FE », suivie d’un chiffre hexadécimal compris entre 8 et F. </p> <p>Ces adresses sont ensuite divisées en deux types, selon leur étendue.</p> <p><ul><li>Les <b>adresses locales-sites</b> sont des adresses semblables au document RFC 1918 « Address Allocation for Private Internets » (Classes d’adresses privées) pour le protocole IPv4 actuel. L’étendue de ces adresses correspond à l’ensemble d’un site ou d’une organisation. Cependant, l’utilisation d’adresses locales-sites pose problème et est désapprouvée depuis 2003 par le document RFC 3879. En notation hexadécimale, les adresses locales-sites commencent par « FE », le troisième chiffre hexadécimal étant compris entre « C » et « F ». Ces adresses commencent donc par « FEC », « FED », « FEE » ou « FEF ».</li><li>Les <b><content-link target="{6377B8ED-80CC-4001-9545-3A313F4F76CC}" type="glossary">adresses de monodiffusion de liaison locale</content-link></b> sont nouvelles dans le concept de l’adressage avec IP dans la couche réseau. L’étendue de ces adresses est inférieure à celle des adresses locales-sites ; elles ne se rapportent qu’à une liaison physique particulière (réseau physique). Les routeurs ne transfèrent pas de datagrammes via des adresses locales-liens, pas même au sein de l’organisation. Ces adresses ne sont valides que pour les communications locales sur un segment de réseau physique donné. Elles sont utilisées pour les communications de liaison telles que la configuration automatique de l’adresse et la détection de voisins et de routeurs. De nombreux protocoles de routage IPv6 utilisent également les adresses locales-liens. Les adresses locales-liens commencent par « FE », le troisième chiffre hexadécimal étant compris entre « 8 » et « B ». Ces adresses commencent donc par « FE8 », « FE9 », « FEA » ou « FEB ».</li></ul></p> <p><b>Adresse de bouclage </b></p> <p>Comme pour IPv4, une adresse de bouclage IPv6 spéciale a été prévue à des fins de test ; les datagrammes envoyés à cette adresse sont renvoyés au périphérique expéditeur. Cependant, pour IPv6, une seule adresse est vouée à cette fonction, et non tout un bloc. L’adresse de bouclage est 0:0:0:0:0:0:0:1, normalement exprimée sous la forme « ::1 » après application de la compression des zéros.</p> <p><b>Adresse indéterminée </b></p> <p>Dans IPv4, une adresse IP composée uniquement de zéros a une signification particulière : elle représente l’hôte lui-même et est utilisée lorsqu’un périphérique ne connaît pas sa propre adresse. Dans IPv6, ce concept a été formalisé et l’adresse composée uniquement de zéros (0:0:0:0:0:0:0:0) est appelée adresse indéterminée. Elle est généralement utilisée dans le champ source d’un datagramme envoyé par un périphérique cherchant à faire configurer son adresse IP. Vous pouvez appliquer la compression d’adresse à cette adresse. L’adresse n’étant composée que de zéros, sa forme abrégée est « :: ».</p></content-text>
</page>
<page type="OneColumn" id="tl1407030203">
<content-media type="StaticGraphic" id="cm5400670251">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030200/tl1407030203/cm5400670251.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030200/tl1407030203/cm5400670251text.xml"/></content-media> <content-text><p><b>Gestion des adresses IPv6 </b></p> <p>Les adresses IPv6 utilisent des identificateurs d’interface pour identifier les interfaces sur une liaison. On peut les considérer comme la partie hôte d’une adresse IPv6. Les identificateurs d’interface doivent être uniques sur une même liaison. Ils sont toujours exprimés sur 64 bits et peuvent être créés de façon dynamique à partir d’une adresse de couche 2 (MAC). </p> <p>Vous pouvez attribuer un ID d’adresse IPv6 de façon statique ou dynamique :</p> <p><ul><li>Attribution statique à l’aide d’un ID d’interface manuel </li><li>Attribution statique à l’aide d’un ID d’interface EUI-64 </li><li><content-link target="{040D2316-5F29-4499-8C5D-3A27CABE2D2A}" type="glossary">Configuration automatique sans état</content-link></li><li>DHCP pour IPv6 (DHCPv6)</li></ul></p> <p><b>Attribution manuelle de l’ID d’interface</b></p> <p>L’un des moyens d’attribuer de façon statique une adresse IPv6 à un périphérique consiste à attribuer manuellement le préfixe (réseau) et l’ID d’interface (hôte) de l’adresse IPv6. Pour configurer une adresse IPv6 sur l’interface d’un routeur Cisco, utilisez la commande <span class="cmd"><b>ipv6 address</b><i> adresse-ipv6/longueur-préfixe</i></span> en mode de configuration de l’interface. L’exemple suivant illustre l’attribution d’une adresse IPv6 à l’interface d’un routeur Cisco :</p> <p><span class="cmd">RouterX(config-if)#<b>ipv6 address 2001:DB8:2222:7272::72/64</b></span></p> <p><b>Attribution de l’ID d’interface EUI-64</b></p> <p>Un autre moyen d’attribuer une adresse IPv6 consiste à configurer la partie préfixe (réseau) de l’adresse IPv6 et d’obtenir ensuite la partie ID d’interface (hôte) à partir de l’adresse MAC de couche 2 du périphérique, appelée ID d’interface <content-link target="{C8E4563F-02F5-4500-AE1B-97518D13514D}" type="glossary">EUI-64</content-link>. </p> <p><b>Cliquez sur le bouton EUI-64 dans la figure. </b></p> <p>La norme EUI-64 explique comment faire passer des adresses MAC IEEE 802 de 48 à 64 bits en insérant la valeur 0xFFFE sur 16 bits au milieu, au niveau du 24ème bit de l’adresse MAC afin de créer un identificateur d’interface unique sur 64 bits.</p> <p>Pour configurer une adresse IPv6 sur l’interface d’un routeur Cisco et activer le traitement IPv6 en utilisant EUI-64 sur cette interface, utilisez la commande <span class="cmd"><b>ipv6 address </b> <i>préfixe-ipv6/longueur-préfixe </i> <b>eui-64</b></span> en mode de configuration de l’interface. L’exemple suivant illustre l’attribution d’une adresse EUI-64 à l’interface d’un routeur Cisco : </p> <p><span class="cmd">RouterX(config-if)#<b>ipv6 address 2001:DB8:2222:7272::/64 eui-64</b></span></p> <p><b>Configuration automatique sans état </b></p> <p>La configuration automatique permet de configurer automatiquement l’adresse IPv6. Dans IPv6, on suppose que des périphériques autres que des ordinateurs et des terminaux seront connectés au réseau. Le système de configuration automatique a été créé pour permettre la mise en réseau plug-and-play de ces périphériques afin de diminuer les coûts d’administration. </p> <p><b>DHCPv6 (dynamique)</b> </p> <p>DHCPv6 permet aux serveurs DHCP de transmettre les paramètres de configuration, tels que les adresses réseau IPv6, aux nœuds IPv6. Ce protocole permet d’allouer automatiquement des adresses réseau réutilisables et offre davantage de souplesse au niveau de la configuration. Ce protocole est le pendant dynamique de la configuration automatique d’adresse sans état IPv6 (RFC 2462) ; il peut être utilisé séparément ou avec la configuration automatique d’adresse sans état IPv6 en vue d’obtenir les paramètres de configuration.</p> <p>Pour plus d’informations sur l’attribution d’adresses IPv6, visitez le site suivant : <content-link target="http://www.netbsd.org/docs/network/ipv6/" type="external">http://www.netbsd.org/docs/network/ipv6/</content-link>. </p></content-text>
</page>
</topic>
<topic type="" id="tl1407030300">
<title><content-text>Stratégies de transition à IPv6</content-text></title>
<page type="OneColumn" id="tl1407030301">
<content-media type="StaticGraphic" id="cm1536308169">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030300/tl1407030301/cm1536308169.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030300/tl1407030301/cm1536308169text.xml"/></content-media> <content-text><p><b>Stratégies de transition à IPv6</b></p> <p>La transition depuis IPv4 ne nécessite pas de mise à niveau sur tous les nœuds au même moment. De nombreux systèmes de transition permettent une intégration en douceur d’IPv4 et d’IPv6. D’autres systèmes permettent à des nœuds IPv4 de communiquer avec des nœuds IPv6. Les stratégies divergent selon les situations. La figure illustre la richesse des stratégies de transition existantes.</p> <p>Rappelez-vous de ce conseil : « utilisez la double pile quand vous pouvez, le tunnel quand vous devez ». Ces deux méthodes sont les techniques les plus couramment utilisées pour faire la transition entre IPv4 et IPv6. </p> <p><b>Double pile</b></p> <p>Le mode double pile est une méthode d’intégration dans laquelle un nœud a une mise en œuvre et une connectivité à un réseau IPv4 et IPv6. Il s’agit de l’option recommandée et nécessite l’exécution simultanée d’IPv4 et d’IPv6. Le routeur et les commutateurs sont configurés pour prendre en charge les deux protocoles, IPv6 étant le protocole préféré.</p> <p><b>Transmission tunnel</b></p> <p>La deuxième technique principale de transition s’appelle la transmission tunnel. Il existe plusieurs techniques de transmission tunnel, notamment :</p> <p><ul><li>Transmission tunnel manuel d’IPv6 sur IPv4 : un paquet IPv6 est encapsulé dans le protocole IPv4. Cette méthode nécessite des routeurs à double pile.</li><li>Transmission tunnel 6to4 dynamique : établit automatiquement la connexion des îlots IPv6 via un réseau IPv4, généralement Internet. Elle applique de façon dynamique un préfixe IPv6 unique et valide à chaque îlot IPv6, ce qui permet de déployer rapidement l’IPv6 dans un réseau d’entreprise sans récupération des adresses par les FAI ou les organismes d’enregistrement.</li></ul></p> <p>Parmi les autres techniques de transmission tunnel qui sont connues mais qui ne sont pas traitées dans ce cours, citons :</p> <p><ul><li>Le protocole ISATAP (Intra-Site Automatic Tunnel Addressing Protocol) : mécanisme de transmission tunnel de superposition automatique qui utilise le réseau IPv4 sous-jacent comme couche liaison pour IPv6. Les tunnels ISATAP permettent aux hôtes à double pile IPv4 ou IPv6 d’un même site de communiquer avec d’autres hôtes identiques sur une liaison virtuelle, créant ainsi un réseau IPv6 à l’aide de l’infrastructure IPv4. </li><li>Transmission tunnel Teredo : technologie de transition à IPv6 qui offre une transmission tunnel d’hôte à hôte automatique plutôt que la transmission tunnel vers une passerelle. Cette approche transmet un trafic IPv6 monodiffusion lorsque les hôtes à double pile (les hôtes qui exécutent à la fois IPv6 et IPv4) se trouvent derrière un ou plusieurs NAT IPv4.</li></ul></p> <p><b>NAT-PT (NAT-Protocol Translation)</b></p> <p>La version 12.3(2)T de Cisco IOS et les versions ultérieures (avec le jeu de fonctions approprié) comprennent également NAT-PT entre IPv6 et IPv4. Cette traduction permet aux hôtes qui utilisent différentes versions du protocole IP de communiquer directement. Ces traductions sont plus complexes que la fonction NAT d’IPv4. À l’heure actuelle, cette méthode de traduction constitue l’option la moins favorable et ne doit être utilisée qu’en dernier recours.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407030400">
<title><content-text>Double pile Cisco IOS</content-text></title>
<page type="OneColumn" id="tl1407030401">
<content-media type="StaticGraphic" id="cm4224964936">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030400/tl1407030401/cm4224964936.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030400/tl1407030401/cm4224964936text.xml"/></content-media> <content-text><p><b>Double pile Cisco IOS</b></p> <p>Le mode double pile est une méthode d’intégration qui permet à un nœud d’avoir une connectivité avec un réseau IPv4 et IPv6 en même temps. Chaque nœud dispose de deux piles de protocole avec la configuration sur la même interface ou sur plusieurs interfaces. </p> <p>L’approche à double pile de l’intégration d’IPv6, dans laquelle les nœuds ont à la fois des piles IPv4 et IPv6, constituera l’une des méthodes d’intégration les plus couramment utilisées. Un nœud à double pile choisit la pile à utiliser en fonction de l’adresse de destination du paquet. Un nœud à double pile doit privilégier l’IPv6 lorsque celui-ci est disponible. Les anciennes applications n’utilisant qu’IPv4 continuent à fonctionner comme avant. Les nouvelles applications ou les applications modifiées profitent des deux couches IP.</p> <p>Une nouvelle <content-link target="{2771197D-7900-44AC-81BA-7C9395C71105}" type="glossary">interface de programmation d’application</content-link> (<content-link target="{14979236-EFA0-4318-9A62-AE00FAED7118}" type="glossary">API</content-link>) a été définie pour prendre en charge les adresses IPv4 et IPv6 et les requêtes DNS. Une API facilite l’échange de messages ou de données entre plusieurs applications logicielles. Par exemple, l’interface virtuelle entre deux fonctions logicielles, telles qu’un traitement de texte et une feuille de calcul, constitue une API. L’API est intégrée aux applications logicielles afin de convertir IPv4 en IPv6, et inversement à l’aide du mécanisme de conversion IP. Les nouvelles applications peuvent utiliser à la fois IPv4 et IPv6. </p> <p>L’expérience de la transition d’applications IPv4 vers IPv6 porte à croire que pour la majorité des applications, il existe une modification minime dans certaines parties du code source. Cette technique est bien connue et a été appliquée par le passé pour d’autres transitions de protocoles. Elle permet la mise à niveau progressive des applications, les unes après les autres, vers IPv6.</p> <p><b>Cliquez sur le bouton Configuration de l’interface IPv6 dans la figure.</b></p> <p>La version 12.2(2)T de Cisco IOS et les versions ultérieures (avec le jeu de fonctions approprié) sont compatibles avec IPv6. Dès que vous configurez les protocoles IPv4 et IPv6 de base sur l’interface, cette dernière est à double pile et transfère le trafic IPv4 et IPv6 sur cette interface. Notez qu’une adresse IPv4 et une adresse IPv6 ont été configurées.</p> <p>Pour utiliser IPv6 sur un routeur Cisco IOS, vous devez utiliser la commande de configuration globale <span class="cmd"><b>ipv6 unicast-routing</b></span>. Cette commande permet de transférer les datagrammes IPv6.</p> <p>Vous devez configurer toutes les interfaces qui transfèrent le trafic IPv6 avec une adresse IPv6 à l’aide de la commande d’interface <span class="cmd"><b>ipv6 address </b> <i>adresse-IPv6</i> [/<i>longueur-préfixe</i>]</span>.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407030500">
<title><content-text>Transmission tunnel IPv6</content-text></title>
<page type="OneColumn" id="tl1407030501">
<content-media type="StaticGraphic" id="cm2393730549">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030500/tl1407030501/cm2393730549.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030500/tl1407030501/cm2393730549text.xml"/></content-media> <content-text><p><b>Transmission tunnel IPv6</b></p> <p>La transmission tunnel est une méthode d’intégration dans laquelle un paquet IPv6 est encapsulé dans un autre protocole, par exemple IPv4. Cette méthode permet de connecter les îlots IPv6 sans avoir à convertir les réseaux intermédiaires à IPv6. Lorsque l’IPv4 est utilisé pour encapsuler le paquet IPv6, un type de protocole 41 est spécifié dans l’en-tête IPv4 ; le paquet comprend un en-tête IPv4 sur 20 octets sans aucune option et un en-tête IPv6 et des données utiles. Cette méthode nécessite également des routeurs à double pile. </p> <p>La transmission tunnel pose les deux problèmes suivants. L’<content-link target="{86BF9E5E-D82A-4B4D-98BD-A06D19BA69F3}" type="glossary">unité de transmission maximale</content-link> (<content-link target="{8E084A16-DBE2-402F-89CA-127F980A1F3A}" type="glossary">MTU</content-link>) diminue de 20 octets si l’en-tête IPv4 ne contient pas de champs facultatifs. De plus, un réseau avec transmission tunnel est souvent difficile à dépanner.</p> <p>La transmission tunnel est une technique d’intégration et de transition intermédiaire ; elle ne doit pas être considérée comme une solution finale. Une architecture IPv6 native doit constituer l’objectif ultime.</p></content-text>
</page>
<page type="OneColumn" id="tl1407030502">
<content-media type="StaticGraphic" id="cm5883982319">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030500/tl1407030502/cm5883982319.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030500/tl1407030502/cm5883982319text.xml"/></content-media> <content-text><p><b>Tunnel IPv6 configuré manuellement</b></p> <p>Un tunnel configuré manuellement équivaut à une liaison permanente entre deux domaines IPv6 sur un réseau fédérateur IPv4. Il est principalement utilisé pour des connexions stables qui nécessitent une communication sécurisée régulière entre deux routeurs de périphérie ou entre un système d’extrémité et un routeur de périphérie, ou pour la connexion à des réseaux IPv6 distants. Les routeurs d’extrémité doivent être à double pile et la configuration ne peut pas changer de façon dynamique car les besoins en réseau et en routage changent.</p> <p>Les administrateurs configurent manuellement une adresse IPv6 statique sur une interface de tunnel et attribuent manuellement les adresses IPv4 statiques configurées à la source et à la destination du tunnel. À chaque extrémité d’un tunnel configuré, l’hôte ou le routeur doit prendre en charge les piles de protocole IPv4 et IPv6. Les tunnels configurés manuellement peuvent être configurés entre des routeurs périphériques ou entre un routeur périphérique et un hôte.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407030600">
<title><content-text>Considérations sur le routage IPv6</content-text></title>
<page type="OneColumn" id="tl1407030601">
<content-media type="StaticGraphic" id="cm6689742715">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030600/tl1407030601/cm6689742715.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030600/tl1407030601/cm6689742715text.xml"/></content-media> <content-text><p><b>Considérations sur le routage IPv6</b></p> <p>À l’instar du <content-link target="{FCDE8357-DF39-419B-A9F4-D088CDDD21E6}" type="glossary">routage interdomaine sans classe</content-link> (<content-link target="{BD788C82-F372-4866-A50A-3F374EA9A92F}" type="glossary">CIDR</content-link>) d’IPv4, IPv6 utilise le routage de correspondance la plus longue sur le préfixe. IPv6 utilise des versions modifiées de la plupart des protocoles de routage courants pour gérer les adresses IPv6 plus longues et les différentes structures d’en-tête.</p> <p>Des espaces d’adressage plus importants font de la place pour des allocations d’adresses volumineuses aux FAI et aux organisations. Un FAI agrège tous les préfixes de ses clients en un seul préfixe et publie ce préfixe sur Internet IPv6. La taille supérieure de l’espace d’adressage est suffisante pour permettre aux organisations de définir un préfixe unique pour l’ensemble de leur réseau.</p> <p>Mais en quoi cela affecte-t-il les performances du routeur ? Une révision rapide du fonctionnement d’un routeur dans un réseau va permettre d’illustrer en quoi l’IPv6 affecte le routage. Sur un plan conceptuel, le routeur a trois zones fonctionnelles :</p> <p><ul><li>Le plan de contrôle gère l’interaction du routeur avec les autres éléments du réseau, offrant les informations nécessaires pour prendre des décisions et contrôler l’ensemble des opérations du routeur. Ce plan exécute des processus tels que les protocoles de routage et la gestion du réseau. Ces fonctions sont généralement complexes. </li><li>Le plan de données gère le transfert de paquets d’une interface physique ou logique à une autre. Différents mécanismes de commutation sont employés, notamment le procédé de commutation et Cisco Express Forwarding (CEF) sur les routeurs du logiciel Cisco IOS. </li><li>Les services avancés comprennent des fonctionnalités évoluées appliquées lors du transfert de données, par exemple le filtrage des paquets, la qualité de service (QS), le chiffrement, la traduction et la comptabilisation. </li></ul></p> <p>L’IPv6 représente de nouveaux défis pour chacune de ces fonctions. </p> <p><b>Plan de contrôle IPv6</b></p> <p>L’activation d’IPv6 sur un routeur démarrer les processus d’exploitation de son plan de contrôle spécifiquement pour IPv6. Les caractéristiques du protocole déterminent les performances de ces processus et la quantité de ressources nécessaires pour leur utilisation : </p> <p><ul><li><b>Taille de l’adresse IPv6</b> : la taille de l’adresse affecte les fonctions de traitement des informations d’un routeur. Les systèmes utilisant une UC de 64 bits, un bus ou une structure de mémoire peuvent transmettre les adresses IPv4 source et de destination au cours d’un même cycle de traitement. Dans IPv6, les adresses source et de destination nécessitent chacune deux cycles (quatre cycles en tout) pour traiter les informations des adresses source et de destination. Ainsi, il y a des chances pour que les performances des routeurs ne se basant que sur le traitement logiciel soient inférieures aux performances dans un environnement IPv4. </li><li><b>Adresses de nœuds IPv6 multiples</b> : les nœuds IPv6 pouvant utiliser plusieurs adresses IPv6 monodiffusion, la consommation de mémoire du cache de la détection de voisins peut être affectée. </li><li><b>Protocoles de routage IPv6 </b> : les protocoles de routage IPv6 sont semblables à leurs pendants IPv4, mais un préfixe IPv6 étant quatre fois plus grand qu’un préfixe IPv4, les mises à jour de routage comportent plus d’informations. </li><li><b>Taille de la table de routage</b> : l’espace d’adressage IPv6 étant plus grand, les réseaux sont plus importants et Internet est beaucoup plus volumineux. Les tables de routage doivent donc être plus grandes et la configuration requise pour la mémoire plus élevée pour en assurer la prise en charge. </li></ul></p> <p><b>Plan de données IPv6</b></p> <p>Le plan de données transfère les paquets IP en fonction des décisions prises par le plan de contrôle. Le moteur de transmission analyse les informations pertinentes sur les paquets IP et cherche à faire correspondre les informations analysées aux stratégies de transfert définies par le plan de contrôle. L’IPv6 affecte les performances des fonctions d’analyse et de recherche : </p> <p><ul><li><b>Analyse des en-têtes d’extension IPv6</b> : les applications, notamment les applications mobiles IPv6, utilisent souvent les informations d’adresse IPv6 dans des en-têtes d’extension, augmentant ainsi leur taille. Ces champs supplémentaires représentent davantage de traitement. Par exemple, un routeur utilisant des listes de contrôle d’accès pour filtrer des informations de couche 4 doit appliquer les listes de contrôle d’accès aux paquets ayant des en-têtes d’extension ainsi qu’à ceux n’en ayant pas. Si la longueur de l’en-tête d’extension est supérieure à la longueur fixe du registre matériel du routeur, la commutation matérielle échoue et les paquets peuvent être dirigés vers la commutation logicielle ou être abandonnés. Ces opérations affectent sérieusement les performances du routeur en matière de transfert.</li><li><b>Recherche d’adresses IPv6</b> : IPv6 effectue une recherche sur les paquets entrant dans le routeur afin de trouver la bonne interface de sortie. Dans IPv4, le processus de prise de décision de transfert analyse une adresse de destination de 32 bits. Dans IPv6, la décision de transfert pourrait nécessiter l’analyse d’une adresse de 128 bits. De nos jours, la plupart des routeurs effectuent des recherches à l’aide d’un circuit intégré à application spécifique (ASIC) avec une configuration fixe qui effectue les fonctions pour lesquelles il était conçu à l’origine : l’IPv4. Cela peut également engendrer la transmission de paquets dans un processus logiciel plus lent, voire leur abandon.</li></ul></p></content-text>
</page>
<page type="OneColumn" id="tl1407030602">
<content-media type="StaticGraphic" id="cm9788136090">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030600/tl1407030602/cm9788136090.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030600/tl1407030602/cm9788136090text.xml"/></content-media> <content-text><p><b>Protocole de routage RIPng</b></p> <p>Les routes IPv6 utilisent les mêmes protocoles et les mêmes techniques qu’IPv4. Bien que les adresses soient plus longues, les protocoles utilisés pour le routage d’IPv6 sont simplement des extensions logiques des protocoles utilisés dans IPv4. </p> <p>Le document RFC 2080 définit le protocole d’informations de routage nouvelle génération (<content-link target="{6701051E-5D1C-4E48-BEA4-CEA3B1FDD38A}" type="glossary">RIPng</content-link>) comme un simple protocole de routage basé sur le protocole RIP. RIPng n’est pas plus ou moins puissant que RIP ; il permet cependant de facilement mettre en place un réseau IPv6 sans avoir besoin de créer un nouveau protocole de routage. </p> <p>RIPng est un protocole de routage à vecteur de distance ayant une limite de 15 sauts qui utilise le découpage d’horizon et les <content-link target="{FA51E5B4-5747-4E97-BDC0-91ACEF0FD13E}" type="glossary">mises à jour en mode empoisonnement inverse</content-link> pour empêcher les boucles de routage. Sa simplicité vient du fait qu’il ne nécessite pas d’avoir une connaissance globale du réseau. Seuls les <content-link target="{F18C3194-F090-4C48-98AF-DCE48338D1F9}" type="glossary">routeurs voisins</content-link> échangent des messages locaux.</p> <p>RIPng a les caractéristiques suivantes :</p> <p><ul><li>Basé sur IPv4 RIP version 2 (RIPv2) et est semblable à RIPv2.</li><li>Utilise IPv6 pour le transport.</li><li>Inclut le préfixe IPv6 et l’adresse IPv6 du saut suivant.</li><li>Utilise le <content-link target="{911B0C25-02FF-4A99-8506-EC16E30CA08F}" type="glossary">groupe de multidiffusion</content-link> <content-link target="{08F907A1-240A-4B98-8B5F-EECFD0E9F5B5}" type="glossary">FF02::9</content-link> comme adresse de destination pour les mises à jour RIP (semblable à la fonction de diffusion effectuée par le protocole RIP dans IPv4).</li><li>Envoie des mises à jour sur le protocole UDP port 521.</li><li>Est pris en charge par Cisco IOS version 12.2(2)T et versions ultérieures.</li></ul></p> <p>Dans le cas de déploiements à double pile, les protocoles RIP et RIPng sont tous deux requis.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407030700">
<title><content-text>Configuration des adresses IPv6</content-text></title>
<page type="OneColumn" id="tl1407030701">
<content-media type="StaticGraphic" id="cm2303979149">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030700/tl1407030701/cm2303979149.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030700/tl1407030701/cm2303979149text.xml"/></content-media> <content-text><p><b>Activation d’IPv6 sur les routeurs Cisco</b></p> <p>L’activation d’IPv6 sur un routeur s’effectue en deux étapes simples. Vous devez tout d’abord activer la transmission de trafic IPv6 sur le routeur, puis configurer chaque interface nécessitant IPv6. </p> <p>Par défaut, la transmission de trafic IPv6 est désactivée sur un routeur Cisco. Pour l’activer entre les interfaces, vous devez configurer la commande globale <span class="cmd"><b>ipv6 unicast-routing</b></span>. </p> <p>La commande <span class="cmd"><b>ipv6 address</b></span> peut configurer une adresse IPv6 globale. L’adresse locale-lien est automatiquement configurée lorsqu’une adresse est attribuée à l’interface. Vous devez spécifier l’ensemble de l’adresse IPv6 de 128 bits ou indiquer que vous voulez utiliser le préfixe de 64 bits en utilisant l’option <span class="cmd"><b>eui-64</b></span>.</p></content-text>
</page>
<page type="OneColumn" id="tl1407030702">
<content-media type="StaticGraphic" id="cm3099516220">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030700/tl1407030702/cm3099516220.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030700/tl1407030702/cm3099516220text.xml"/></content-media> <content-text><p><b>Exemple de configuration de l’adresse IPv6</b></p> <p>Vous pouvez spécifier l’adresse IPv6 dans son intégralité ou calculer l’identificateur d’hôte (les 64 bits les plus à droite) à partir de l’identificateur EUI-64 de l’interface. Dans cet exemple, l’adresse IPv6 de l’interface est configurée à l’aide du format EUI-64.</p> <p>Vous pouvez également spécifier l’ensemble de l’adresse IPv6 à attribuer à une interface de routeur en utilisant la commande <span class="cmd"><b>ipv6 address </b> <i>adresse-ipv6/longueur-préfixe</i></span> en mode de configuration d’interface.</p> <p>Lorsque vous configurez une adresse IPv6 sur une interface, l’adresse locale-lien est automatiquement configurée pour cette interface. </p></content-text>
</page>
<page type="OneColumn" id="tl1407030703">
<content-media type="StaticGraphic" id="cm9959481463">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030700/tl1407030703/cm9959481463.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030700/tl1407030703/cm9959481463text.xml"/></content-media> <content-text><p><b>Résolution de noms Cisco IOS pour IPv6 </b></p> <p>Vous pouvez effectuer une résolution de noms à partir du logiciel Cisco IOS de deux façons différentes :</p> <p><ul><li>En définissant un nom statique pour une adresse IPv6 à l’aide de la commande <span class="cmd"><b>ipv6 host name</b> [<i>port</i>] <i>ipv6-adresse1</i> [<i>ipv6-adresse2...ipv6-adresse4</i>]</span>. Vous pouvez définir jusqu’à quatre adresses IPv6 pour un même nom d’hôte. La partie « port » correspond au port Telnet à utiliser pour l’hôte correspondant.</li><li>En spécifiant le serveur de noms de domaine (DNS) utilisé par le routeur à l’aide de la commande <span class="cmd"><b>ip name-server</b> <i>adresse</i></span>. Il peut s’agir d’une adresse IPv4 ou IPv6. Cette commande vous permet de spécifier jusqu’à six serveurs de noms de domaine (DNS).</li></ul></p></content-text>
</page>
</topic>
<topic type="" id="tl1407030800">
<title><content-text>Configuration de RIPng avec IPv6</content-text></title>
<page type="OneColumn" id="tl1407030801">
<content-media type="StaticGraphic" id="cm3387824408">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030800/tl1407030801/cm3387824408.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030800/tl1407030801/cm3387824408text.xml"/></content-media> <content-text><p><b>Configuration de RIPng avec IPv6</b></p> <p>Lorsque vous configurez les protocoles de routage pris en charge en IPv6, vous devez créer le processus de routage, l’activer sur les interfaces, puis personnaliser le protocole de routage pour votre réseau.</p> <p>Avant de configurer le routeur pour qu’il exécute le protocole RIP IPv6, vous devez activer IPv6 globalement à l’aide de la commande de configuration globale <span class="cmd"><b>ipv6 unicast-routing</b></span> et activer IPv6 sur toutes les interfaces sur lesquelles vous souhaitez que le protocole RIP IPv6 soit activé.</p> <p>Pour activer le routage RIPng sur le routeur, utilisez la commande de configuration globale <span class="cmd"><b>ipv6 router rip </b> <i>nom</i></span>. Le paramètre <span class="cmd"><i>nom</i></span> identifie le processus RIP. Ce nom de processus est utilisé ultérieurement, au moment de la configuration de RIPng sur les interfaces concernées.</p> <p>Pour RIPng, plutôt que d’utiliser la commande <span class="cmd"><b>network</b></span> pour identifier les interfaces devant exécuter RIPng, vous devez utiliser la commande <span class="cmd"><b>ipv6 rip </b> <i>nom</i> <b> enable</b></span> en mode de configuration d’interface pour activer RIPng sur cette interface. Le paramètre <span class="cmd"><i>nom</i></span> doit correspondre au paramètre nom de la commande <span class="cmd"><b>ipv6 router rip</b></span>.</p> <p>Lorsque vous activez le protocole RIP sur une interface, un processus « router rip » est au besoin créé de façon dynamique.</p></content-text>
</page>
<page type="OneColumn" id="tl1407030802">
<content-media type="StaticGraphic" id="cm9465482678">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030800/tl1407030802/cm9465482678.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030800/tl1407030802/cm9465482678text.xml"/></content-media> <content-text><p><b>Exemple : configuration de RIPng pour IPv6</b></p> <p>Dans cet exemple, un réseau compte deux routeurs. Le routeur R1 est connecté au réseau par défaut. Sur les routeurs R2 et R1, le nom RT0 identifie le processus RIPng. RIPng est activé sur la première interface Ethernet du routeur R1 via la commande <span class="cmd"><b>ipv6 rip RT0 enable</b></span>. Le routeur R2 indique que RIPng est activé sur les deux interfaces Ethernet via la commande <span class="cmd"><b>ipv6 rip RT0 enable</b></span>.</p> <p>Cette configuration permet à Ethernet 1 sur le routeur R2 et aux interfaces Ethernet 0 des deux routeurs d’échanger des informations de routage RIPng.</p></content-text>
</page>
</topic>
<topic type="" id="tl1407030900">
<title><content-text>Vérification et dépannage de RIPng</content-text></title>
<page type="OneColumn" id="tl1407030901">
<content-media type="StaticGraphic" id="cm6738828042">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030900/tl1407030901/cm6738828042.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407030000/tl1407030900/tl1407030901/cm6738828042text.xml"/></content-media> <content-text><p><b>Vérification et dépannage de RIPng pour IPv6</b></p> <p>Une fois le protocole RIPng configuré, vous devez le vérifier. La figure affiche la liste des différentes commandes « show » que vous pouvez utiliser.</p> <p><b>Cliquez sur le bouton Dépannage dans la figure.</b></p> <p>Si vous vous apercevez au cours de la vérification que le protocole RIPng ne fonctionne pas correctement, vous devez le dépanner.</p> <p>La figure affiche la liste des commandes qui permettent de résoudre des problèmes de RIPng.</p></content-text>
</page>
<page type="FullScreen" id="tl1407030902">
<content-media type="ActivityPopup" id="cm1804566569">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407030000/tl1407030900/tl1407030902/cm1804566569/" mime="shockwave/flash" scale="true" type="directory" width="800" height="450" external="tl1407000000/tl1407030000/tl1407030900/tl1407030902/cm1804566569/icontext.xml"/></content-media> <content-text><p>Exercice Flash</p></content-text>
</page>
</topic>
</section>
<section type="" id="tl1407040000">
<title><content-text>Travaux pratiques du chapitre</content-text></title>
<topic type="" id="tl1407040100">
<title><content-text>Configuration de base de DHCP et NAT</content-text></title>
<page type="OneColumn" id="tl1407040101">
<content-media type="ActivityLab" id="cm4964607610">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407040000/tl1407040100/tl1407040101/cm4964607610/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407040000/tl1407040100/tl1407040101/cm4964607610/icontext.xml"/></content-media> <content-text><p>Au cours de ces travaux pratiques, vous allez configurer les services IP DHCP et NAT. L’un des routeurs est le serveur DHCP. L’autre routeur transfère les requêtes DHCP au serveur. Vous allez également configurer des fonctions NAT statique et dynamique, y compris la surcharge NAT. Une fois les configurations effectuées, vous vérifierez la connectivité entre les adresses internes et externes.</p></content-text>
</page>
<page type="OneColumn" id="tl1407040102">
<content-media type="ActivityPKA" id="cm8735836513">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407040000/tl1407040100/tl1407040102/cm8735836513/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407040000/tl1407040100/tl1407040102/cm8735836513/icontext.xml"/></content-media> <content-text><p>Cet exercice est une variante des travaux pratiques 7.4.1. Il est possible que Packet Tracer ne prenne pas en charge toutes les tâches indiquées dans les travaux pratiques. Cet exercice ne remplace pas les travaux pratiques. Packet Tracer ne remplace pas les travaux pratiques avec des équipements réels.</p> <p>Des instructions détaillées sont fournies tout au long de l’exercice, ainsi que dans le fichier PDF accessible par le lien suivant.</p> <p><content-link target="E4_PTAct_7_4_1.pdf" type="internalfile">Instructions pour l’exercice (PDF)</content-link></p> <p><b>Cliquez sur l’icône Packet Tracer pour plus d’informations.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl1407040200">
<title><content-text>Configuration avancée de DHCP et NAT</content-text></title>
<page type="OneColumn" id="tl1407040201">
<content-media type="ActivityLab" id="cm8894517315">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407040000/tl1407040200/tl1407040201/cm8894517315/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407040000/tl1407040200/tl1407040201/cm8894517315/icontext.xml"/></content-media> <content-text><p>Au cours de ces travaux pratiques, vous devez configurer les services d’adressage IP en utilisant le réseau représenté dans le diagramme de topologie. Si vous avez besoin d’aide, reportez-vous aux travaux pratiques sur la configuration de base de DHCP et NAT. Essayez cependant de travailler le plus possible par vous-même.</p></content-text>
</page>
<page type="OneColumn" id="tl1407040202">
<content-media type="ActivityPKA" id="cm3656238578">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407040000/tl1407040200/tl1407040202/cm3656238578/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407040000/tl1407040200/tl1407040202/cm3656238578/icontext.xml"/></content-media> <content-text><p>Cet exercice est une variante des travaux pratiques 7.4.2. Il est possible que Packet Tracer ne prenne pas en charge toutes les tâches indiquées dans les travaux pratiques. Cet exercice ne remplace pas les travaux pratiques. Packet Tracer ne remplace pas les travaux pratiques avec des équipements réels.</p> <p>Des instructions détaillées sont fournies tout au long de l’exercice, ainsi que dans le fichier PDF accessible par le lien suivant.</p> <p><content-link target="E4_PTAct_7_4_2.pdf" type="internalfile">Instructions pour l’exercice (PDF)</content-link></p> <p><b>Cliquez sur l’icône Packet Tracer pour plus d’informations.</b></p></content-text>
</page>
</topic>
<topic type="" id="tl1407040300">
<title><content-text>Dépannage de DHCP et NAT</content-text></title>
<page type="OneColumn" id="tl1407040301">
<content-media type="ActivityLab" id="cm8434137066">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407040000/tl1407040300/tl1407040301/cm8434137066/" mime="application/pdf" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407040000/tl1407040300/tl1407040301/cm8434137066/icontext.xml"/></content-media> <content-text><p>Les routeurs de votre société ont été configurés par un ingénieur réseau sans expérience. Plusieurs erreurs de configuration ont entraîné des problèmes de connectivité. Votre supérieur hiérarchique vous a demandé de dépanner et de corriger les erreurs de configuration et de documenter votre travail. Grâce à vos connaissances en DHCP, NAT et dans les méthodes de tests standard, détectez et corrigez les erreurs. Assurez-vous que tous les clients bénéficient d’une connectivité totale. </p></content-text>
</page>
<page type="OneColumn" id="tl1407040302">
<content-media type="ActivityPKA" id="cm7633888453">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407040000/tl1407040300/tl1407040302/cm7633888453/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407040000/tl1407040300/tl1407040302/cm7633888453/icontext.xml"/></content-media> <content-text><p>Cet exercice est une variante des travaux pratiques 7.4.3. Il est possible que Packet Tracer ne prenne pas en charge toutes les tâches indiquées dans les travaux pratiques. Cet exercice ne remplace pas les travaux pratiques. Packet Tracer ne remplace pas les travaux pratiques avec des équipements réels.</p> <p>Des instructions détaillées sont fournies tout au long de l’exercice, ainsi que dans le fichier PDF accessible par le lien suivant.</p> <p><content-link target="E4_PTAct_7_4_3.pdf" type="internalfile">Instructions pour l’exercice (PDF)</content-link></p> <p><b>Cliquez sur l’icône Packet Tracer pour plus d’informations.</b> </p></content-text>
</page>
</topic>
</section>
<section type="ChapterSummary" id="tl1407050000">
<title><content-text>Résumé du chapitre</content-text></title>
<topic type="" id="tl1407050100">
<title><content-text>Résumé</content-text></title>
<page type="OneColumn" id="tl1407050101">
<content-media type="InteractiveGraphicHotspots" id="cm1915434518">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407050000/tl1407050100/tl1407050101/cm1915434518.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407050000/tl1407050100/tl1407050101/cm1915434518text.xml"/></content-media> <content-text><p>Le présent chapitre a traité des principales solutions au problème de la diminution de l’espace d’adressage Internet. Vous avez appris à utiliser le protocole DHCP pour attribuer des adresses IP privées dans votre réseau. Cela permet de ménager l’espace d’adressage public et représente une économie considérable en termes de coûts d’administration liés à la gestion des ajouts, des déplacements et des modifications. Vous avez appris à mettre en œuvre la fonction NAT et la surcharge NAT afin de ménager l’espace d’adressage public et de créer des intranets sécurisés privés sans affecter la connexion à votre FAI. La fonction NAT présente cependant des inconvénients de par son impact négatif sur les performances, la sécurité, la mobilité et la connectivité de bout en bout des périphériques.</p> <p>Globalement, la capacité à faire évoluer les réseaux pour les demandes futures nécessite une source inépuisable d’adresses IP et une plus grande mobilité que DHCP et NAT ne peuvent offrir. L’IPv6 permet de répondre aux exigences de plus en plus complexes de l’adressage hiérarchique que l’IPv4 ne peut pas assurer. L’émergence d’IPv6 permet non seulement de résoudre le problème du manque d’adresses IPv4 et de pallier aux limites de la fonction NAT, mais il offre en plus de nouvelles fonctionnalités et des fonctionnalités améliorées. Grâce à la brève présentation d’IPv6 dans cette leçon, vous avez appris comment les adresses IPv6 sont structurées, comment elles permettront d’améliorer la sécurité et la mobilité du réseau et comment la transition d’IPv4 à IPv6 va s’effectuer.</p></content-text>
</page>
<page type="FullScreen" id="tl1407050102">
<content-media type="StaticGraphic" id="cm7087997872">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407050000/tl1407050100/tl1407050102/cm7087997872.swf" mime="shockwave/flash" scale="true" type="file" width="400" height="200" external="tl1407000000/tl1407050000/tl1407050100/tl1407050102/cm7087997872text.xml"/></content-media> <content-text><p>Vérifiez vos connaissances</p></content-text>
</page>
<page type="OneColumn" id="tl1407050103">
<content-media type="ActivityPKA" id="cm8704662622">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407050000/tl1407050100/tl1407050103/cm8704662622/" mime="application/packettracer" scale="true" type="directory" width="0" height="0" external="tl1407000000/tl1407050000/tl1407050100/tl1407050103/cm8704662622/icontext.xml"/></content-media> <content-text><p>Dans ce dernier exercice, vous allez configurer les protocoles PPP, OSPF, DHCP, NAT et le routage par défaut vers le FAI. Vous vérifierez ensuite la configuration.</p> <p>Des instructions détaillées sont fournies tout au long de l’exercice, ainsi que dans le fichier PDF accessible par le lien suivant.</p> <p><content-link target="E4_PTAct_7_5_1.pdf" type="internalfile">Instructions pour l’exercice (PDF)</content-link></p> <p><b>Cliquez sur l’icône Packet Tracer pour plus d’informations.</b></p></content-text>
</page>
</topic>
</section>
<section type="ChapterQuiz" id="tl1407060000">
<title><content-text>Questionnaire du chapitre</content-text></title>
<topic type="" id="tl1407060100">
<title><content-text>Questionnaire du chapitre</content-text></title>
<page type="FullScreen" id="tl1407060101">
<content-media type="ChapterQuiz" id="cm6921524731">	<title><content-text></content-text></title>	<media ref="tl1407000000/tl1407060000/tl1407060100/tl1407060101/cm6921524731/" mime="" scale="true" type="directory" width="100%" height="100%" external="tl1407000000/tl1407060000/tl1407060100/tl1407060101/cm6921524731/icontext.xml"/></content-media> <content-text></content-text>
</page>
</topic>
</section>
</chapter>
